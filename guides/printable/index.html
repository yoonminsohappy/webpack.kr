<!DOCTYPE html><html lang="en"><head><title data-rh="true">인쇄 가능한 페이지 | 웹팩</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="theme-color" content="#2B3A42"/><meta data-rh="true" name="viewport" content="width=device-width, initial-scale=1"/><meta data-rh="true" name="robots" content="noindex,nofollow"/><meta data-rh="true" name="description" content="웹팩은 모듈 번들러입니다. 주요 목적은 브라우저에서 사용할 수 있도록 JavaScript 파일을 번들로 묶는 것이지만, 리소스나 애셋을 변환하고 번들링 또는 패키징할 수도 있습니다."/><meta data-rh="true" property="og:site_name" content="웹팩 한글문서"/><meta data-rh="true" property="og:type" content="website"/><meta data-rh="true" property="og:title" content="인쇄 가능한 페이지 | 웹팩"/><meta data-rh="true" property="og:description" name="description" content="웹팩은 모듈 번들러입니다. 주요 목적은 브라우저에서 사용할 수 있도록 JavaScript 파일을 번들로 묶는 것이지만, 리소스나 애셋을 변환하고 번들링 또는 패키징할 수도 있습니다."/><meta data-rh="true" property="og:image" content="https://webpack.js.org/icon-pwa-512x512.d3dae4189855b3a72ff9.png"/><meta data-rh="true" property="twitter:card" content="summary"/><meta data-rh="true" property="twitter:site" content="@webpack"/><meta data-rh="true" property="twitter:creator" content="@webpack"/><meta data-rh="true" property="twitter:domain" content="https://webpack.js.org/"/><meta data-rh="true" name="mobile-web-app-capable" content="yes"/><meta data-rh="true" name="apple-mobile-web-app-capable" content="yes"/><meta data-rh="true" name="apple-mobile-web-app-status-bar-style" content="black"/><meta data-rh="true" name="apple-mobile-web-app-title" content="webpack"/><meta data-rh="true" name="msapplication-TileImage" content="/icon_150x150.png"/><meta data-rh="true" name="msapplication-TileColor" content="#465e69"/><link data-rh="true" rel="icon" type="image/x-icon" href="/favicon.f326220248556af65f41.ico"/><link data-rh="true" rel="manifest" href="/manifest.json"/><link data-rh="true" rel="canonical" href="https://webpack.js.org/guides/printable/"/><link data-rh="true" rel="icon" sizes="192x192" href="/icon_192x192.png"/><link data-rh="true" rel="icon" sizes="512x512" href="/icon_512x512.png"/><link data-rh="true" rel="apple-touch-icon" href="/icon_180x180.png"/><link data-rh="true" rel="mask-icon" href="/logo-on-white-bg.47eff95f9c01c5972f6f.svg" color="#465e69"/><link rel="stylesheet" href=/index.0a439c6c70bc6322d1b1.css /><link rel="stylesheet" href=/9810.ecd65533ea4631309dd5.css /></head><body><div id="root"><div class="site"><div class="site__header"><header class="navigation   "><section class="navigation__inner"><button aria-label="Open menu" class="navigation__mobile"><svg viewBox="-62 138 25 25"><g><g><path d="M-60.2,140.2h20.9c1,0,1.8,0.8,1.8,1.8l0,0c0,1-0.8,1.8-1.8,1.8h-20.9c-1,0-1.8-0.8-1.8-1.8l0,0 C-62,141-61.2,140.2-60.2,140.2z"></path><path d="M-60.2,148.7h20.9c1,0,1.8,0.8,1.8,1.8l0,0c0,1-0.8,1.8-1.8,1.8h-20.9c-1,0-1.8-0.8-1.8-1.8l0,0 C-62,149.5-61.2,148.7-60.2,148.7z"></path><path d="M-60.2,157.2h20.9c1,0,1.8,0.8,1.8,1.8l0,0c0,1-0.8,1.8-1.8,1.8h-20.9c-1,0-1.8-0.8-1.8-1.8l0,0 C-62,158-61.2,157.2-60.2,157.2z"></path></g></g></svg></button><a class="navigation__logo" href="/"><img class="logo" src="/site-logo.1fcab817090e78435061.svg" alt="webpack logo"/></a><nav class="navigation__items"><a class="navigation__item  navigation__item--active" href="/concepts/">Documentation</a><a class="navigation__item  " href="/contribute/">Contribute</a><a class="navigation__item  " href="/vote/">Vote</a><a class="navigation__item  " href="/blog/">Blog</a><a href="https://github.com/webpack/webpack" target="_blank" rel="noopener noreferrer" title="GitHub Repository" class="navigation__item navigation__item--icon "><svg viewBox="0 0 24 24" aria-hidden="true" fill="#fff" width="16"><path d="M12 2A10 10 0 002 12a10 10 0 006.8 9.5c.5 0 .7-.2.7-.5v-1.7C6.7 20 6.1 18 6.1 18c-.4-1.2-1-1.5-1-1.5-1-.6 0-.6 0-.6 1 0 1.5 1 1.5 1 .9 1.6 2.4 1.1 3 .9 0-.7.3-1.1.6-1.4-2.2-.2-4.6-1-4.6-4.9 0-1.1.4-2 1-2.7 0-.3-.4-1.3.2-2.7 0 0 .8-.2 2.7 1a9.4 9.4 0 015 0c2-1.2 2.8-1 2.8-1 .5 1.4.1 2.4 0 2.7.7.7 1 1.6 1 2.7 0 3.8-2.3 4.7-4.5 5 .4.2.7.8.7 1.8V21c0 .3.2.6.7.5 4-1.3 6.8-5 6.8-9.5A10 10 0 0012 2z"></path></svg></a><a href="https://twitter.com/webpack" target="_blank" rel="noopener noreferrer" title="webpack on Twitter" class="navigation__item navigation__item--icon "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" aria-hidden="true" fill="#fff" width="16"><path d="M28 6.937c-.957.425-1.985.711-3.064.84a5.343 5.343 0 002.345-2.951 10.696 10.696 0 01-3.388 1.295 5.334 5.334 0 00-9.089 4.864A15.143 15.143 0 013.809 5.411a5.321 5.321 0 00-.721 2.683 5.33 5.33 0 002.372 4.439 5.323 5.323 0 01-2.416-.667v.067a5.335 5.335 0 004.279 5.23 5.336 5.336 0 01-2.409.092 5.34 5.34 0 004.983 3.705 10.699 10.699 0 01-6.625 2.284c-.43 0-.855-.025-1.273-.075a15.102 15.102 0 008.177 2.396c9.812 0 15.176-8.128 15.176-15.177 0-.231-.005-.461-.015-.69A10.855 10.855 0 0028 6.937z"></path></svg></a><a href="https://stackoverflow.com/questions/tagged/webpack" target="_blank" rel="noopener noreferrer" title="webpack on Stack Overflow" class="navigation__item navigation__item--icon "><svg viewBox="0 0 24 24" aria-hidden="true" fill="#fff" width="16"><path d="M17.4 20.2v-5.4h1.8V22H3v-7.2h1.8v5.4h12.6M6.8 14.3l.3-1.7 8.8 1.8-.3 1.8-8.8-1.9m1.1-4.2l.8-1.6 8.1 3.8-.7 1.6-8.2-3.8m2.3-4l1.1-1.4 7 5.8-1.2 1.4L10 6m4.7-4L20 9l-1.4 1-5.4-7 1.4-1m-8 16.5v-1.8h9v1.8h-9z"></path></svg></a><span class="navigation__item navigation__item--icon"><nav class="dropdown navigation__languages"><button aria-haspopup="true" aria-expanded="false" aria-label="Select language"><img class="dropdown__language" alt="select language" src="/language-icon.87a028c9bf555eeb5932.svg"/><i aria-hidden="true" class="dropdown__arrow"></i></button><div class="dropdown__list "><ul><li><a href="https://webpack.js.org/guides/printable/"><span>English</span></a></li><li><a href="https://webpack.docschina.org/guides/printable/"><span lang="zh">中文</span></a></li><li><a href="https://webpack.kr/guides/printable/"><span lang="ko">한국어</span></a></li></ul></div></nav></span><span class="navigation__item navigation__item--icon"><button style="background:transparent;border:none;cursor:pointer">☀️</button></span></nav><div class="navigation-search "><input type="text" class="navigation-search__input" placeholder="Search this site..." value=""/><button aria-label="Hide search box" class="navigation-search__icon navigation-search__clear"><svg viewBox="-137 138 25 25"><g transform="translate(0,-952.36218)"><path d="M-131.3,1094.4c-0.4,0-0.9,0.1-1.2,0.5c-0.7,0.7-0.7,1.7,0,2.4l5.6,5.6l-5.6,5.6c-0.7,0.7-0.7,1.7,0,2.4 c0.7,0.7,1.7,0.7,2.4,0l5.6-5.6l5.6,5.6c0.7,0.7,1.7,0.7,2.4,0c0.7-0.7,0.7-1.7,0-2.4l-5.6-5.6l5.6-5.6c0.7-0.7,0.7-1.7,0-2.4 c-0.7-0.7-1.7-0.7-2.4,0l-5.6,5.6l-5.6-5.6C-130.5,1094.5-130.9,1094.4-131.3,1094.4L-131.3,1094.4z"></path></g></svg></button><button aria-label="Show search box" class="navigation-search__icon navigation-search__search"><svg viewBox="-137 138 25 25"><g><path d="M-114.6,162.6l-7.5-7.5c-0.6-0.6-0.6-1.6,0-2.1l0,0c0.6-0.6,1.6-0.6,2.1,0l7.5,7.5c0.6,0.6,0.6,1.6,0,2.1l0,0 C-113,163.1-114,163.1-114.6,162.6z"></path><path d="M-134.1,140.9c-3.9,3.9-3.9,10.2,0,14.1s10.2,3.9,14.1,0s3.9-10.2,0-14.1S-130.2,137-134.1,140.9z M-122.1,153 c-2.7,2.7-7.1,2.7-9.8,0s-2.7-7.1,0-9.8s7.1-2.7,9.8,0C-119.4,145.9-119.4,150.2-122.1,153z"></path></g></svg></button></div></section><div class="navigation-sub"><div class="navigation-sub__inner"><a class="navigation-sub__link " title="api" content="api" href="/api/">api</a><a class="navigation-sub__link " title="concepts" content="concepts" href="/concepts/">concepts</a><a class="navigation-sub__link " title="configuration" content="configuration" href="/configuration/">configuration</a><a class="navigation-sub__link navigation-sub__link--active" title="guides" content="guides" href="/guides/">guides</a><a class="navigation-sub__link " title="loaders" content="loaders" href="/loaders/">loaders</a><a class="navigation-sub__link " title="migrate" content="migrate" href="/migrate/">migrate</a><a class="navigation-sub__link " title="plugins" content="plugins" href="/plugins/">plugins</a></div></div></header></div><div class="container site__content"><div class="sponsors"><a href="https://www.ag-grid.com/?utm_source=webpack&amp;utm_medium=banner&amp;utm_campaign=sponsorship" target="_blank" rel="noopener noreferrer" class="sponsors__content"><img src="/ag-grid-logo.4fe9d34532b2c0821fc9.png"/><img class="sponsors__img__webpack" src="/icon-square-small.85ba630cf0c5f29ae3e3.svg"/><div class="sponsors__content-cont">ag-grid is proud to partner with webpack</div></a></div><nav class="sidebar site__sidebar"><div class="sidebar__inner"><div class="relative z-0 bg-white dark:bg-gray-100 "><select class="text-gray-600 text-14 px-5 py-5 appearance-none box-border border border-gray-200 border-solid flex-col flex w-full rounded-none bg-transparent bg-none"><option selected="" value="5">Webpack 5</option><option value="4">Webpack 4</option></select><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="absolute right-5 top-5 fill-current text-gray-300 z-[-1]" width="20" height="20"><path d="M4.5 7.5c.5-.4 1-.4 1.6 0l3.9 3.8 4-3.8c.4-.4 1-.4 1.5 0 .4.5.4 1.2 0 1.7l-4.7 4.5a1 1 0 01-1.6 0L4.5 9.2c-.4-.5-.4-1.2 0-1.7z"></path></svg></div><div class="sidebar-item sidebar-item--disabled`"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="sidebar-item__toggle" width="15" height="17" fill="#175d96"><path d="M10 3.3c-.6 0-1 .4-1.1 1.1v11.2c0 .3.2.6.4.8.2.2.5.4.8.4.6 0 1-.4 1.1-1.1V4.5c0-.3-.2-.6-.4-.8-.2-.2-.5-.4-.8-.4z" color="#000" style="isolation:auto;mix-blend-mode:normal"></path></svg><a class="sidebar-item__title sidebar-link__print" href="/guides/printable/" rel="nofollow noopener noreferrer" alt="Print" title="Print" target="_blank">Print Section<img src="/icon-print.42ad40feec51e6f5f553.svg"/></a></div><div><div class="sidebar-item  sidebar-item--disabled"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="sidebar-item__toggle" width="15" height="17" fill="#175d96"><path d="M10 3.3c-.6 0-1 .4-1.1 1.1v11.2c0 .3.2.6.4.8.2.2.5.4.8.4.6 0 1-.4 1.1-1.1V4.5c0-.3-.2-.6-.4-.8-.2-.2-.5-.4-.8-.4z" color="#000" style="isolation:auto;mix-blend-mode:normal"></path></svg><a class="sidebar-item__title" href="/guides/">Guides</a></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="/guides/getting-started/">Getting Started</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Basic Setup"><a href="/guides/getting-started/#basic-setup">Basic Setup</a></li><li class="sidebar-item__anchor" title="Creating a Bundle"><a href="/guides/getting-started/#creating-a-bundle">Creating a Bundle</a></li><li class="sidebar-item__anchor" title="Modules"><a href="/guides/getting-started/#modules">Modules</a></li><li class="sidebar-item__anchor" title="Using a Configuration"><a href="/guides/getting-started/#using-a-configuration">Using a Configuration</a></li><li class="sidebar-item__anchor" title="NPM Scripts"><a href="/guides/getting-started/#npm-scripts">NPM Scripts</a></li><li class="sidebar-item__anchor" title="Conclusion"><a href="/guides/getting-started/#conclusion">Conclusion</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="/guides/asset-management/">Asset Management</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Setup"><a href="/guides/asset-management/#setup">Setup</a></li><li class="sidebar-item__anchor" title="Loading CSS"><a href="/guides/asset-management/#loading-css">Loading CSS</a></li><li class="sidebar-item__anchor" title="Loading Images"><a href="/guides/asset-management/#loading-images">Loading Images</a></li><li class="sidebar-item__anchor" title="Loading Fonts"><a href="/guides/asset-management/#loading-fonts">Loading Fonts</a></li><li class="sidebar-item__anchor" title="Loading Data"><a href="/guides/asset-management/#loading-data">Loading Data</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Customize parser of JSON modules"><a href="/guides/asset-management/#customize-parser-of-json-modules">Customize parser of JSON modules</a></li></ul></li><li class="sidebar-item__anchor" title="Global Assets"><a href="/guides/asset-management/#global-assets">Global Assets</a></li><li class="sidebar-item__anchor" title="Wrapping up"><a href="/guides/asset-management/#wrapping-up">Wrapping up</a></li><li class="sidebar-item__anchor" title="Next guide"><a href="/guides/asset-management/#next-guide">Next guide</a></li><li class="sidebar-item__anchor" title="Further Reading"><a href="/guides/asset-management/#further-reading">Further Reading</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="/guides/output-management/">Output Management</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Preparation"><a href="/guides/output-management/#preparation">Preparation</a></li><li class="sidebar-item__anchor" title="Setting up HtmlWebpackPlugin"><a href="/guides/output-management/#setting-up-htmlwebpackplugin">Setting up HtmlWebpackPlugin</a></li><li class="sidebar-item__anchor" title="Cleaning up the /dist folder"><a href="/guides/output-management/#cleaning-up-the-dist-folder">Cleaning up the /dist folder</a></li><li class="sidebar-item__anchor" title="The Manifest"><a href="/guides/output-management/#the-manifest">The Manifest</a></li><li class="sidebar-item__anchor" title="Conclusion"><a href="/guides/output-management/#conclusion">Conclusion</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="/guides/development/">Development</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Using source maps"><a href="/guides/development/#using-source-maps">Using source maps</a></li><li class="sidebar-item__anchor" title="Choosing a Development Tool"><a href="/guides/development/#choosing-a-development-tool">Choosing a Development Tool</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Using Watch Mode"><a href="/guides/development/#using-watch-mode">Using Watch Mode</a></li><li class="sidebar-item__anchor" title="Using webpack-dev-server"><a href="/guides/development/#using-webpack-dev-server">Using webpack-dev-server</a></li><li class="sidebar-item__anchor" title="Using webpack-dev-middleware"><a href="/guides/development/#using-webpack-dev-middleware">Using webpack-dev-middleware</a></li></ul></li><li class="sidebar-item__anchor" title="Adjusting Your Text Editor"><a href="/guides/development/#adjusting-your-text-editor">Adjusting Your Text Editor</a></li><li class="sidebar-item__anchor" title="Conclusion"><a href="/guides/development/#conclusion">Conclusion</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="/guides/code-splitting/">Code Splitting</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Entry Points"><a href="/guides/code-splitting/#entry-points">Entry Points</a></li><li class="sidebar-item__anchor" title="Prevent Duplication"><a href="/guides/code-splitting/#prevent-duplication">Prevent Duplication</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Entry dependencies"><a href="/guides/code-splitting/#entry-dependencies">Entry dependencies</a></li><li class="sidebar-item__anchor" title="SplitChunksPlugin"><a href="/guides/code-splitting/#splitchunksplugin">SplitChunksPlugin</a></li></ul></li><li class="sidebar-item__anchor" title="Dynamic Imports"><a href="/guides/code-splitting/#dynamic-imports">Dynamic Imports</a></li><li class="sidebar-item__anchor" title="Prefetching/Preloading modules"><a href="/guides/code-splitting/#prefetchingpreloading-modules">Prefetching/Preloading modules</a></li><li class="sidebar-item__anchor" title="Bundle Analysis"><a href="/guides/code-splitting/#bundle-analysis">Bundle Analysis</a></li><li class="sidebar-item__anchor" title="Next Steps"><a href="/guides/code-splitting/#next-steps">Next Steps</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="/guides/caching/">Caching</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Output Filenames"><a href="/guides/caching/#output-filenames">Output Filenames</a></li><li class="sidebar-item__anchor" title="Extracting Boilerplate"><a href="/guides/caching/#extracting-boilerplate">Extracting Boilerplate</a></li><li class="sidebar-item__anchor" title="Module Identifiers"><a href="/guides/caching/#module-identifiers">Module Identifiers</a></li><li class="sidebar-item__anchor" title="Conclusion"><a href="/guides/caching/#conclusion">Conclusion</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="/guides/author-libraries/">Authoring Libraries</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Authoring a Library"><a href="/guides/author-libraries/#authoring-a-library">Authoring a Library</a></li><li class="sidebar-item__anchor" title="Webpack Configuration"><a href="/guides/author-libraries/#webpack-configuration">Webpack Configuration</a></li><li class="sidebar-item__anchor" title="Expose the Library"><a href="/guides/author-libraries/#expose-the-library">Expose the Library</a></li><li class="sidebar-item__anchor" title="Externalize Lodash"><a href="/guides/author-libraries/#externalize-lodash">Externalize Lodash</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="External Limitations"><a href="/guides/author-libraries/#external-limitations">External Limitations</a></li></ul></li><li class="sidebar-item__anchor" title="Final Steps"><a href="/guides/author-libraries/#final-steps">Final Steps</a></li></ul></div></div><div><div class="sidebar-item  sidebar-item--disabled"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="sidebar-item__toggle" width="15" height="17" fill="#175d96"><path d="M10 3.3c-.6 0-1 .4-1.1 1.1v11.2c0 .3.2.6.4.8.2.2.5.4.8.4.6 0 1-.4 1.1-1.1V4.5c0-.3-.2-.6-.4-.8-.2-.2-.5-.4-.8-.4z" color="#000" style="isolation:auto;mix-blend-mode:normal"></path></svg><a class="sidebar-item__title" href="/guides/environment-variables/">Environment Variables</a></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="/guides/build-performance/">Build Performance</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="General"><a href="/guides/build-performance/#general">General</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Stay Up to Date"><a href="/guides/build-performance/#stay-up-to-date">Stay Up to Date</a></li><li class="sidebar-item__anchor" title="Loaders"><a href="/guides/build-performance/#loaders">Loaders</a></li><li class="sidebar-item__anchor" title="Bootstrap"><a href="/guides/build-performance/#bootstrap">Bootstrap</a></li><li class="sidebar-item__anchor" title="Resolving"><a href="/guides/build-performance/#resolving">Resolving</a></li><li class="sidebar-item__anchor" title="Dlls"><a href="/guides/build-performance/#dlls">Dlls</a></li><li class="sidebar-item__anchor" title="Smaller = Faster"><a href="/guides/build-performance/#smaller--faster">Smaller = Faster</a></li><li class="sidebar-item__anchor" title="Worker Pool"><a href="/guides/build-performance/#worker-pool">Worker Pool</a></li><li class="sidebar-item__anchor" title="Persistent cache"><a href="/guides/build-performance/#persistent-cache">Persistent cache</a></li><li class="sidebar-item__anchor" title="Custom plugins/loaders"><a href="/guides/build-performance/#custom-pluginsloaders">Custom plugins/loaders</a></li><li class="sidebar-item__anchor" title="Progress plugin"><a href="/guides/build-performance/#progress-plugin">Progress plugin</a></li></ul></li><li class="sidebar-item__anchor" title="Development"><a href="/guides/build-performance/#development">Development</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Incremental Builds"><a href="/guides/build-performance/#incremental-builds">Incremental Builds</a></li><li class="sidebar-item__anchor" title="Compile in Memory"><a href="/guides/build-performance/#compile-in-memory">Compile in Memory</a></li><li class="sidebar-item__anchor" title="stats.toJson speed"><a href="/guides/build-performance/#statstojson-speed">stats.toJson speed</a></li><li class="sidebar-item__anchor" title="Devtool"><a href="/guides/build-performance/#devtool">Devtool</a></li><li class="sidebar-item__anchor" title="Avoid Production Specific Tooling"><a href="/guides/build-performance/#avoid-production-specific-tooling">Avoid Production Specific Tooling</a></li><li class="sidebar-item__anchor" title="Minimal Entry Chunk"><a href="/guides/build-performance/#minimal-entry-chunk">Minimal Entry Chunk</a></li><li class="sidebar-item__anchor" title="Avoid Extra Optimization Steps"><a href="/guides/build-performance/#avoid-extra-optimization-steps">Avoid Extra Optimization Steps</a></li><li class="sidebar-item__anchor" title="Output Without Path Info"><a href="/guides/build-performance/#output-without-path-info">Output Without Path Info</a></li><li class="sidebar-item__anchor" title="Node.js Versions 8.9.10-9.11.1"><a href="/guides/build-performance/#nodejs-versions-8910-9111">Node.js Versions 8.9.10-9.11.1</a></li><li class="sidebar-item__anchor" title="TypeScript Loader"><a href="/guides/build-performance/#typescript-loader">TypeScript Loader</a></li></ul></li><li class="sidebar-item__anchor" title="Production"><a href="/guides/build-performance/#production">Production</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Multiple Compilations"><a href="/guides/build-performance/#multiple-compilations">Multiple Compilations</a></li><li class="sidebar-item__anchor" title="Source Maps"><a href="/guides/build-performance/#source-maps">Source Maps</a></li></ul></li><li class="sidebar-item__anchor" title="Specific Tooling Issues"><a href="/guides/build-performance/#specific-tooling-issues">Specific Tooling Issues</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Babel"><a href="/guides/build-performance/#babel">Babel</a></li><li class="sidebar-item__anchor" title="TypeScript"><a href="/guides/build-performance/#typescript">TypeScript</a></li><li class="sidebar-item__anchor" title="Sass"><a href="/guides/build-performance/#sass">Sass</a></li></ul></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="/guides/csp/">Content Security Policies</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Examples"><a href="/guides/csp/#examples">Examples</a></li><li class="sidebar-item__anchor" title="Enabling CSP"><a href="/guides/csp/#enabling-csp">Enabling CSP</a></li><li class="sidebar-item__anchor" title="Trusted Types"><a href="/guides/csp/#trusted-types">Trusted Types</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="/guides/development-vagrant/">Development - Vagrant</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Configuring the Project"><a href="/guides/development-vagrant/#configuring-the-project">Configuring the Project</a></li><li class="sidebar-item__anchor" title="Running the Server"><a href="/guides/development-vagrant/#running-the-server">Running the Server</a></li><li class="sidebar-item__anchor" title="Advanced Usage with nginx"><a href="/guides/development-vagrant/#advanced-usage-with-nginx">Advanced Usage with nginx</a></li><li class="sidebar-item__anchor" title="Conclusion"><a href="/guides/development-vagrant/#conclusion">Conclusion</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="/guides/dependency-management/">Dependency Management</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="require with expression"><a href="/guides/dependency-management/#require-with-expression">require with expression</a></li><li class="sidebar-item__anchor" title="require.context"><a href="/guides/dependency-management/#requirecontext">require.context</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="context module API"><a href="/guides/dependency-management/#context-module-api">context module API</a></li></ul></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="/guides/installation/">Installation</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Prerequisites"><a href="/guides/installation/#prerequisites">Prerequisites</a></li><li class="sidebar-item__anchor" title="Local Installation"><a href="/guides/installation/#local-installation">Local Installation</a></li><li class="sidebar-item__anchor" title="Global Installation"><a href="/guides/installation/#global-installation">Global Installation</a></li><li class="sidebar-item__anchor" title="Bleeding Edge"><a href="/guides/installation/#bleeding-edge">Bleeding Edge</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="/guides/hot-module-replacement/">Hot Module Replacement</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Enabling HMR"><a href="/guides/hot-module-replacement/#enabling-hmr">Enabling HMR</a></li><li class="sidebar-item__anchor" title="Via the Node.js API"><a href="/guides/hot-module-replacement/#via-the-nodejs-api">Via the Node.js API</a></li><li class="sidebar-item__anchor" title="Gotchas"><a href="/guides/hot-module-replacement/#gotchas">Gotchas</a></li><li class="sidebar-item__anchor" title="HMR with Stylesheets"><a href="/guides/hot-module-replacement/#hmr-with-stylesheets">HMR with Stylesheets</a></li><li class="sidebar-item__anchor" title="Other Code and Frameworks"><a href="/guides/hot-module-replacement/#other-code-and-frameworks">Other Code and Frameworks</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="/guides/tree-shaking/">Tree Shaking</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Add a Utility"><a href="/guides/tree-shaking/#add-a-utility">Add a Utility</a></li><li class="sidebar-item__anchor" title="Mark the file as side-effect-free"><a href="/guides/tree-shaking/#mark-the-file-as-side-effect-free">Mark the file as side-effect-free</a></li><li class="sidebar-item__anchor" title="Clarifying tree shaking and sideEffects"><a href="/guides/tree-shaking/#clarifying-tree-shaking-and-sideeffects">Clarifying tree shaking and sideEffects</a></li><li class="sidebar-item__anchor" title="Mark a function call as side-effect-free"><a href="/guides/tree-shaking/#mark-a-function-call-as-side-effect-free">Mark a function call as side-effect-free</a></li><li class="sidebar-item__anchor" title="Minify the Output"><a href="/guides/tree-shaking/#minify-the-output">Minify the Output</a></li><li class="sidebar-item__anchor" title="Conclusion"><a href="/guides/tree-shaking/#conclusion">Conclusion</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="/guides/production/">Production</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Setup"><a href="/guides/production/#setup">Setup</a></li><li class="sidebar-item__anchor" title="NPM Scripts"><a href="/guides/production/#npm-scripts">NPM Scripts</a></li><li class="sidebar-item__anchor" title="Specify the Mode"><a href="/guides/production/#specify-the-mode">Specify the Mode</a></li><li class="sidebar-item__anchor" title="Minification"><a href="/guides/production/#minification">Minification</a></li><li class="sidebar-item__anchor" title="Source Mapping"><a href="/guides/production/#source-mapping">Source Mapping</a></li><li class="sidebar-item__anchor" title="Minimize CSS"><a href="/guides/production/#minimize-css">Minimize CSS</a></li><li class="sidebar-item__anchor" title="CLI Alternatives"><a href="/guides/production/#cli-alternatives">CLI Alternatives</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="/guides/lazy-loading/">Lazy Loading</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Example"><a href="/guides/lazy-loading/#example">Example</a></li><li class="sidebar-item__anchor" title="Frameworks"><a href="/guides/lazy-loading/#frameworks">Frameworks</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="/guides/ecma-script-modules/">ECMAScript Modules</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Exporting"><a href="/guides/ecma-script-modules/#exporting">Exporting</a></li><li class="sidebar-item__anchor" title="Importing"><a href="/guides/ecma-script-modules/#importing">Importing</a></li><li class="sidebar-item__anchor" title="Flagging modules as ESM"><a href="/guides/ecma-script-modules/#flagging-modules-as-esm">Flagging modules as ESM</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="/guides/shimming/">Shimming</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Shimming Globals"><a href="/guides/shimming/#shimming-globals">Shimming Globals</a></li><li class="sidebar-item__anchor" title="Granular Shimming"><a href="/guides/shimming/#granular-shimming">Granular Shimming</a></li><li class="sidebar-item__anchor" title="Global Exports"><a href="/guides/shimming/#global-exports">Global Exports</a></li><li class="sidebar-item__anchor" title="Loading Polyfills"><a href="/guides/shimming/#loading-polyfills">Loading Polyfills</a></li><li class="sidebar-item__anchor" title="Further Optimizations"><a href="/guides/shimming/#further-optimizations">Further Optimizations</a></li><li class="sidebar-item__anchor" title="Node Built-Ins"><a href="/guides/shimming/#node-built-ins">Node Built-Ins</a></li><li class="sidebar-item__anchor" title="Other Utilities"><a href="/guides/shimming/#other-utilities">Other Utilities</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="/guides/typescript/">TypeScript</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Basic Setup"><a href="/guides/typescript/#basic-setup">Basic Setup</a></li><li class="sidebar-item__anchor" title="Loader"><a href="/guides/typescript/#loader">Loader</a></li><li class="sidebar-item__anchor" title="Source Maps"><a href="/guides/typescript/#source-maps">Source Maps</a></li><li class="sidebar-item__anchor" title="Using Third Party Libraries"><a href="/guides/typescript/#using-third-party-libraries">Using Third Party Libraries</a></li><li class="sidebar-item__anchor" title="Importing Other Assets"><a href="/guides/typescript/#importing-other-assets">Importing Other Assets</a></li><li class="sidebar-item__anchor" title="Build Performance"><a href="/guides/typescript/#build-performance">Build Performance</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="/guides/web-workers/">Web Workers</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Syntax"><a href="/guides/web-workers/#syntax">Syntax</a></li><li class="sidebar-item__anchor" title="Example"><a href="/guides/web-workers/#example">Example</a></li><li class="sidebar-item__anchor" title="Node.js"><a href="/guides/web-workers/#nodejs">Node.js</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="/guides/progressive-web-application/">Progressive Web Application</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="We Don&#x27;t Work Offline Now"><a href="/guides/progressive-web-application/#we-dont-work-offline-now">We Don&#x27;t Work Offline Now</a></li><li class="sidebar-item__anchor" title="Adding Workbox"><a href="/guides/progressive-web-application/#adding-workbox">Adding Workbox</a></li><li class="sidebar-item__anchor" title="Registering Our Service Worker"><a href="/guides/progressive-web-application/#registering-our-service-worker">Registering Our Service Worker</a></li><li class="sidebar-item__anchor" title="Conclusion"><a href="/guides/progressive-web-application/#conclusion">Conclusion</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="/guides/public-path/">Public Path</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Use Cases"><a href="/guides/public-path/#use-cases">Use Cases</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Environment Based"><a href="/guides/public-path/#environment-based">Environment Based</a></li><li class="sidebar-item__anchor" title="On The Fly"><a href="/guides/public-path/#on-the-fly">On The Fly</a></li></ul></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="/guides/integrations/">Integrations</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="NPM Scripts"><a href="/guides/integrations/#npm-scripts">NPM Scripts</a></li><li class="sidebar-item__anchor" title="Grunt"><a href="/guides/integrations/#grunt">Grunt</a></li><li class="sidebar-item__anchor" title="Gulp"><a href="/guides/integrations/#gulp">Gulp</a></li><li class="sidebar-item__anchor" title="Mocha"><a href="/guides/integrations/#mocha">Mocha</a></li><li class="sidebar-item__anchor" title="Karma"><a href="/guides/integrations/#karma">Karma</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="/guides/asset-modules/">Asset Modules</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Resource assets"><a href="/guides/asset-modules/#resource-assets">Resource assets</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Custom output filename"><a href="/guides/asset-modules/#custom-output-filename">Custom output filename</a></li></ul></li><li class="sidebar-item__anchor" title="Inlining assets"><a href="/guides/asset-modules/#inlining-assets">Inlining assets</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Custom data URI generator"><a href="/guides/asset-modules/#custom-data-uri-generator">Custom data URI generator</a></li></ul></li><li class="sidebar-item__anchor" title="Source assets"><a href="/guides/asset-modules/#source-assets">Source assets</a></li><li class="sidebar-item__anchor" title="URL assets"><a href="/guides/asset-modules/#url-assets">URL assets</a></li><li class="sidebar-item__anchor" title="General asset type"><a href="/guides/asset-modules/#general-asset-type">General asset type</a></li><li class="sidebar-item__anchor" title="Replacing Inline Loader Syntax"><a href="/guides/asset-modules/#replacing-inline-loader-syntax">Replacing Inline Loader Syntax</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="/guides/entry-advanced/">Advanced entry</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Multiple file types per entry"><a href="/guides/entry-advanced/#multiple-file-types-per-entry">Multiple file types per entry</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="/guides/package-exports/">Package exports</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="General syntax"><a href="/guides/package-exports/#general-syntax">General syntax</a></li><li class="sidebar-item__anchor" title="Alternatives"><a href="/guides/package-exports/#alternatives">Alternatives</a></li><li class="sidebar-item__anchor" title="Conditional syntax"><a href="/guides/package-exports/#conditional-syntax">Conditional syntax</a></li><li class="sidebar-item__anchor" title="Abbreviation"><a href="/guides/package-exports/#abbreviation">Abbreviation</a></li><li class="sidebar-item__anchor" title="Notes about ordering"><a href="/guides/package-exports/#notes-about-ordering">Notes about ordering</a></li><li class="sidebar-item__anchor" title="Support"><a href="/guides/package-exports/#support">Support</a></li><li class="sidebar-item__anchor" title="Conditions"><a href="/guides/package-exports/#conditions">Conditions</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Reference syntax"><a href="/guides/package-exports/#reference-syntax">Reference syntax</a></li><li class="sidebar-item__anchor" title="Optimizations"><a href="/guides/package-exports/#optimizations">Optimizations</a></li><li class="sidebar-item__anchor" title="Target environment"><a href="/guides/package-exports/#target-environment">Target environment</a></li><li class="sidebar-item__anchor" title="Conditions: Preprocessor and runtimes"><a href="/guides/package-exports/#conditions-preprocessor-and-runtimes">Conditions: Preprocessor and runtimes</a></li><li class="sidebar-item__anchor" title="Conditions: Custom"><a href="/guides/package-exports/#conditions-custom">Conditions: Custom</a></li></ul></li><li class="sidebar-item__anchor" title="Common patterns"><a href="/guides/package-exports/#common-patterns">Common patterns</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Target environment independent packages"><a href="/guides/package-exports/#target-environment-independent-packages">Target environment independent packages</a></li><li class="sidebar-item__anchor" title="Providing devtools or production optimizations"><a href="/guides/package-exports/#providing-devtools-or-production-optimizations">Providing devtools or production optimizations</a></li><li class="sidebar-item__anchor" title="Providing different versions depending on target environment"><a href="/guides/package-exports/#providing-different-versions-depending-on-target-environment">Providing different versions depending on target environment</a></li><li class="sidebar-item__anchor" title="Combining patterns"><a href="/guides/package-exports/#combining-patterns">Combining patterns</a></li></ul></li><li class="sidebar-item__anchor" title="Guidelines"><a href="/guides/package-exports/#guidelines">Guidelines</a></li></ul></div></div></div></nav><section class="page"><div class="page-links"><a class="page-links__link" href="https://github.com/line/webpack.kr/edit/master/src/content/guides/printable.md">Edit Document<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="page-links__icon" width="12" fill="#1a6bac"><path d="M17.6 2.4C16 1 15 1.2 15 1.2l-6 6L2.2 14l-1 4.8 4.8-1 6.7-6.8 6-6s.3-1.1-1.1-2.6zm-12 14.8l-1.5.4-.7-1-1-.7.4-1.6.5-.4s.8 0 1.8 1 1 1.8 1 1.8l-.4.5z"></path></svg></a><span class="page-links__gap">|</span><button class="page-links__link page-links__print as-link" title="Print this page">Print Document<img src="/icon-print.42ad40feec51e6f5f553.svg" alt=""/></button></div><div class="markdown"><h1>Printable</h1><div><h1 id="guides">Guides<a href="#guides" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p>이 섹션에는 webpack이 제공하는 다양한 도구와 기능을 이해하고 마스터하기 위한 가이드가 포함되어 있습니다. 첫 번째는 <a href="/guides/getting-started/">시작하기를</a> 안내하는 간단한 가이드입니다.</p> <p>가이드는 계속 진행할수록 더 깊이있는 내용을 다룹니다. 대부분은 시작점 역할을 하고, 완료 후에는 실제 <a href="/configuration/">문서를</a> 보다 편안하게 살펴볼 수 있습니다.</p> <aside class="warning"><h6 class="warning__prefix">warning</h6><p>가이드에서 webpack을 실행하여 표시되는 출력은 최신 버전의 출력과 조금 다를 수 있습니다. 이것은 예상할 수 있는 일입니다. 번들이 유사하고, 제대로 실행되는 한 문제가 없어야 합니다. 만일 새 버전으로 인해 문제가 될 것 같은 예를 발견한 경우 <a href="https://github.com/webpack/webpack.js.org/issues/new/choose">이슈 생성하기를</a> 통해 알려주시면, 불일치하는 문제를 해결하기 위해 최선을 다하겠습니다.</p></aside> <h1 id="getting-started">Getting Started<a href="#getting-started" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p>webpack은 JavaScript 모듈을 컴파일할 때 사용됩니다. <a href="/guides/installation">설치하면</a>, <a href="/api/cli">CLI</a> 또는 <a href="/api/node">API</a>로 webpack과 상호 작용할 수 있습니다. 아직 webpack이 익숙하지 않은 경우 <a href="/concepts">핵심 개념</a>과 <a href="/comparison">비교 내용</a>을 통해 커뮤니티의 다른 도구보다 왜 webpack을 사용해야 할지 알아보세요.</p> <aside class="warning"><h6 class="warning__prefix">warning</h6><p>webpack 5를 실행하기 위한 최소 Node.js 버전은 10.13.0(LTS) 입니다.</p></aside> <StackBlitzPreview example="getting-started?terminal="/> <h2 id="basic-setup">Basic Setup<a href="#basic-setup" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>먼저 디렉터리를 생성합니다. 그 다음 npm을 초기화하고, <a href="/guides/installation/#local-installation">webpack을 로컬로 설치</a>한 후 <a href="https://github.com/webpack/webpack-cli"><code>webpack-cli</code></a>(커맨드-라인에서 webpack을 실행할 때 사용되는 도구)를 설치합니다.</p> <pre><code class="hljs language-bash"><span class="token function">mkdir</span> webpack-demo
<span class="token builtin class-name">cd</span> webpack-demo
<span class="token function">npm</span> init -y
<span class="token function">npm</span> <span class="token function">install</span> webpack webpack-cli --save-dev</code></pre> <p>가이드 전반에 걸쳐 <strong><code>diff</code></strong> 블록을 사용하여 디렉터리, 파일 코드의 변경을 보여줍니다. 예를 들면,</p> <pre><code class="hljs language-diff"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> 이것은 코드에 복사할 새로운 라인 입니다.
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> 그리고 이것은 코드에서 삭제될 라인 입니다.
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> 그리고 이것은 손대지 말아야 할 라인 입니다.</span></span></code></pre> <p>이제 다음의 디렉터리 구조와 파일, 콘텐츠를 생성합니다.</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> webpack-demo
</span><span class="token prefix unchanged"> </span><span class="token line"> |- package.json
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> |- index.html
</span><span class="token prefix inserted">+</span><span class="token line"> |- /src
</span><span class="token prefix inserted">+</span><span class="token line">   |- index.js</span></span></code></pre> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-javascript"><span class="token keyword">function</span> <span class="token function">component</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 이 라인이 동작하려면 현재 스크립트를 통해 포함된 Lodash가 필요합니다.</span>
  element<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Hello'</span><span class="token punctuation">,</span> <span class="token string">'webpack'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> element<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p><strong>index.html</strong></p> <pre><code class="hljs language-html"><span class="token doctype"><span class="token punctuation">&#x3C;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>html</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>title</span><span class="token punctuation">></span></span>Getting Started<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>title</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://unpkg.com/lodash@4.17.20<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>body</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>./src/index.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>html</span><span class="token punctuation">></span></span></code></pre> <p>또한 패키지를 <code>private</code>로 표기하고 <code>main</code> 항목을 제거하기 위해 <code>package.json</code> 파일을 조정해야 합니다. 이것은 실수로 코드가 출시되는 것을 방지하기 위한 것입니다.</p> <aside class="tip"><h6 class="tip__prefix">tip</h6><p><code>package.json</code>의 내부 동작을 더 알고 싶으면 <a href="https://docs.npmjs.com/files/package.json">npm 문서</a>를 읽어 보시기 바랍니다.</p></aside> <p><strong>package.json</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">{
</span><span class="token prefix unchanged"> </span><span class="token line">  "name": "webpack-demo",
</span><span class="token prefix unchanged"> </span><span class="token line">  "version": "1.0.0",
</span><span class="token prefix unchanged"> </span><span class="token line">  "description": "",
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  "main": "index.js",
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  "private": true,
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  "scripts": {
</span><span class="token prefix unchanged"> </span><span class="token line">    "test": "echo \"Error: no test specified\" &#x26;&#x26; exit 1"
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  "keywords": [],
</span><span class="token prefix unchanged"> </span><span class="token line">  "author": "",
</span><span class="token prefix unchanged"> </span><span class="token line">  "license": "MIT",
</span><span class="token prefix unchanged"> </span><span class="token line">  "devDependencies": {
</span><span class="token prefix unchanged"> </span><span class="token line">    "webpack": "^5.38.1",
</span><span class="token prefix unchanged"> </span><span class="token line">    "webpack-cli": "^4.7.2",
</span><span class="token prefix unchanged"> </span><span class="token line">  }
</span><span class="token prefix unchanged"> </span><span class="token line">}</span></span></code></pre> <p>예시에서 <code>&#x3C;script></code> 태그 사이에는 암시적인 의존성이 있습니다. <code>index.js</code> 파일은 실행되기 전에 페이지에 포함되는 <code>lodash</code>와 연관이 있습니다. 이는 <code>index.js</code>가 <code>lodash</code>의 필요성을 명시적으로 선언하지 않았기 때문입니다. 단지 전역 변수인 <code>_</code>가 존재하는지 추정할 뿐입니다.</p> <p>이러한 방식으로 JavaScript 프로젝트를 관리하는 것은 문제가 있습니다.</p> <ul> <li>해당 스크립트가 외부 라이브러리에 의존한다는 것이 명확하지 않습니다.</li> <li>의존성을 잃어버렸거나 잘못된 순서로 포함되었으면 애플리케이션이 제대로 작동하지 않습니다.</li> <li>의존성이 포함되었지만 사용되지 않는 경우에도 브라우저는 필요 없는 코드를 강제로 다운로드합니다.</li> </ul> <p>대신 webpack을 사용하여 이러한 스크립트를 관리할 수 있습니다.</p> <h2 id="creating-a-bundle">Creating a Bundle<a href="#creating-a-bundle" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>먼저 디렉터리 구조를 약간 수정하여 "배포" 코드(<code>./dist</code>)를 "소스" 코드(<code>./src</code>)와 분리합니다. "소스" 코드는 우리가 작성하고 편집하는 코드입니다. "배포" 코드는 빌드 과정을 통해 최소화하고 최적화되어 궁극적으로 브라우저에서 로드될 <code>출력물</code> 입니다. 다음과 같이 디렉터리 구조를 변경합니다.</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> webpack-demo
</span><span class="token prefix unchanged"> </span><span class="token line"> |- package.json
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> |- /dist
</span><span class="token prefix inserted">+</span><span class="token line">   |- index.html
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> |- index.html
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- /src
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.js</span></span></code></pre> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>자세히 관찰한 분들은 비록 <code>index.html</code>이 <code>dist</code> 디렉터리에 있지만, 수동으로 생성되었다는 것을 알아챘을 것입니다. 나중에 <a href="/guides/output-management/#setting-up-htmlwebpackplugin">다른 가이드에서</a>, <code>index.html</code>을 수동으로 수정하는 대신 자동으로 생성할 것입니다. 이 작업이 완료되면 <code>dist</code> 디렉터리를 비우고 모든 파일을 다시 생성해도 좋습니다.</p></aside> <p><code>lodash</code>의 의존성을 <code>index.js</code>와 함께 번들링 하려면, 라이브러리를 로컬에서 설치해야 합니다.</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save lodash</code></pre> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>프로덕션 번들에 번들로 제공될 패키지를 설치할 때 <code>npm install --save</code>를 사용해야 합니다. 개발 목적(e.g. a linter, testing libraries, etc.)으로 패키지를 설치한다면 <code>npm install --save-dev</code>를 사용해야 합니다. 자세한 내용은 <a href="https://docs.npmjs.com/cli/install">npm 문서를</a> 참고하세요.</p></aside> <p>지금부터 스크립트로 <code>lodash</code>를 가져오겠습니다.</p> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import _ from 'lodash';
</span><span class="token prefix inserted">+</span><span class="token line">
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">  const element = document.createElement('div');
</span></span>
<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  // 이 라인이 동작하려면 현재 스크립트를 통해 포함된 Lodash가 필요합니다.
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  // 이제 Lodash를 스크립트로 가져왔습니다.
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  return element;
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">document.body.appendChild(component());</span></span></code></pre> <p>이제 스크립트로 번들링 할 것이므로 <code>index.html</code>을 업데이트해야 합니다. 현재 <code>import</code>한 lodash <code>&#x3C;script></code>를 삭제하고 원래의 <code>./src</code> 파일 대신 다른 <code>&#x3C;script></code> 태그로 번들을 로드하도록 수정합니다.</p> <p><strong>dist/index.html</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">&#x3C;!DOCTYPE html>
</span><span class="token prefix unchanged"> </span><span class="token line">&#x3C;html>
</span><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;head>
</span><span class="token prefix unchanged"> </span><span class="token line">    &#x3C;meta charset="utf-8" />
</span><span class="token prefix unchanged"> </span><span class="token line">    &#x3C;title>Getting Started&#x3C;/title>
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    &#x3C;script src="https://unpkg.com/lodash@4.17.20">&#x3C;/script>
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;/head>
</span><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;body>
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    &#x3C;script src="./src/index.js">&#x3C;/script>
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &#x3C;script src="main.js">&#x3C;/script>
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;/body>
</span><span class="token prefix unchanged"> </span><span class="token line">&#x3C;/html></span></span></code></pre> <p>이 설정에서 <code>index.js</code>는 명시적으로 <code>lodash</code>가 있어야 하며, 이것을 <code>_</code>에 바인딩합니다.(글로벌 스코프의 오염 없음) 모듈에 필요한 의존성을 명시함으로써 webpack은 이 정보를 사용하여 디펜던시 그래프를 만들 수 있습니다. 그런 다음 그래프를 사용하여 스크립트가 올바른 순서로 실행되는 최적화된 번들을 생성합니다.</p> <p>그럼 <code>npx webpack</code>을 실행해 보겠습니다. 이 스크립트는 <code>src/index.js</code>를 <a href="/concepts/entry-points">엔트리 포인트</a>로 사용하고 <a href="/concepts/output">output</a>으로 <code>dist/main.js</code>을 생성합니다. <code>npx</code> 명령어는 Node 8.2/npm 5.2.0 이상 버전에서 제공되며, 처음에 설치했던 webpack 패키지의 webpack 바이너리(<code>./node_modules/.bin/webpack</code>)를 실행합니다.</p> <pre><code class="hljs language-bash">$ npx webpack
<span class="token punctuation">[</span>webpack-cli<span class="token punctuation">]</span> Compilation finished
asset main.js <span class="token number">69.3</span> KiB <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span> <span class="token punctuation">[</span>minimized<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: main<span class="token punctuation">)</span> <span class="token number">1</span> related asset
runtime modules <span class="token number">1000</span> bytes <span class="token number">5</span> modules
cacheable modules <span class="token number">530</span> KiB
  ./src/index.js <span class="token number">257</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./node_modules/lodash/lodash.js <span class="token number">530</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">1851</span> ms</code></pre> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>출력은 약간 다를 수 있지만, 빌드에 성공했다면 계속 진행해도 좋습니다.</p></aside> <p>브라우저에서 <code>dist</code> 디렉터리의 <code>index.html</code>을 열어봅니다. 모든 것이 제대로 되었다면 <code>'Hello webpack'</code> 글자가 표시될 것입니다.</p> <h2 id="modules">Modules<a href="#modules" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import"><code>import 문</code></a>과 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/export"><code>export 문</code></a>은 <a href="https://babeljs.io/docs/en/learn/">ES2015</a>에서 표준화되었습니다. 현재는 대부분의 브라우저에서 지원되지만, 몇몇 브라우저에서는 새 구문을 인식하지 못합니다. 하지만 webpack은 바로 사용할 수 있도록 지원해주니 걱정하지 마세요.</p> <p>보이지않는 곳에서 webpack이 실제로 코드를 "<strong>트랜스파일</strong>" 하여 이전 브라우저에서도 실행 할 수 있도록 합니다. <code>dist/main.js</code>을 보면 webpack이 어떻게 트랜스파일 하는지 볼 수 있을 것입니다. 매우 독창적입니다! <code>import</code>와 <code>export</code> 외에도 webpack은 다양한 모듈 구문을 지원합니다. 자세한 내용은 <a href="/api/module-methods">Module API에서</a> 볼 수 있습니다.</p> <p>webpack은 <code>import</code>와 <code>export</code> 문 이외는 코드를 변경하지 않습니다. 다른 <a href="http://es6-features.org/">ES2015 기능</a>을 사용한다면 webpack의 <a href="/concepts/loaders/">로더 시스템</a>인 <a href="https://babeljs.io/">Babel</a>이나 <a href="https://buble.surge.sh/guide/">Bublé</a>을 <a href="/loaders/#transpiling">트랜스파일러로 사용</a>해야 합니다.</p> <h2 id="using-a-configuration">Using a Configuration<a href="#using-a-configuration" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>버전 4부터 webpack은 어떠한 설정도 필요하지 않습니다. 하지만 대부분의 프로젝트는 좀 더 복잡한 설정이 필요하므로 webpack에서 <a href="/concepts/configuration">설정 파일</a>을 제공합니다. 이것은 터미널에서 많은 명령어를 수동으로 입력하는 것보다 훨씬 효율적입니다. 다음과 같이 생성해 보겠습니다.</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> webpack-demo
</span><span class="token prefix unchanged"> </span><span class="token line"> |- package.json
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> |- webpack.config.js
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- /dist
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.html
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /src
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.js</span></span></code></pre> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-javascript"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'main.js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p>이제 새로운 설정 파일을 이용하여 다시 빌드를 실행해 보세요.</p> <pre><code class="hljs language-bash">$ npx webpack --config webpack.config.js
<span class="token punctuation">[</span>webpack-cli<span class="token punctuation">]</span> Compilation finished
asset main.js <span class="token number">69.3</span> KiB <span class="token punctuation">[</span>compared <span class="token keyword">for</span> emit<span class="token punctuation">]</span> <span class="token punctuation">[</span>minimized<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: main<span class="token punctuation">)</span> <span class="token number">1</span> related asset
runtime modules <span class="token number">1000</span> bytes <span class="token number">5</span> modules
cacheable modules <span class="token number">530</span> KiB
  ./src/index.js <span class="token number">257</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./node_modules/lodash/lodash.js <span class="token number">530</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">1934</span> ms</code></pre> <aside class="tip"><h6 class="tip__prefix">tip</h6><p><code>webpack.config.js</code>가 있으면 <code>webpack</code> 명령은 기본으로 이것을 선택합니다. 여기서는 <code>--config</code> 옵션을 사용하여 어떠한 이름의 설정이던 사용할 수 있도록 합니다. 이것은 여러 개의 파일로 분할해야 하는 복잡한 설정에서 유용합니다.</p></aside> <p>설정 파일은 단순한 CLI 사용보다 훨씬 많은 유연성을 제공합니다. 로더의 규칙, 플러그인, 해석 옵션 및 기타 여러 향상된 기능을 지정할 수 있습니다. 더 자세한 것은 <a href="/configuration">설정 문서</a>를 참고하세요.</p> <h2 id="npm-scripts">NPM Scripts<a href="#npm-scripts" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>CLI에서 webpack의 로컬 사본을 실행하기 위해 약간의 단축 명령어를 설정 할 수 있습니다. <a href="https://docs.npmjs.com/misc/scripts">npm script</a>를 추가하여 <em>package.json을</em> 수정해 보겠습니다.</p> <p><strong>package.json</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">{
</span><span class="token prefix unchanged"> </span><span class="token line">  "name": "webpack-demo",
</span><span class="token prefix unchanged"> </span><span class="token line">  "version": "1.0.0",
</span><span class="token prefix unchanged"> </span><span class="token line">  "description": "",
</span><span class="token prefix unchanged"> </span><span class="token line">  "private": true,
</span><span class="token prefix unchanged"> </span><span class="token line">  "scripts": {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    "test": "echo \"Error: no test specified\" &#x26;&#x26; exit 1"
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    "test": "echo \"Error: no test specified\" &#x26;&#x26; exit 1",
</span><span class="token prefix inserted">+</span><span class="token line">    "build": "webpack"
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  "keywords": [],
</span><span class="token prefix unchanged"> </span><span class="token line">  "author": "",
</span><span class="token prefix unchanged"> </span><span class="token line">  "license": "ISC",
</span><span class="token prefix unchanged"> </span><span class="token line">  "devDependencies": {
</span><span class="token prefix unchanged"> </span><span class="token line">    "webpack": "^5.4.0",
</span><span class="token prefix unchanged"> </span><span class="token line">    "webpack-cli": "^4.2.0"
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  "dependencies": {
</span><span class="token prefix unchanged"> </span><span class="token line">    "lodash": "^4.17.20"
</span><span class="token prefix unchanged"> </span><span class="token line">  }
</span><span class="token prefix unchanged"> </span><span class="token line">}</span></span></code></pre> <p>이제 이전에 사용한 <code>npx</code> 명령 대신 <code>npm run build</code> 명령을 사용할 수 있습니다. <code>scripts</code>에서는 <code>npx</code>와 동일한 방식으로 로컬에서 설치된 npm 패키지를 이름으로 참조할 수 있습니다. 이 규칙은 모든 컨트리뷰터가 동일한 공통의 스크립트 세트를 사용할 수 있도록 하므로 대부분의 npm 기반 프로젝트에서 표준입니다.</p> <p>이제 다음 명령을 실행하고 스크립트의 별칭이 작동하는지 확인하세요.</p> <pre><code class="hljs language-bash">$ <span class="token function">npm</span> run build

<span class="token punctuation">..</span>.

<span class="token punctuation">[</span>webpack-cli<span class="token punctuation">]</span> Compilation finished
asset main.js <span class="token number">69.3</span> KiB <span class="token punctuation">[</span>compared <span class="token keyword">for</span> emit<span class="token punctuation">]</span> <span class="token punctuation">[</span>minimized<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: main<span class="token punctuation">)</span> <span class="token number">1</span> related asset
runtime modules <span class="token number">1000</span> bytes <span class="token number">5</span> modules
cacheable modules <span class="token number">530</span> KiB
  ./src/index.js <span class="token number">257</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./node_modules/lodash/lodash.js <span class="token number">530</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">1940</span> ms</code></pre> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>사용자 지정 파라미터는 <code>npm run build</code> 명령과 파라미터 사이에 두 개의 대시(예. <code>npm run build -- --color</code>)를 추가하여 webpack에 전달할 수 있습니다.</p></aside> <h2 id="conclusion">Conclusion<a href="#conclusion" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>이제 기본 빌드를 함께 완료하였습니다. 다음 가이드인 <a href="/guides/asset-management"><code>Asset Management로</code></a> 이동하여 webpack을 이용한 이미지나 폰트 같은 애셋 관리 방법을 알아보겠습니다. 이 시점에서 프로젝트는 아래와 같아야 합니다.</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff">webpack-demo
|- package.json
|- webpack.config.js
|- /dist
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- main.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- index.html
</span></span>|- /src
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- index.js
</span></span>|- /node_modules</code></pre> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>npm 5+ 이상을 사용하는 경우에는 디렉터리에 <code>package-lock.json</code> 파일도 표시될 것입니다.</p></aside> <aside class="warning"><h6 class="warning__prefix">warning</h6><p>신뢰할 수 없는 코드는 webpack으로 컴파일하지 마세요. 이로 인해 컴퓨터, 원격 서버 또는 애플리케이션 최종 사용자의 웹 브라우저에서 악성 코드가 실행될 수 있습니다.</p></aside> <p>webpack 디자인에 대해 자세히 알아보고 싶으면 <a href="/concepts">basic concepts</a>과 <a href="/configuration">configuration</a> 페이지를 확인하세요. 또한 <a href="/api">API</a>에서 webpack이 제공하는 다양한 인터페이스를 자세히 살펴봅니다.</p> <h1 id="asset-management">Asset Management<a href="#asset-management" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p>처음부터 가이드를 따라왔다면 이제 "Hello webpack"을 표시하는 작은 프로젝트가 생성되었을 것입니다. 이제 이미지와 같은 다른 애셋을 통합하고, 애셋이 어떻게 처리되는지 살펴보겠습니다.</p> <p>webpack 이전에 프런트엔드 개발자는 <a href="https://gruntjs.com/">grunt</a>와 <a href="https://gulpjs.com/">gulp</a> 같은 도구를 사용하여 애셋을 처리하고 <code>/src</code> 폴더에서 <code>/dist</code> 또는 <code>/build</code> 디렉터리로 옮겼습니다. JavaScript 모듈에도 동일한 아이디어가 사용되었지만, webpack과 같은 도구는 모든 의존성을 <strong>동적으로 번들합니다.</strong> (<a href="/concepts/dependency-graph">디펜던시 그래프</a>로 알려진 것을 생성합니다). 이것이 좋은 이유는 이제 모든 모듈이 <strong>의존성을 명확하게 명시하고</strong> 사용하지 않는 모듈을 번들에서 제외할 수 있기 때문입니다.</p> <p>webpack의 가장 멋진 기능 중 하나는 JavaScript 외에도 로더 또는 내장 <a href="/guides/asset-modules/">애셋 모듈</a>이 지원하는 <strong>다른 유형의 파일도 포함</strong> 할 수 있다는 것입니다. 즉, 위에 나열된 JavaScript의 이점(예: 명시적 의존성)을 웹 사이트 또는 웹 앱을 만드는 데 사용한 모든 것에 적용할 수 있습니다. 이미 설정에 익숙 할 수 있는 CSS부터 시작해 보겠습니다.</p> <h2 id="setup">Setup<a href="#setup" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>시작하기 전에 프로젝트를 조금 변경해 보겠습니다.</p> <p><strong>dist/index.html</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">&#x3C;!DOCTYPE html>
</span><span class="token prefix unchanged"> </span><span class="token line">&#x3C;html>
</span><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;head>
</span><span class="token prefix unchanged"> </span><span class="token line">    &#x3C;meta charset="utf-8" />
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    &#x3C;title>Getting Started&#x3C;/title>
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &#x3C;title>Asset Management&#x3C;/title>
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;/head>
</span><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;body>
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    &#x3C;script src="main.js">&#x3C;/script>
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &#x3C;script src="bundle.js">&#x3C;/script>
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;/body>
</span><span class="token prefix unchanged"> </span><span class="token line">&#x3C;/html></span></span></code></pre> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    filename: 'main.js',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    filename: 'bundle.js',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <h2 id="loading-css">Loading CSS<a href="#loading-css" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>JavaScript 모듈 내에서 CSS 파일을 <code>import</code> 하려면 <a href="/loaders/style-loader">style-loader</a>와 <a href="/loaders/css-loader">css-loader</a>를 설치하고 <a href="/configuration/module"><code>module</code> 설정</a>에 추가해야 합니다.</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev style-loader css-loader</code></pre> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: 'bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  module: {
</span><span class="token prefix inserted">+</span><span class="token line">    rules: [
</span><span class="token prefix inserted">+</span><span class="token line">      {
</span><span class="token prefix inserted">+</span><span class="token line">        test: /\.css$/i,
</span><span class="token prefix inserted">+</span><span class="token line">        use: ['style-loader', 'css-loader'],
</span><span class="token prefix inserted">+</span><span class="token line">      },
</span><span class="token prefix inserted">+</span><span class="token line">    ],
</span><span class="token prefix inserted">+</span><span class="token line">  },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>모듈 로더는 체인으로 연결할 수 있습니다. 체인의 각 로더는 리소스에 변형을 적용합니다. 체인은 역순으로 실행됩니다. 첫 번째 로더는 결과(변형이 적용된 리소스)를 다음 로더로 전달합니다. 마지막으로 webpack은 체인의 마지막 로더가 JavaScript를 반환할 것으로 예상합니다.</p> <p>위의 로더 순서는 유지되어야 합니다. <a href="/loaders/style-loader"><code>'style-loader'</code></a>가 먼저 오고 그 뒤에 <a href="/loaders/css-loader"><code>'css-loader'</code></a>가 따라오게 됩니다. 이 컨벤션을 따르지 않으면 webpack에서 오류가 발생할 수 있습니다.</p> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>webpack은 정규 표현식을 사용하여 어떤 파일을 찾아 특정 로더에 전달해야 하는지 알아냅니다. 이 경우 <code>.css</code>로 끝나는 모든 파일은 <code>style-loader</code>와 <code>css-loader</code>에 전달됩니다.</p></aside> <p>이렇게 하면 스타일이 필요한 파일에 <code>import './style.css'</code>하여 가져올 수 있습니다. 이제 모듈이 실행될 때 html 파일의 <code>&#x3C;head></code>에 문자열화 된 CSS가 <code>&#x3C;style></code>태그로 삽입됩니다.</p> <p>이제 새로운 <code>style.css</code> 파일을 프로젝트에 추가하고 <code>index.js</code>로 가져와 볼까요?</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> webpack-demo
</span><span class="token prefix unchanged"> </span><span class="token line"> |- package.json
</span><span class="token prefix unchanged"> </span><span class="token line"> |- webpack.config.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /dist
</span><span class="token prefix unchanged"> </span><span class="token line">   |- bundle.js
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.html
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /src
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   |- style.css
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   |- index.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /node_modules</span></span></code></pre> <p><strong>src/style.css</strong></p> <pre><code class="hljs language-css"><span class="token selector">.hello</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">import _ from 'lodash';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import './style.css';
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">  const element = document.createElement('div');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  // Lodash, now imported by this script
</span><span class="token prefix unchanged"> </span><span class="token line">  element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  element.classList.add('hello');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  return element;
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">document.body.appendChild(component());</span></span></code></pre> <p>이제 빌드 커맨드를 실행합니다.</p> <pre><code class="hljs language-bash">$ <span class="token function">npm</span> run build

<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>webpack-cli<span class="token punctuation">]</span> Compilation finished
asset bundle.js <span class="token number">72.6</span> KiB <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span> <span class="token punctuation">[</span>minimized<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: main<span class="token punctuation">)</span> <span class="token number">1</span> related asset
runtime modules <span class="token number">1000</span> bytes <span class="token number">5</span> modules
orphan modules <span class="token number">326</span> bytes <span class="token punctuation">[</span>orphan<span class="token punctuation">]</span> <span class="token number">1</span> module
cacheable modules <span class="token number">539</span> KiB
  modules by path ./node_modules/ <span class="token number">538</span> KiB
    ./node_modules/lodash/lodash.js <span class="token number">530</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
    ./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js <span class="token number">6.67</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
    ./node_modules/css-loader/dist/runtime/api.js <span class="token number">1.57</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  modules by path ./src/ <span class="token number">965</span> bytes
    ./src/index.js + <span class="token number">1</span> modules <span class="token number">639</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
    ./node_modules/css-loader/dist/cjs.js<span class="token operator">!</span>./src/style.css <span class="token number">326</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">2231</span> ms</code></pre> <p>브라우저에서 <code>dist/index.html</code>을 다시 열면 이제 <code>Hello webpack</code>이 빨간색으로 표시됩니다. webpack이 무엇을 했는지 확인하려면 페이지를 검사하여 head 태그를 살펴보세요. (<code>&#x3C;style></code>태그는 JavaScript를 통해 동적으로 생성되며 결과를 표시하지 않으므로 페이지 소스를 확인하지 마세요) head 태그에 <code>index.js</code>에서 가져온 스타일 블록이 포함되어 있을 것입니다.</p> <p>대부분의 경우 필수겠지만, 이제 프로덕션에서 로드 시간을 단축하기 위해 <a href="/plugins/mini-css-extract-plugin/#minimizing-for-production">css를 압축</a> 할 수 있습니다. 또한 생각할 수 있는 거의 모든 종류의 CSS 로더가 존재합니다. 몇 가지 예를 들면 <a href="/loaders/postcss-loader">postcss</a>, <a href="/loaders/sass-loader">sass</a> 및 <a href="/loaders/less-loader">less</a> 등이 있습니다.</p> <h2 id="loading-images">Loading Images<a href="#loading-images" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>이제 CSS는 가져왔는데, 배경이나 아이콘과 같은 이미지는 어떻게 할까요? 이미지도 webpack 5부터 내장된 <a href="/guides/asset-modules/">Asset Modules</a>를 사용하여 시스템에 쉽게 통합할 수 있습니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: 'bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  module: {
</span><span class="token prefix unchanged"> </span><span class="token line">    rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">      {
</span><span class="token prefix unchanged"> </span><span class="token line">        test: /\.css$/i,
</span><span class="token prefix unchanged"> </span><span class="token line">        use: ['style-loader', 'css-loader'],
</span><span class="token prefix unchanged"> </span><span class="token line">      },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      {
</span><span class="token prefix inserted">+</span><span class="token line">        test: /\.(png|svg|jpg|jpeg|gif)$/i,
</span><span class="token prefix inserted">+</span><span class="token line">        type: 'asset/resource',
</span><span class="token prefix inserted">+</span><span class="token line">      },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    ],
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>이제 <code>import myImage from './my-image.png'</code>를 사용하면 해당 이미지가 처리되어 <code>output</code> 디렉터리에 추가됩니다. <em>그리고</em> <code>MyImage</code> 변수는 이미지의 최종 URL을 포함합니다. 위와 같이 <a href="/loaders/css-loader">css-loader</a>를 사용하면 CSS 내의 <code>url('./my-image.png')</code>에도 유사한 프로세스가 적용됩니다. 로더는 이것이 로컬 파일임을 인식하고<code> './my-image.png'</code> 경로를 <code>output</code> 디렉터리에 있는 이미지의 최종 경로로 변경합니다. <a href="/loaders/html-loader">html-loader</a>는 <code>&#x3C;img src="./my-image.png" /></code>를 동일한 방식으로 처리합니다.</p> <p>이제 프로젝트에 이미지를 추가하고 어떻게 작동하는지 살펴볼까요? 원하는 이미지를 아무거나 사용해도 좋습니다.</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> webpack-demo
</span><span class="token prefix unchanged"> </span><span class="token line"> |- package.json
</span><span class="token prefix unchanged"> </span><span class="token line"> |- webpack.config.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /dist
</span><span class="token prefix unchanged"> </span><span class="token line">   |- bundle.js
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.html
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /src
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   |- icon.png
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   |- style.css
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /node_modules</span></span></code></pre> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">import _ from 'lodash';
</span><span class="token prefix unchanged"> </span><span class="token line">import './style.css';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import Icon from './icon.png';
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">  const element = document.createElement('div');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  // Lodash, now imported by this script
</span><span class="token prefix unchanged"> </span><span class="token line">  element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span><span class="token prefix unchanged"> </span><span class="token line">  element.classList.add('hello');
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  // 원래 있던 div 에 이미지를 추가합니다.
</span><span class="token prefix inserted">+</span><span class="token line">  const myIcon = new Image();
</span><span class="token prefix inserted">+</span><span class="token line">  myIcon.src = Icon;
</span><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line">  element.appendChild(myIcon);
</span><span class="token prefix inserted">+</span><span class="token line">
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  return element;
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">document.body.appendChild(component());</span></span></code></pre> <p><strong>src/style.css</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">.hello {
</span><span class="token prefix unchanged"> </span><span class="token line">  color: red;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  background: url('./icon.png');
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">}</span></span></code></pre> <p>새 빌드를 만들고 <code>index.html</code> 파일을 다시 엽니다.</p> <pre><code class="hljs language-bash">$ <span class="token function">npm</span> run build

<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>webpack-cli<span class="token punctuation">]</span> Compilation finished
assets by status <span class="token number">9.88</span> KiB <span class="token punctuation">[</span>cached<span class="token punctuation">]</span> <span class="token number">1</span> asset
asset bundle.js <span class="token number">73.4</span> KiB <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span> <span class="token punctuation">[</span>minimized<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: main<span class="token punctuation">)</span> <span class="token number">1</span> related asset
runtime modules <span class="token number">1.82</span> KiB <span class="token number">6</span> modules
orphan modules <span class="token number">326</span> bytes <span class="token punctuation">[</span>orphan<span class="token punctuation">]</span> <span class="token number">1</span> module
cacheable modules <span class="token number">540</span> KiB <span class="token punctuation">(</span>javascript<span class="token punctuation">)</span> <span class="token number">9.88</span> KiB <span class="token punctuation">(</span>asset<span class="token punctuation">)</span>
  modules by path ./node_modules/ <span class="token number">539</span> KiB
    modules by path ./node_modules/css-loader/dist/runtime/*.js <span class="token number">2.38</span> KiB
      ./node_modules/css-loader/dist/runtime/api.js <span class="token number">1.57</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
      ./node_modules/css-loader/dist/runtime/getUrl.js <span class="token number">830</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
    ./node_modules/lodash/lodash.js <span class="token number">530</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
    ./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js <span class="token number">6.67</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  modules by path ./src/ <span class="token number">1.45</span> KiB <span class="token punctuation">(</span>javascript<span class="token punctuation">)</span> <span class="token number">9.88</span> KiB <span class="token punctuation">(</span>asset<span class="token punctuation">)</span>
    ./src/index.js + <span class="token number">1</span> modules <span class="token number">794</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
    ./src/icon.png <span class="token number">42</span> bytes <span class="token punctuation">(</span>javascript<span class="token punctuation">)</span> <span class="token number">9.88</span> KiB <span class="token punctuation">(</span>asset<span class="token punctuation">)</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
    ./node_modules/css-loader/dist/cjs.js<span class="token operator">!</span>./src/style.css <span class="token number">648</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">1972</span> ms</code></pre> <p>모든 것이 순조롭게 진행되었다면 이제 아이콘이 반복해서 배경으로 표시되고, <code>Hello webpack</code> 텍스트 옆에 <code>img</code> 요소가 보이게 됩니다. 이 요소를 살펴보면 실제 파일 이름이 <code>29822eaa871e8eadeaa4.png</code>와 같이 변경된 것을 볼 수 있습니다. 이것은 webpack이 <code>src</code> 폴더에서 파일을 찾아서 처리했음을 의미합니다!</p> <h2 id="loading-fonts">Loading Fonts<a href="#loading-fonts" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>그렇다면 폰트와 같은 다른 애셋은 어떨까요? 애셋 모듈은 로드한 모든 파일을 가져와 빌드 디렉터리로 내보냅니다. 즉, 폰트를 포함한 모든 종류의 파일에 사용할 수 있습니다. 폰트 파일을 처리하도록 <code>webpack.config.js</code>를 업데이트해 보겠습니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: 'bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  module: {
</span><span class="token prefix unchanged"> </span><span class="token line">    rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">      {
</span><span class="token prefix unchanged"> </span><span class="token line">        test: /\.css$/i,
</span><span class="token prefix unchanged"> </span><span class="token line">        use: ['style-loader', 'css-loader'],
</span><span class="token prefix unchanged"> </span><span class="token line">      },
</span><span class="token prefix unchanged"> </span><span class="token line">      {
</span><span class="token prefix unchanged"> </span><span class="token line">        test: /\.(png|svg|jpg|jpeg|gif)$/i,
</span><span class="token prefix unchanged"> </span><span class="token line">        type: 'asset/resource',
</span><span class="token prefix unchanged"> </span><span class="token line">      },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      {
</span><span class="token prefix inserted">+</span><span class="token line">        test: /\.(woff|woff2|eot|ttf|otf)$/i,
</span><span class="token prefix inserted">+</span><span class="token line">        type: 'asset/resource',
</span><span class="token prefix inserted">+</span><span class="token line">      },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    ],
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>프로젝트에 몇 개의 폰트 파일을 추가합니다.</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> webpack-demo
</span><span class="token prefix unchanged"> </span><span class="token line"> |- package.json
</span><span class="token prefix unchanged"> </span><span class="token line"> |- webpack.config.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /dist
</span><span class="token prefix unchanged"> </span><span class="token line">   |- bundle.js
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.html
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /src
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   |- my-font.woff
</span><span class="token prefix inserted">+</span><span class="token line">   |- my-font.woff2
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   |- icon.png
</span><span class="token prefix unchanged"> </span><span class="token line">   |- style.css
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /node_modules</span></span></code></pre> <p>로더를 설정하고 폰트가 맞는 위치에 있으면 <code>@font-face</code> 선언을 통해 적용 할 수 있습니다. 로컬 <code>url(...)</code> 지시문은 이미지와 마찬가지로 webpack에서 골라냅니다.</p> <p><strong>src/style.css</strong></p> <pre><code class="hljs language-diff"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">@font-face {
</span><span class="token prefix inserted">+</span><span class="token line">  font-family: 'MyFont';
</span><span class="token prefix inserted">+</span><span class="token line">  src: url('./my-font.woff2') format('woff2'),
</span><span class="token prefix inserted">+</span><span class="token line">    url('./my-font.woff') format('woff');
</span><span class="token prefix inserted">+</span><span class="token line">  font-weight: 600;
</span><span class="token prefix inserted">+</span><span class="token line">  font-style: normal;
</span><span class="token prefix inserted">+</span><span class="token line">}
</span><span class="token prefix inserted">+</span><span class="token line">
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">.hello {
</span><span class="token prefix unchanged"> </span><span class="token line">  color: red;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  font-family: 'MyFont';
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  background: url('./icon.png');
</span><span class="token prefix unchanged"> </span><span class="token line">}</span></span></code></pre> <p>이제 새 빌드를 실행하고 webpack이 폰트를 처리했는지 살펴보겠습니다.</p> <pre><code class="hljs language-bash">$ <span class="token function">npm</span> run build

<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>webpack-cli<span class="token punctuation">]</span> Compilation finished
assets by status <span class="token number">9.88</span> KiB <span class="token punctuation">[</span>cached<span class="token punctuation">]</span> <span class="token number">1</span> asset
assets by info <span class="token number">33.2</span> KiB <span class="token punctuation">[</span>immutable<span class="token punctuation">]</span>
  asset 55055dbfc7c6a83f60ba.woff <span class="token number">18.8</span> KiB <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span> <span class="token punctuation">[</span>immutable<span class="token punctuation">]</span> <span class="token punctuation">[</span>from: src/my-font.woff<span class="token punctuation">]</span> <span class="token punctuation">(</span>auxiliary name: main<span class="token punctuation">)</span>
  asset 8f717b802eaab4d7fb94.woff2 <span class="token number">14.5</span> KiB <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span> <span class="token punctuation">[</span>immutable<span class="token punctuation">]</span> <span class="token punctuation">[</span>from: src/my-font.woff2<span class="token punctuation">]</span> <span class="token punctuation">(</span>auxiliary name: main<span class="token punctuation">)</span>
asset bundle.js <span class="token number">73.7</span> KiB <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span> <span class="token punctuation">[</span>minimized<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: main<span class="token punctuation">)</span> <span class="token number">1</span> related asset
runtime modules <span class="token number">1.82</span> KiB <span class="token number">6</span> modules
orphan modules <span class="token number">326</span> bytes <span class="token punctuation">[</span>orphan<span class="token punctuation">]</span> <span class="token number">1</span> module
cacheable modules <span class="token number">541</span> KiB <span class="token punctuation">(</span>javascript<span class="token punctuation">)</span> <span class="token number">43.1</span> KiB <span class="token punctuation">(</span>asset<span class="token punctuation">)</span>
  javascript modules <span class="token number">541</span> KiB
    modules by path ./node_modules/ <span class="token number">539</span> KiB
      modules by path ./node_modules/css-loader/dist/runtime/*.js <span class="token number">2.38</span> KiB <span class="token number">2</span> modules
      ./node_modules/lodash/lodash.js <span class="token number">530</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
      ./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js <span class="token number">6.67</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
    modules by path ./src/ <span class="token number">1.98</span> KiB
      ./src/index.js + <span class="token number">1</span> modules <span class="token number">794</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
      ./node_modules/css-loader/dist/cjs.js<span class="token operator">!</span>./src/style.css <span class="token number">1.21</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  asset modules <span class="token number">126</span> bytes <span class="token punctuation">(</span>javascript<span class="token punctuation">)</span> <span class="token number">43.1</span> KiB <span class="token punctuation">(</span>asset<span class="token punctuation">)</span>
    ./src/icon.png <span class="token number">42</span> bytes <span class="token punctuation">(</span>javascript<span class="token punctuation">)</span> <span class="token number">9.88</span> KiB <span class="token punctuation">(</span>asset<span class="token punctuation">)</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
    ./src/my-font.woff2 <span class="token number">42</span> bytes <span class="token punctuation">(</span>javascript<span class="token punctuation">)</span> <span class="token number">14.5</span> KiB <span class="token punctuation">(</span>asset<span class="token punctuation">)</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
    ./src/my-font.woff <span class="token number">42</span> bytes <span class="token punctuation">(</span>javascript<span class="token punctuation">)</span> <span class="token number">18.8</span> KiB <span class="token punctuation">(</span>asset<span class="token punctuation">)</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">2142</span> ms</code></pre> <p><code>dist/index.html</code>을 다시 열고 <code>Hello webpack</code> 텍스트가 새 폰트로 변경되었는지 확인합니다. 모든 것이 잘되었다면, 변경된 폰트를 확인할 수 있을 것입니다.</p> <h2 id="loading-data">Loading Data<a href="#loading-data" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>로드할 수 있는 또 다른 유용한 애셋은 JSON 파일, CSV, TSV 및 XML과 같은 데이터입니다. JSON 지원은 기본으로 내장되어 있으며 NodeJS와 유사합니다. 즉, 기본적으로 <code>import Data from './data.json'</code>이 동작합니다. CSV, TSV 및 XML을 가져오려면 <a href="https://github.com/theplatapi/csv-loader">csv-loader</a> 및 <a href="https://github.com/gisikw/xml">xml-loader</a>를 사용할 수 있습니다. 세 가지 모두 로드해 보겠습니다.</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev csv-loader xml-loader</code></pre> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: 'bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  module: {
</span><span class="token prefix unchanged"> </span><span class="token line">    rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">      {
</span><span class="token prefix unchanged"> </span><span class="token line">        test: /\.css$/i,
</span><span class="token prefix unchanged"> </span><span class="token line">        use: ['style-loader', 'css-loader'],
</span><span class="token prefix unchanged"> </span><span class="token line">      },
</span><span class="token prefix unchanged"> </span><span class="token line">      {
</span><span class="token prefix unchanged"> </span><span class="token line">        test: /\.(png|svg|jpg|jpeg|gif)$/i,
</span><span class="token prefix unchanged"> </span><span class="token line">        type: 'asset/resource',
</span><span class="token prefix unchanged"> </span><span class="token line">      },
</span><span class="token prefix unchanged"> </span><span class="token line">      {
</span><span class="token prefix unchanged"> </span><span class="token line">        test: /\.(woff|woff2|eot|ttf|otf)$/i,
</span><span class="token prefix unchanged"> </span><span class="token line">        type: 'asset/resource',
</span><span class="token prefix unchanged"> </span><span class="token line">      },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      {
</span><span class="token prefix inserted">+</span><span class="token line">        test: /\.(csv|tsv)$/i,
</span><span class="token prefix inserted">+</span><span class="token line">        use: ['csv-loader'],
</span><span class="token prefix inserted">+</span><span class="token line">      },
</span><span class="token prefix inserted">+</span><span class="token line">      {
</span><span class="token prefix inserted">+</span><span class="token line">        test: /\.xml$/i,
</span><span class="token prefix inserted">+</span><span class="token line">        use: ['xml-loader'],
</span><span class="token prefix inserted">+</span><span class="token line">      },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    ],
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>프로젝트에 데이터 파일을 추가합니다.</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> webpack-demo
</span><span class="token prefix unchanged"> </span><span class="token line"> |- package.json
</span><span class="token prefix unchanged"> </span><span class="token line"> |- webpack.config.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /dist
</span><span class="token prefix unchanged"> </span><span class="token line">   |- bundle.js
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.html
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /src
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   |- data.xml
</span><span class="token prefix inserted">+</span><span class="token line">   |- data.csv
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   |- my-font.woff
</span><span class="token prefix unchanged"> </span><span class="token line">   |- my-font.woff2
</span><span class="token prefix unchanged"> </span><span class="token line">   |- icon.png
</span><span class="token prefix unchanged"> </span><span class="token line">   |- style.css
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /node_modules</span></span></code></pre> <p><strong>src/data.xml</strong></p> <pre><code class="hljs language-xml"><span class="token prolog">&#x3C;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>note</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>to</span><span class="token punctuation">></span></span>Mary<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>to</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>from</span><span class="token punctuation">></span></span>John<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>from</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>heading</span><span class="token punctuation">></span></span>Reminder<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>heading</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>body</span><span class="token punctuation">></span></span>Call Cindy on Tuesday<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>note</span><span class="token punctuation">></span></span></code></pre> <p><strong>src/data.csv</strong></p> <pre><code class="hljs language-csv">to,from,heading,body
Mary,John,Reminder,Call Cindy on Tuesday
Zoe,Bill,Reminder,Buy orange juice
Autumn,Lindsey,Letter,I miss you
</code></pre> <p>이제 네 가지 데이터 유형(JSON, CSV, TSV, XML) 중 하나를 <code>import</code> 할 수 있으며, 가져오는 <code>Data</code> 변수에는 파싱된 JSON이 포함되어 쉽게 사용할 수 있습니다.</p> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">import _ from 'lodash';
</span><span class="token prefix unchanged"> </span><span class="token line">import './style.css';
</span><span class="token prefix unchanged"> </span><span class="token line">import Icon from './icon.png';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import Data from './data.xml';
</span><span class="token prefix inserted">+</span><span class="token line">import Notes from './data.csv';
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">  const element = document.createElement('div');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  // Lodash, now imported by this script
</span><span class="token prefix unchanged"> </span><span class="token line">  element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span><span class="token prefix unchanged"> </span><span class="token line">  element.classList.add('hello');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  // Add the image to our existing div.
</span><span class="token prefix unchanged"> </span><span class="token line">  const myIcon = new Image();
</span><span class="token prefix unchanged"> </span><span class="token line">  myIcon.src = Icon;
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  element.appendChild(myIcon);
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  console.log(Data);
</span><span class="token prefix inserted">+</span><span class="token line">  console.log(Notes);
</span><span class="token prefix inserted">+</span><span class="token line">
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  return element;
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">document.body.appendChild(component());</span></span></code></pre> <p><code>npm run build</code> 명령을 다시 실행하고 <code>dist/index.html</code>을 엽니다. 개발자 도구의 콘솔에 가져온 데이터가 기록되는 것을 볼 수 있습니다!</p> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>이것은 <a href="https://github.com/d3">d3</a>와 같은 도구를 사용하여 데이터를 시각화할 때 특히 유용할 수 있습니다. ajax 요청을 만들고 런타임에 데이터를 파싱하는 대신 빌드 프로세스 중 모듈에 로드하여 모듈이 브라우저에 도달하자마자 파싱된 데이터가 준비되도록 합니다.</p></aside> <aside class="warning"><h6 class="warning__prefix">warning</h6><p>JSON 모듈의 기본 내보내기만 경고 없이 사용할 수 있습니다.</p></aside> <pre><code class="hljs language-javascript"><span class="token comment">// 경고 없음</span>
<span class="token keyword">import</span> data <span class="token keyword">from</span> <span class="token string">'./data.json'</span><span class="token punctuation">;</span>

<span class="token comment">// 스펙에서 허용하지 않으므로 경고가 노출됨</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> foo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./data.json'</span><span class="token punctuation">;</span></code></pre> <h3 id="customize-parser-of-json-modules">Customize parser of JSON modules<a href="#customize-parser-of-json-modules" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>특정 webpack 로더 대신 [커스텀 파서](/configuration/modules# ruleparserparse)를 사용하여 <code>toml</code>, <code>yaml</code> 또는 <code>json5</code> 파일을 JSON 모듈로 가져올 수 있습니다.</p> <p><code>src</code> 폴더에 <code>data.toml</code>, <code>data.yaml</code> 및 <code>data.json5</code> 파일이 있다고 가정해 보겠습니다.</p> <p><strong>src/data.toml</strong></p> <pre><code class="hljs language-toml">title = "TOML Example"

[owner]
name = "Tom Preston-Werner"
organization = "GitHub"
bio = "GitHub Cofounder &#x26; CEO\nLikes tater tots and beer."
dob = 1979-05-27T07:32:00Z
</code></pre> <p><strong>src/data.yaml</strong></p> <pre><code class="hljs language-yaml"><span class="token key atrule">title</span><span class="token punctuation">:</span> YAML Example
<span class="token key atrule">owner</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> Tom Preston<span class="token punctuation">-</span>Werner
  <span class="token key atrule">organization</span><span class="token punctuation">:</span> GitHub
  <span class="token key atrule">bio</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token punctuation">-</span>
    GitHub Cofounder &#x26; CEO
    Likes tater tots and beer.
  <span class="token key atrule">dob</span><span class="token punctuation">:</span> <span class="token datetime number">1979-05-27T07:32:00.000Z</span></code></pre> <p><strong>src/data.json5</strong></p> <pre><code class="hljs language-json5">{
  // comment
  title: 'JSON5 Example',
  owner: {
    name: 'Tom Preston-Werner',
    organization: 'GitHub',
    bio: 'GitHub Cofounder &#x26; CEO\n\
Likes tater tots and beer.',
    dob: '1979-05-27T07:32:00.000Z',
  },
}
</code></pre> <p>먼저 <code>toml</code>, <code>yamljs</code> 및 <code>json5</code> 패키지를 설치합니다.</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> toml yamljs json5 --save-dev</code></pre> <p>그리고 webpack 설정에 추가합니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">const toml = require('toml');
</span><span class="token prefix inserted">+</span><span class="token line">const yaml = require('yamljs');
</span><span class="token prefix inserted">+</span><span class="token line">const json5 = require('json5');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: 'bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  module: {
</span><span class="token prefix unchanged"> </span><span class="token line">    rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">      {
</span><span class="token prefix unchanged"> </span><span class="token line">        test: /\.css$/i,
</span><span class="token prefix unchanged"> </span><span class="token line">        use: ['style-loader', 'css-loader'],
</span><span class="token prefix unchanged"> </span><span class="token line">      },
</span><span class="token prefix unchanged"> </span><span class="token line">      {
</span><span class="token prefix unchanged"> </span><span class="token line">        test: /\.(png|svg|jpg|jpeg|gif)$/i,
</span><span class="token prefix unchanged"> </span><span class="token line">        type: 'asset/resource',
</span><span class="token prefix unchanged"> </span><span class="token line">      },
</span><span class="token prefix unchanged"> </span><span class="token line">      {
</span><span class="token prefix unchanged"> </span><span class="token line">        test: /\.(woff|woff2|eot|ttf|otf)$/i,
</span><span class="token prefix unchanged"> </span><span class="token line">        type: 'asset/resource',
</span><span class="token prefix unchanged"> </span><span class="token line">      },
</span><span class="token prefix unchanged"> </span><span class="token line">      {
</span><span class="token prefix unchanged"> </span><span class="token line">        test: /\.(csv|tsv)$/i,
</span><span class="token prefix unchanged"> </span><span class="token line">        use: ['csv-loader'],
</span><span class="token prefix unchanged"> </span><span class="token line">      },
</span><span class="token prefix unchanged"> </span><span class="token line">      {
</span><span class="token prefix unchanged"> </span><span class="token line">        test: /\.xml$/i,
</span><span class="token prefix unchanged"> </span><span class="token line">        use: ['xml-loader'],
</span><span class="token prefix unchanged"> </span><span class="token line">      },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      {
</span><span class="token prefix inserted">+</span><span class="token line">        test: /\.toml$/i,
</span><span class="token prefix inserted">+</span><span class="token line">        type: 'json',
</span><span class="token prefix inserted">+</span><span class="token line">        parser: {
</span><span class="token prefix inserted">+</span><span class="token line">          parse: toml.parse,
</span><span class="token prefix inserted">+</span><span class="token line">        },
</span><span class="token prefix inserted">+</span><span class="token line">      },
</span><span class="token prefix inserted">+</span><span class="token line">      {
</span><span class="token prefix inserted">+</span><span class="token line">        test: /\.yaml$/i,
</span><span class="token prefix inserted">+</span><span class="token line">        type: 'json',
</span><span class="token prefix inserted">+</span><span class="token line">        parser: {
</span><span class="token prefix inserted">+</span><span class="token line">          parse: yaml.parse,
</span><span class="token prefix inserted">+</span><span class="token line">        },
</span><span class="token prefix inserted">+</span><span class="token line">      },
</span><span class="token prefix inserted">+</span><span class="token line">      {
</span><span class="token prefix inserted">+</span><span class="token line">        test: /\.json5$/i,
</span><span class="token prefix inserted">+</span><span class="token line">        type: 'json',
</span><span class="token prefix inserted">+</span><span class="token line">        parser: {
</span><span class="token prefix inserted">+</span><span class="token line">          parse: json5.parse,
</span><span class="token prefix inserted">+</span><span class="token line">        },
</span><span class="token prefix inserted">+</span><span class="token line">      },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    ],
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">import _ from 'lodash';
</span><span class="token prefix unchanged"> </span><span class="token line">import './style.css';
</span><span class="token prefix unchanged"> </span><span class="token line">import Icon from './icon.png';
</span><span class="token prefix unchanged"> </span><span class="token line">import Data from './data.xml';
</span><span class="token prefix unchanged"> </span><span class="token line">import Notes from './data.csv';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import toml from './data.toml';
</span><span class="token prefix inserted">+</span><span class="token line">import yaml from './data.yaml';
</span><span class="token prefix inserted">+</span><span class="token line">import json from './data.json5';
</span><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line">console.log(toml.title); // output `TOML Example`
</span><span class="token prefix inserted">+</span><span class="token line">console.log(toml.owner.name); // output `Tom Preston-Werner`
</span><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line">console.log(yaml.title); // output `YAML Example`
</span><span class="token prefix inserted">+</span><span class="token line">console.log(yaml.owner.name); // output `Tom Preston-Werner`
</span><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line">console.log(json.title); // output `JSON5 Example`
</span><span class="token prefix inserted">+</span><span class="token line">console.log(json.owner.name); // output `Tom Preston-Werner`
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">  const element = document.createElement('div');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  // Lodash, now imported by this script
</span><span class="token prefix unchanged"> </span><span class="token line">  element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span><span class="token prefix unchanged"> </span><span class="token line">  element.classList.add('hello');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  // Add the image to our existing div.
</span><span class="token prefix unchanged"> </span><span class="token line">  const myIcon = new Image();
</span><span class="token prefix unchanged"> </span><span class="token line">  myIcon.src = Icon;
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  element.appendChild(myIcon);
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  console.log(Data);
</span><span class="token prefix unchanged"> </span><span class="token line">  console.log(Notes);
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  return element;
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">document.body.appendChild(component());</span></span></code></pre> <p><code>npm run build</code> 명령을 다시 실행하고 <code>dist/index.html</code>을 확인합니다. 가져온 데이터가 콘솔에 기록되는 것을 볼 수 있습니다!</p> <h2 id="global-assets">Global Assets<a href="#global-assets" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>위에서 언급 한 모든 것 중 가장 멋진 점은 이러한 방식으로 애셋을 로드하면 모듈과 애셋을 보다 직관적인 방식으로 그룹화할 수 있다는 것입니다. 모든 것을 포함한 글로벌 <code>/assets</code> 디렉터리에 의존하는 대신 애셋을 사용하는 코드와 그룹화할 수 있습니다. 예를 들어 다음과 같은 구조가 유용할 수 있습니다.</p> <pre><code class="hljs language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> |- /assets
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> |– /components
</span><span class="token prefix inserted">+</span><span class="token line"> |  |– /my-component
</span><span class="token prefix inserted">+</span><span class="token line"> |  |  |– index.jsx
</span><span class="token prefix inserted">+</span><span class="token line"> |  |  |– index.css
</span><span class="token prefix inserted">+</span><span class="token line"> |  |  |– icon.svg
</span><span class="token prefix inserted">+</span><span class="token line"> |  |  |– img.png</span></span></code></pre> <p>이러한 설정은 밀접하게 연결된 모든 것이 함께 있기 때문에 코드를 다른 곳에 훨씬 더 쉽게 적용할 수 있도록 합니다. 다른 프로젝트에서 <code>/my-component</code>를 사용한다고 가정해 봅시다. 간단히 복사하거나 다른 프로젝트의 <code>/components</code> 디렉터리로 옮기면 됩니다. <em>외부 의존성을</em> 설치하고 <em>설정에 동일한 로더가 정의되어있는 한</em> 아무 문제가 없습니다.</p> <p>그러나 예전 방식을 고수하고 있거나 여러 컴포넌트(뷰, 템플릿, 모듈 등) 간에 공유되는 애셋이 있다고 가정해 보겠습니다. 이러한 애셋을 기본 디렉터리에 저장하는 것도 가능하며 <a href="/configuration/resolve/#resolvealias">aliasing</a>을 사용하여 쉽게 <code>import</code> 할 수 있습니다.</p> <h2 id="wrapping-up">Wrapping up<a href="#wrapping-up" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>다음 가이드에서는 이 가이드에서 사용한 각기 다른 애셋을 모두 사용하지 않을 것이므로 다음 가이드인 <a href="https://webpack.js.org/guides/output-management/">Output Management</a> 준비를 위해 정리를 해 보겠습니다.</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> webpack-demo
</span><span class="token prefix unchanged"> </span><span class="token line"> |- package.json
</span><span class="token prefix unchanged"> </span><span class="token line"> |- webpack.config.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /dist
</span><span class="token prefix unchanged"> </span><span class="token line">   |- bundle.js
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.html
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /src
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">   |- data.csv
</span><span class="token prefix deleted">-</span><span class="token line">   |- data.json5
</span><span class="token prefix deleted">-</span><span class="token line">   |- data.toml
</span><span class="token prefix deleted">-</span><span class="token line">   |- data.xml
</span><span class="token prefix deleted">-</span><span class="token line">   |- data.yaml
</span><span class="token prefix deleted">-</span><span class="token line">   |- icon.png
</span><span class="token prefix deleted">-</span><span class="token line">   |- my-font.woff
</span><span class="token prefix deleted">-</span><span class="token line">   |- my-font.woff2
</span><span class="token prefix deleted">-</span><span class="token line">   |- style.css
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   |- index.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /node_modules</span></span></code></pre> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">const toml = require('toml');
</span><span class="token prefix deleted">-</span><span class="token line">const yaml = require('yamljs');
</span><span class="token prefix deleted">-</span><span class="token line">const json5 = require('json5');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: 'bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  module: {
</span><span class="token prefix deleted">-</span><span class="token line">    rules: [
</span><span class="token prefix deleted">-</span><span class="token line">      {
</span><span class="token prefix deleted">-</span><span class="token line">        test: /\.css$/i,
</span><span class="token prefix deleted">-</span><span class="token line">        use: ['style-loader', 'css-loader'],
</span><span class="token prefix deleted">-</span><span class="token line">      },
</span><span class="token prefix deleted">-</span><span class="token line">      {
</span><span class="token prefix deleted">-</span><span class="token line">        test: /\.(png|svg|jpg|jpeg|gif)$/i,
</span><span class="token prefix deleted">-</span><span class="token line">        type: 'asset/resource',
</span><span class="token prefix deleted">-</span><span class="token line">      },
</span><span class="token prefix deleted">-</span><span class="token line">      {
</span><span class="token prefix deleted">-</span><span class="token line">        test: /\.(woff|woff2|eot|ttf|otf)$/i,
</span><span class="token prefix deleted">-</span><span class="token line">        type: 'asset/resource',
</span><span class="token prefix deleted">-</span><span class="token line">      },
</span><span class="token prefix deleted">-</span><span class="token line">      {
</span><span class="token prefix deleted">-</span><span class="token line">        test: /\.(csv|tsv)$/i,
</span><span class="token prefix deleted">-</span><span class="token line">        use: ['csv-loader'],
</span><span class="token prefix deleted">-</span><span class="token line">      },
</span><span class="token prefix deleted">-</span><span class="token line">      {
</span><span class="token prefix deleted">-</span><span class="token line">        test: /\.xml$/i,
</span><span class="token prefix deleted">-</span><span class="token line">        use: ['xml-loader'],
</span><span class="token prefix deleted">-</span><span class="token line">      },
</span><span class="token prefix deleted">-</span><span class="token line">      {
</span><span class="token prefix deleted">-</span><span class="token line">        test: /\.toml$/i,
</span><span class="token prefix deleted">-</span><span class="token line">        type: 'json',
</span><span class="token prefix deleted">-</span><span class="token line">        parser: {
</span><span class="token prefix deleted">-</span><span class="token line">          parse: toml.parse,
</span><span class="token prefix deleted">-</span><span class="token line">        },
</span><span class="token prefix deleted">-</span><span class="token line">      },
</span><span class="token prefix deleted">-</span><span class="token line">      {
</span><span class="token prefix deleted">-</span><span class="token line">        test: /\.yaml$/i,
</span><span class="token prefix deleted">-</span><span class="token line">        type: 'json',
</span><span class="token prefix deleted">-</span><span class="token line">        parser: {
</span><span class="token prefix deleted">-</span><span class="token line">          parse: yaml.parse,
</span><span class="token prefix deleted">-</span><span class="token line">        },
</span><span class="token prefix deleted">-</span><span class="token line">      },
</span><span class="token prefix deleted">-</span><span class="token line">      {
</span><span class="token prefix deleted">-</span><span class="token line">        test: /\.json5$/i,
</span><span class="token prefix deleted">-</span><span class="token line">        type: 'json',
</span><span class="token prefix deleted">-</span><span class="token line">        parser: {
</span><span class="token prefix deleted">-</span><span class="token line">          parse: json5.parse,
</span><span class="token prefix deleted">-</span><span class="token line">        },
</span><span class="token prefix deleted">-</span><span class="token line">      },
</span><span class="token prefix deleted">-</span><span class="token line">    ],
</span><span class="token prefix deleted">-</span><span class="token line">  },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">import _ from 'lodash';
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">import './style.css';
</span><span class="token prefix deleted">-</span><span class="token line">import Icon from './icon.png';
</span><span class="token prefix deleted">-</span><span class="token line">import Data from './data.xml';
</span><span class="token prefix deleted">-</span><span class="token line">import Notes from './data.csv';
</span><span class="token prefix deleted">-</span><span class="token line">import toml from './data.toml';
</span><span class="token prefix deleted">-</span><span class="token line">import yaml from './data.yaml';
</span><span class="token prefix deleted">-</span><span class="token line">import json from './data.json5';
</span><span class="token prefix deleted">-</span><span class="token line">
</span><span class="token prefix deleted">-</span><span class="token line">console.log(toml.title); // output `TOML Example`
</span><span class="token prefix deleted">-</span><span class="token line">console.log(toml.owner.name); // output `Tom Preston-Werner`
</span><span class="token prefix deleted">-</span><span class="token line">
</span><span class="token prefix deleted">-</span><span class="token line">console.log(yaml.title); // output `YAML Example`
</span><span class="token prefix deleted">-</span><span class="token line">console.log(yaml.owner.name); // output `Tom Preston-Werner`
</span><span class="token prefix deleted">-</span><span class="token line">
</span><span class="token prefix deleted">-</span><span class="token line">console.log(json.title); // output `JSON5 Example`
</span><span class="token prefix deleted">-</span><span class="token line">console.log(json.owner.name); // output `Tom Preston-Werner`
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">  const element = document.createElement('div');
</span></span>
<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  // Lodash, now imported by this script
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  element.classList.add('hello');
</span><span class="token prefix deleted">-</span><span class="token line">
</span><span class="token prefix deleted">-</span><span class="token line">  // Add the image to our existing div.
</span><span class="token prefix deleted">-</span><span class="token line">  const myIcon = new Image();
</span><span class="token prefix deleted">-</span><span class="token line">  myIcon.src = Icon;
</span><span class="token prefix deleted">-</span><span class="token line">
</span><span class="token prefix deleted">-</span><span class="token line">  element.appendChild(myIcon);
</span><span class="token prefix deleted">-</span><span class="token line">
</span><span class="token prefix deleted">-</span><span class="token line">  console.log(Data);
</span><span class="token prefix deleted">-</span><span class="token line">  console.log(Notes);
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  return element;
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">document.body.appendChild(component());</span></span></code></pre> <p>그리고 추가했던 의존성을 제거합니다.</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> uninstall css-loader csv-loader json5 style-loader toml xml-loader yamljs</code></pre> <h2 id="next-guide">Next guide<a href="#next-guide" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>이제 <a href="https://webpack.js.org/guides/output-management/">Output Management</a>로 넘어가 보겠습니다.</p> <h2 id="further-reading">Further Reading<a href="#further-reading" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <ul> <li>SurviveJS의 <a href="https://survivejs.com/webpack/loading/fonts/">Loading Fonts</a></li> </ul> <h1 id="output-management">Output Management<a href="#output-management" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>이 가이드는 <a href="/guides/asset-management"><code>Asset Management</code></a> 가이드에 있는 코드 예제를 기준으로 합니다.</p></aside> <p>지금까지 모든 애셋을 <code>index.html</code> 파일에 수동으로 포함했습니다. 하지만 애플리케이션이 커지면서 <a href="/guides/caching">파일 이름에 해시를 사용</a>하거나 <a href="/guides/code-splitting">다중 번들</a>로 내보내기 시작하면 <code>index.html</code> 파일을 수동으로 관리하기 어렵습니다. 이 때 몇 가지 플러그인으로 이 프로세스를 훨씬 쉽게 관리할 수 있습니다.</p> <h2 id="preparation">Preparation<a href="#preparation" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>먼저 프로젝트를 조금 수정해보겠습니다.</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> webpack-demo
</span><span class="token prefix unchanged"> </span><span class="token line"> |- package.json
</span><span class="token prefix unchanged"> </span><span class="token line"> |- webpack.config.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /dist
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /src
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.js
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   |- print.js
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- /node_modules</span></span></code></pre> <p><code>src/print.js</code> 파일에 로직을 추가합니다.</p> <p><strong>src/print.js</strong></p> <pre><code class="hljs language-js"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">printMe</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'I get called from print.js!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> <p>그리고 <code>src/index.js</code> 파일에서 이 함수를 사용합니다.</p> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">import _ from 'lodash';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import printMe from './print.js';
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">  const element = document.createElement('div');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  const btn = document.createElement('button');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  btn.innerHTML = 'Click me and check the console!';
</span><span class="token prefix inserted">+</span><span class="token line">  btn.onclick = printMe;
</span><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line">  element.appendChild(btn);
</span><span class="token prefix inserted">+</span><span class="token line">
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  return element;
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">document.body.appendChild(component());</span></span></code></pre> <p>webpack이 엔트리를 분할할 수 있도록 <code>dist/index.html</code> 파일도 업데이트해 보겠습니다.</p> <p><strong>dist/index.html</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">&#x3C;!DOCTYPE html>
</span><span class="token prefix unchanged"> </span><span class="token line">&#x3C;html>
</span><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;head>
</span><span class="token prefix unchanged"> </span><span class="token line">    &#x3C;meta charset="utf-8" />
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    &#x3C;title>Asset Management&#x3C;/title>
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &#x3C;title>Output Management&#x3C;/title>
</span><span class="token prefix inserted">+</span><span class="token line">    &#x3C;script src="./print.bundle.js">&#x3C;/script>
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;/head>
</span><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;body>
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    &#x3C;script src="bundle.js">&#x3C;/script>
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &#x3C;script src="./index.bundle.js">&#x3C;/script>
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;/body>
</span><span class="token prefix unchanged"> </span><span class="token line">&#x3C;/html></span></span></code></pre> <p>이제 설정을 수정합니다. <code>src/print.js</code>를 새 엔트리 포인트(<code>print</code>)로 추가합니다. 그리고 출력 번들 이름이 엔트리 포인트 이름을 기반으로 동적으로 생성되도록 변경합니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  entry: './src/index.js',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  entry: {
</span><span class="token prefix inserted">+</span><span class="token line">    index: './src/index.js',
</span><span class="token prefix inserted">+</span><span class="token line">    print: './src/print.js',
</span><span class="token prefix inserted">+</span><span class="token line">  },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    filename: 'bundle.js',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    filename: '[name].bundle.js',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p><code>npm run build</code>를 실행하고 무엇이 생성되는지 살펴보겠습니다.</p> <pre><code class="hljs language-bash"><span class="token punctuation">..</span>.
<span class="token punctuation">[</span>webpack-cli<span class="token punctuation">]</span> Compilation finished
asset index.bundle.js <span class="token number">69.5</span> KiB <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span> <span class="token punctuation">[</span>minimized<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: index<span class="token punctuation">)</span> <span class="token number">1</span> related asset
asset print.bundle.js <span class="token number">316</span> bytes <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span> <span class="token punctuation">[</span>minimized<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: print<span class="token punctuation">)</span>
runtime modules <span class="token number">1.36</span> KiB <span class="token number">7</span> modules
cacheable modules <span class="token number">530</span> KiB
  ./src/index.js <span class="token number">406</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./src/print.js <span class="token number">83</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./node_modules/lodash/lodash.js <span class="token number">530</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">1996</span> ms</code></pre> <p>webpack이 <code>print.bundle.js</code> 과 <code>index.bundle.js</code> 파일을 생성하는 것을 볼 수 있습니다. 이 파일은 <code>index.html</code> 파일에도 명시되어 있습니다. 브라우저에서 <code>index.html</code>을 열고 버튼을 클릭하면 어떻게 되는지 확인할 수 있습니다.</p> <p>그러나 엔트리 포인트 중 하나의 이름을 변경하거나 새 엔트리 포인트를 추가하면 어떻게 될까요? 생성된 번들은 빌드에서 이름이 변경되지만 <code>index.html</code> 파일은 여전히 예전 이름을 참조합니다. <a href="/plugins/html-webpack-plugin"><code>HtmlWebpackPlugin</code></a>을 사용하여 이 문제를 해결해보겠습니다.</p> <h2 id="setting-up-htmlwebpackplugin">Setting up HtmlWebpackPlugin<a href="#setting-up-htmlwebpackplugin" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>먼저 플러그인을 설치하고 <code>webpack.config.js</code> 파일을 수정합니다.</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev html-webpack-plugin</code></pre> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">const HtmlWebpackPlugin = require('html-webpack-plugin');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: {
</span><span class="token prefix unchanged"> </span><span class="token line">    index: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    print: './src/print.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  plugins: [
</span><span class="token prefix inserted">+</span><span class="token line">    new HtmlWebpackPlugin({
</span><span class="token prefix inserted">+</span><span class="token line">      title: 'Output Management',
</span><span class="token prefix inserted">+</span><span class="token line">    }),
</span><span class="token prefix inserted">+</span><span class="token line">  ],
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: '[name].bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>빌드하기 전에 <code>dist/</code> 폴더에 이미 <code>index.html</code>이 있더라도 기본적으로 <code>HtmlWebpackPlugin</code>이 자체 <code>index.html</code> 파일을 생성하는 것을 알아두세요. 이는 <code>index.html</code> 파일이 새로 생성된 파일로 대체된다는 의미입니다. <code>npm run build</code>를 실행할 때 어떤 일이 발생하는지 살펴보겠습니다.</p> <pre><code class="hljs language-bash"><span class="token punctuation">..</span>.
<span class="token punctuation">[</span>webpack-cli<span class="token punctuation">]</span> Compilation finished
asset index.bundle.js <span class="token number">69.5</span> KiB <span class="token punctuation">[</span>compared <span class="token keyword">for</span> emit<span class="token punctuation">]</span> <span class="token punctuation">[</span>minimized<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: index<span class="token punctuation">)</span> <span class="token number">1</span> related asset
asset print.bundle.js <span class="token number">316</span> bytes <span class="token punctuation">[</span>compared <span class="token keyword">for</span> emit<span class="token punctuation">]</span> <span class="token punctuation">[</span>minimized<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: print<span class="token punctuation">)</span>
asset index.html <span class="token number">253</span> bytes <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>
runtime modules <span class="token number">1.36</span> KiB <span class="token number">7</span> modules
cacheable modules <span class="token number">530</span> KiB
  ./src/index.js <span class="token number">406</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./src/print.js <span class="token number">83</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./node_modules/lodash/lodash.js <span class="token number">530</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">2189</span> ms</code></pre> <p>코드 편집기에서 <code>index.html</code>을 열면 <code>HtmlWebpackPlugin</code>이 완전히 새로운 파일을 생성했으며 모든 번들이 자동으로 추가된 것을 알 수 있습니다.</p> <p><code>HtmlWebpackPlugin</code>이 제공하는 모든 기능과 옵션에 대해 더 자세히 알아보려면 <a href="https://github.com/jantimonhtml-webpack-plugin"><code>HtmlWebpackPlugin</code></a> 저장소를 확인해 보세요.</p> <h2 id="cleaning-up-the-dist-folder">Cleaning up the <code>/dist</code> folder<a href="#cleaning-up-the-dist-folder" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>이전 가이드와 코드 예제에서 눈치챘겠지만 <code>/dist</code> 폴더가 상당히 복잡해졌습니다. webpack은 파일을 생성하여 <code>/dist</code> 폴더에 저장하지만, 프로젝트에서 실제로 사용하는 파일이 어떤 건지는 알지 못합니다.</p> <p>일반적으로 사용하는 파일만 생성되도록 각 빌드 전에 <code>/dist</code> 폴더를 정리하는 것이 좋습니다. <a href="/configuration/output/#outputclean"><code>output.clean</code></a> 옵션을 사용하여 처리해보겠습니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line">const HtmlWebpackPlugin = require('html-webpack-plugin');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: {
</span><span class="token prefix unchanged"> </span><span class="token line">    index: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    print: './src/print.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">    new HtmlWebpackPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">      title: 'Output Management',
</span><span class="token prefix unchanged"> </span><span class="token line">    }),
</span><span class="token prefix unchanged"> </span><span class="token line">  ],
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: '[name].bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    clean: true,
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>이제 <code>npm run build</code>를 실행하고 <code>/dist</code> 폴더를 확인해보세요. 모든 것이 잘 되었다면 이제 오래된 파일 없이 빌드에서 생성된 파일만 볼 수 있습니다!</p> <h2 id="the-manifest">The Manifest<a href="#the-manifest" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>webpack과 플러그인은 어떤 파일이 생성되는 것을 어떻게 "알고 있는지" 궁금할 것입니다. 답은 매니페스트에 있습니다. webpack은 모든 모듈이 출력 번들에 어떻게 매핑되는지 추적합니다. 만약 webpack의 <a href="/configuration/output"><code>output</code></a>을 다른 방식으로 관리하는데 관심이 있다면 매니페스트부터 시작하는 것이 좋습니다.</p> <p>매니페스트 데이터는 <a href="https://github.com/shellscape/webpack-manifest-plugin"><code>WebpackManifestPlugin</code></a>을 사용하여 쉽게 적용 가능한 json 파일로 추출할 수 있습니다.</p> <p>프로젝트에서 이 플러그인을 사용하는 방법에 대한 모든 예제를 다루지는 않겠지만 <a href="/concepts/manifest">콘셉 페이지</a> 및 <a href="/guides/caching">캐싱 가이드</a>를 읽어 보면 이것이 장기 캐싱과 어떻게 연결되는지 확인할 수 있습니다.</p> <h2 id="conclusion-1">Conclusion<a href="#conclusion-1" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>HTML에 번들을 동적으로 추가하는 방법을 배웠으므로 이제 <a href="/guides/development">개발 가이드</a>를 살펴보세요. 또는 심화 항목을 자세히 알아보고 싶다면 <a href="/guides/code-splitting">코드 스플리팅 가이드</a>를 추천합니다.</p> <h1 id="development">Development<a href="#development" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>이 가이드는 <a href="/guides/output-management">출력 관리</a> 가이드에 있는 코드 예제를 확장합니다.</p></aside> <p>가이드를 차례대로 따라왔다면, webpack 기본 사양 중 일부를 확실히 이해하고 있을 것입니다. 계속하기 전 우리의 삶을 좀 더 편안하게 만들 개발 환경 설정을 살펴보겠습니다.</p> <aside class="warning"><h6 class="warning__prefix">warning</h6><p>이 가이드의 도구는 <strong>오직 개발을 위한 것입니다</strong>, 프로덕션에서 사용하는 것을 <strong>피하세요!</strong></p></aside> <p>먼저 <a href="/configuration/mode/#mode-development"><code>mode</code>를 <code>'development'</code>로</a> 설정하고 <code>title</code>을 <code>'Development'</code>로 설정해보겠습니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line">const HtmlWebpackPlugin = require('html-webpack-plugin');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  mode: 'development',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  entry: {
</span><span class="token prefix unchanged"> </span><span class="token line">    index: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    print: './src/print.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">    new HtmlWebpackPlugin({
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">      title: 'Output Management',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      title: 'Development',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    }),
</span><span class="token prefix unchanged"> </span><span class="token line">  ],
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: '[name].bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">    clean: true,
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <h2 id="using-source-maps">Using source maps<a href="#using-source-maps" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>webpack이 소스 코드를 번들로 묶을 때, 오류와 경고의 원래 위치를 추적하기 어려울 수 있습니다. 예를 들어, 세 개의 소스 파일(<code>a.js</code>, <code>b.js</code>, 그리고 <code>c.js</code>)을 하나의 번들로 묶고 하나의 소스 파일이 오류가 있는 경우, 스택 추적은 단순히 <code>bundle.js</code>를 가리킵니다. 오류가 발생한 소스 파일을 정확히 알고 싶기 때문에 항상 도움이 되는 것은 아닙니다.</p> <p>오류와 경고를 쉽게 추적할 수 있도록, JavaScript는 컴파일된 코드를 원래 소스로 매핑하는 <a href="http://blog.teamtreehouse.com/introduction-source-maps">소스맵</a>을 제공합니다. <code>b.js</code>에서 오류가 발생한 경우, 소스맵에서 정확히 알려줍니다.</p> <p>소스맵과 관련하여 사용할 수 있는 <a href="/configuration/devtool">다른 옵션</a>이 많이 있습니다. 필요에 따라 설정할 수 있도록 확인하세요.</p> <p>이 가이드에서는, 프로덕션에는 적합하지 않지만 설명 목적으로 유용한 <code>inline-source-map</code> 옵션을 사용하겠습니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line">const HtmlWebpackPlugin = require('html-webpack-plugin');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  mode: 'development',
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: {
</span><span class="token prefix unchanged"> </span><span class="token line">    index: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    print: './src/print.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  devtool: 'inline-source-map',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">    new HtmlWebpackPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">      title: 'Development',
</span><span class="token prefix unchanged"> </span><span class="token line">    }),
</span><span class="token prefix unchanged"> </span><span class="token line">  ],
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: '[name].bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">    clean: true,
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>이제 디버깅할 내용이 있는지 확인하고, <code>print.js</code> 파일에 오류를 생성해 보겠습니다.</p> <p><strong>src/print.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">export default function printMe() {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  console.log('I get called from print.js!');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  cosnole.log('I get called from print.js!');
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">}</span></span></code></pre> <p><code>npm run build</code>를 실행하면, 다음과 같이 컴파일됩니다.</p> <pre><code class="hljs language-bash"><span class="token punctuation">..</span>.
<span class="token punctuation">[</span>webpack-cli<span class="token punctuation">]</span> Compilation finished
asset index.bundle.js <span class="token number">1.38</span> MiB <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: index<span class="token punctuation">)</span>
asset print.bundle.js <span class="token number">6.25</span> KiB <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: print<span class="token punctuation">)</span>
asset index.html <span class="token number">272</span> bytes <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>
runtime modules <span class="token number">1.9</span> KiB <span class="token number">9</span> modules
cacheable modules <span class="token number">530</span> KiB
  ./src/index.js <span class="token number">406</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./src/print.js <span class="token number">83</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./node_modules/lodash/lodash.js <span class="token number">530</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">706</span> ms</code></pre> <p>이제 브라우저에서 <code>index.html</code> 파일을 엽니다. 버튼을 클릭하고, 오류가 표시된 콘솔을 확인합니다. 오류는 다음과 같이 표시되어야 합니다.</p> <pre><code class="hljs language-bash">Uncaught ReferenceError: cosnole is not defined
   at HTMLButtonElement.printMe <span class="token punctuation">(</span>print.js:2<span class="token punctuation">)</span></code></pre> <p>오류에서 오류가 발생 한 파일(<code>print.js</code>)과 줄 번호(2)에 대한 참조도 포함되어 있음을 알 수 있습니다. 이제 문제를 해결하기 위해 어디를 봐야 하는지 정확히 알 수 있습니다.</p> <h2 id="choosing-a-development-tool">Choosing a Development Tool<a href="#choosing-a-development-tool" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <aside class="warning"><h6 class="warning__prefix">warning</h6><p>일부 텍스트 편집기에는 다음 도구 중 일부를 방해할 수 있는 "안전한 쓰기" 기능이 있습니다. 이런 문제에 대한 해결책은 <a href="#adjusting-your-text-editor">텍스트 편집기 조정</a>을 참고하십시오.</p></aside> <p>코드를 컴파일할 때마다 <code>npm run build</code>를 수동으로 실행하는 것은 번거롭습니다.</p> <p>webpack에는 코드가 변경될 때마다 자동으로 컴파일하는 데 도움이 되는 몇 가지 옵션이 있습니다.</p> <ol> <li>webpack의 <a href="/configuration/watch/#watch">watch 모드</a></li> <li><a href="https://github.com/webpack/webpack-dev-server">webpack-dev-server</a></li> <li><a href="https://github.com/webpack/webpack-dev-middleware">webpack-dev-middleware</a></li> </ol> <p>대부분의 경우, <code>webpack-dev-server</code>를 사용하고 싶겠지만, 위의 모든 옵션을 살펴보겠습니다.</p> <h3 id="using-watch-mode">Using Watch Mode<a href="#using-watch-mode" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>webpack이 디펜던시 그래프 내의 모든 파일에서의 변경사항을 "감시"하도록 지시할 수 있습니다. 이런 파일 중 하나가 업데이트되면, 코드가 다시 컴파일되므로 전체 빌드를 수동으로 실행할 필요가 없습니다.</p> <p>webpack의 watch 모드를 시작하는 npm 스크립트를 추가해 보겠습니다.</p> <p><strong>package.json</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">{
</span><span class="token prefix unchanged"> </span><span class="token line">  "name": "webpack-demo",
</span><span class="token prefix unchanged"> </span><span class="token line">  "version": "1.0.0",
</span><span class="token prefix unchanged"> </span><span class="token line">  "description": "",
</span><span class="token prefix unchanged"> </span><span class="token line">  "private": true,
</span><span class="token prefix unchanged"> </span><span class="token line">  "scripts": {
</span><span class="token prefix unchanged"> </span><span class="token line">    "test": "echo \"Error: no test specified\" &#x26;&#x26; exit 1",
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    "watch": "webpack --watch",
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    "build": "webpack"
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  "keywords": [],
</span><span class="token prefix unchanged"> </span><span class="token line">  "author": "",
</span><span class="token prefix unchanged"> </span><span class="token line">  "license": "ISC",
</span><span class="token prefix unchanged"> </span><span class="token line">  "devDependencies": {
</span><span class="token prefix unchanged"> </span><span class="token line">    "html-webpack-plugin": "^4.5.0",
</span><span class="token prefix unchanged"> </span><span class="token line">    "webpack": "^5.4.0",
</span><span class="token prefix unchanged"> </span><span class="token line">    "webpack-cli": "^4.2.0"
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  "dependencies": {
</span><span class="token prefix unchanged"> </span><span class="token line">    "lodash": "^4.17.20"
</span><span class="token prefix unchanged"> </span><span class="token line">  }
</span><span class="token prefix unchanged"> </span><span class="token line">}</span></span></code></pre> <p>커멘드 라인에서 <code>npm run watch</code>를 실행하고 webpack이 코드를 컴파일하는 방법을 확인하세요. 스크립트가 현재 파일을 감시하고 있기 때문에 커멘드 라인을 종료하지 않은 것을 확인할 수 있습니다.</p> <p>이제, webpack이 파일을 감시하는 동안, 앞에서 소개한 오류를 제거해 보겠습니다.</p> <p><strong>src/print.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">export default function printMe() {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  cosnole.log('I get called from print.js!');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  console.log('I get called from print.js!');
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">}</span></span></code></pre> <p>이제 파일을 저장하고 터미널 창을 확인하십시오. webpack이 변경된 모듈을 자동으로 재컴파일하는 것을 볼 수 있습니다!</p> <p>유일한 단점은 변경사항을 확인하려면 브라우저를 새로 고침해야 한다는 것입니다. 이것이 자동으로 된다면 더 좋을 것이므로, <code>webpack-dev-server</code>를 사용해 봅시다.</p> <h3 id="using-webpack-dev-server">Using webpack-dev-server<a href="#using-webpack-dev-server" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p><code>webpack-dev-server</code>는 간단한 웹 서버와 실시간 다시 로딩 기능을 제공합니다. 설정해보겠습니다.</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev webpack-dev-server</code></pre> <p>설정 파일을 변경하여 개발 서버에 파일을 찾을 위치를 알려줍니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line">const HtmlWebpackPlugin = require('html-webpack-plugin');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  mode: 'development',
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: {
</span><span class="token prefix unchanged"> </span><span class="token line">    index: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    print: './src/print.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  devtool: 'inline-source-map',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  devServer: {
</span><span class="token prefix inserted">+</span><span class="token line">    contentBase: './dist',
</span><span class="token prefix inserted">+</span><span class="token line">  },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">    new HtmlWebpackPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">      title: 'Development',
</span><span class="token prefix unchanged"> </span><span class="token line">    }),
</span><span class="token prefix unchanged"> </span><span class="token line">  ],
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: '[name].bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">    clean: true,
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>이것은 <code>webpack-dev-server</code>에게 <code>dist</code> 디렉터리의 파일을 <code>localhost:8080</code>에서 제공하도록 합니다.</p> <aside class="tip"><h6 class="tip__prefix">tip</h6><p><code>webpack-dev-server</code>는 <a href="/configuration/output/#outputpath"><code>output.path</code></a>에 정의된 디렉터리에서 번들된 파일을 제공합니다. 예를 들면, 파일은 <code>http://[devServer.host]:[devServer.port]/[output.publicPath]/[output.filename]</code> 주소로 사용할 수 있습니다.</p></aside> <aside class="warning"><h6 class="warning__prefix">warning</h6><p>webpack-dev-server는 컴파일 후 출력 파일을 작성하지 않습니다. 대신 번들 파일을 메모리에 보관하고 서버의 루트 경로에 마운트 된 실제 파일인 것처럼 제공합니다. 페이지가 다른 경로에서 번들 파일을 찾을 것으로 예상하는 경우 개발 서버 설정에서 <a href="/configuration/dev-server/#devserverpublicpath-"><code>publicPath</code></a> 옵션을 사용하여 변경할 수 있습니다.</p></aside> <p>개발 서버를 쉽게 실행할 수 있는 스크립트를 추가해보겠습니다.</p> <p><strong>package.json</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">{
</span><span class="token prefix unchanged"> </span><span class="token line">  "name": "webpack-demo",
</span><span class="token prefix unchanged"> </span><span class="token line">  "version": "1.0.0",
</span><span class="token prefix unchanged"> </span><span class="token line">  "description": "",
</span><span class="token prefix unchanged"> </span><span class="token line">  "private": true,
</span><span class="token prefix unchanged"> </span><span class="token line">  "scripts": {
</span><span class="token prefix unchanged"> </span><span class="token line">    "test": "echo \"Error: no test specified\" &#x26;&#x26; exit 1",
</span><span class="token prefix unchanged"> </span><span class="token line">    "watch": "webpack --watch",
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    "start": "webpack serve --open",
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    "build": "webpack"
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  "keywords": [],
</span><span class="token prefix unchanged"> </span><span class="token line">  "author": "",
</span><span class="token prefix unchanged"> </span><span class="token line">  "license": "ISC",
</span><span class="token prefix unchanged"> </span><span class="token line">  "devDependencies": {
</span><span class="token prefix unchanged"> </span><span class="token line">    "html-webpack-plugin": "^4.5.0",
</span><span class="token prefix unchanged"> </span><span class="token line">    "webpack": "^5.4.0",
</span><span class="token prefix unchanged"> </span><span class="token line">    "webpack-cli": "^4.2.0",
</span><span class="token prefix unchanged"> </span><span class="token line">    "webpack-dev-server": "^3.11.0"
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  "dependencies": {
</span><span class="token prefix unchanged"> </span><span class="token line">    "lodash": "^4.17.20"
</span><span class="token prefix unchanged"> </span><span class="token line">  }
</span><span class="token prefix unchanged"> </span><span class="token line">}</span></span></code></pre> <p>이제 커멘드 라인에서 <code>npm start</code>를 실행할 수 있으며 브라우저가 자동으로 페이지를 로드하는 것을 볼 수 있습니다. 이제 소스 파일을 변경하고 저장하면, 코드가 컴파일된 후 웹 서버가 자동으로 다시 로드됩니다. 시도해 보세요!</p> <p><code>webpack-dev-server</code>에는 설정 가능한 많은 옵션이 있습니다. 자세한 내용은 <a href="/configuration/dev-server">문서</a>를 참고하세요.</p> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>이제 서버가 작동 중이므로, <a href="/guides/hot-module-replacement">Hot module replacement</a>를 사용해보세요!</p></aside> <h3 id="using-webpack-dev-middleware">Using webpack-dev-middleware<a href="#using-webpack-dev-middleware" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p><code>webpack-dev-middleware</code>는 webpack에서 처리한 파일을 서버로 내보내는 래퍼 입니다. 이것은 내부적으로 <code>webpack-dev-server</code>에서 사용되지만, 사용자가 원하는 경우 더 많은 설정을 허용하기 위해 별도의 패키지로 사용할 수 있습니다. <code>webpack-dev-middleware</code>와 express 서버를 결합한 예를 살펴보겠습니다.</p> <p>시작하기 전에 <code>express</code>와 <code>webpack-dev-middleware</code>를 설치하겠습니다.</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev express webpack-dev-middleware</code></pre> <p>이제 미들웨어가 올바르게 작동하는지 확인하기 위해 webpack의 설정 파일을 약간 수정해야 합니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line">const HtmlWebpackPlugin = require('html-webpack-plugin');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  mode: 'development',
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: {
</span><span class="token prefix unchanged"> </span><span class="token line">    index: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    print: './src/print.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  devtool: 'inline-source-map',
</span><span class="token prefix unchanged"> </span><span class="token line">  devServer: {
</span><span class="token prefix unchanged"> </span><span class="token line">    contentBase: './dist',
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">    new HtmlWebpackPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">      title: 'Development',
</span><span class="token prefix unchanged"> </span><span class="token line">    }),
</span><span class="token prefix unchanged"> </span><span class="token line">  ],
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: '[name].bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">    clean: true,
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    publicPath: '/',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p><code>http://localhost:3000</code>에서 파일이 올바르게 제공되는지 확인하기 위해 <code>publicPath</code>가 서버 스크립트 내에서도 사용됩니다. 나중에 포트 번호를 지정합니다. 다음 단계는 커스텀 <code>express</code> 서버를 설정하는 것입니다.</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> webpack-demo
</span><span class="token prefix unchanged"> </span><span class="token line"> |- package.json
</span><span class="token prefix unchanged"> </span><span class="token line"> |- webpack.config.js
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> |- server.js
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- /dist
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /src
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.js
</span><span class="token prefix unchanged"> </span><span class="token line">   |- print.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /node_modules</span></span></code></pre> <p><strong>server.js</strong></p> <pre><code class="hljs language-javascript"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpackDevMiddleware <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-dev-middleware'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack.config.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> compiler <span class="token operator">=</span> <span class="token function">webpack</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// express에서 webpack-dev-middleware와 webpack.config.js를 사용하도록 설정하세요.</span>
<span class="token comment">// 기본 설정 파일</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
  <span class="token function">webpackDevMiddleware</span><span class="token punctuation">(</span>compiler<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    publicPath<span class="token operator">:</span> config<span class="token punctuation">.</span>output<span class="token punctuation">.</span>publicPath<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 포트 3000에서 파일 제공</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Example app listening on port 3000!\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p>이제 서버를 좀 더 쉽게 실행할 수 있도록 npm 스크립트를 추가합니다.</p> <p><strong>package.json</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">{
</span><span class="token prefix unchanged"> </span><span class="token line">  "name": "webpack-demo",
</span><span class="token prefix unchanged"> </span><span class="token line">  "version": "1.0.0",
</span><span class="token prefix unchanged"> </span><span class="token line">  "description": "",
</span><span class="token prefix unchanged"> </span><span class="token line">  "private": true,
</span><span class="token prefix unchanged"> </span><span class="token line">  "scripts": {
</span><span class="token prefix unchanged"> </span><span class="token line">    "test": "echo \"Error: no test specified\" &#x26;&#x26; exit 1",
</span><span class="token prefix unchanged"> </span><span class="token line">    "watch": "webpack --watch",
</span><span class="token prefix unchanged"> </span><span class="token line">    "start": "webpack serve --open",
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    "server": "node server.js",
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    "build": "webpack"
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  "keywords": [],
</span><span class="token prefix unchanged"> </span><span class="token line">  "author": "",
</span><span class="token prefix unchanged"> </span><span class="token line">  "license": "ISC",
</span><span class="token prefix unchanged"> </span><span class="token line">  "devDependencies": {
</span><span class="token prefix unchanged"> </span><span class="token line">    "express": "^4.17.1",
</span><span class="token prefix unchanged"> </span><span class="token line">    "html-webpack-plugin": "^4.5.0",
</span><span class="token prefix unchanged"> </span><span class="token line">    "webpack": "^5.4.0",
</span><span class="token prefix unchanged"> </span><span class="token line">    "webpack-cli": "^4.2.0",
</span><span class="token prefix unchanged"> </span><span class="token line">    "webpack-dev-middleware": "^4.0.2",
</span><span class="token prefix unchanged"> </span><span class="token line">    "webpack-dev-server": "^3.11.0"
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  "dependencies": {
</span><span class="token prefix unchanged"> </span><span class="token line">    "lodash": "^4.17.20"
</span><span class="token prefix unchanged"> </span><span class="token line">  }
</span><span class="token prefix unchanged"> </span><span class="token line">}</span></span></code></pre> <p>이제 터미널에서 <code>npm run server</code>를 실행하면, 다음과 유사한 출력이 표시됩니다.</p> <pre><code class="hljs language-bash">Example app listening on port <span class="token number">3000</span><span class="token operator">!</span>
<span class="token punctuation">..</span>.
<span class="token operator">&#x3C;</span>i<span class="token operator">></span> <span class="token punctuation">[</span>webpack-dev-middleware<span class="token punctuation">]</span> asset index.bundle.js <span class="token number">1.38</span> MiB <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: index<span class="token punctuation">)</span>
<span class="token operator">&#x3C;</span>i<span class="token operator">></span> asset print.bundle.js <span class="token number">6.25</span> KiB <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: print<span class="token punctuation">)</span>
<span class="token operator">&#x3C;</span>i<span class="token operator">></span> asset index.html <span class="token number">274</span> bytes <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>
<span class="token operator">&#x3C;</span>i<span class="token operator">></span> runtime modules <span class="token number">1.9</span> KiB <span class="token number">9</span> modules
<span class="token operator">&#x3C;</span>i<span class="token operator">></span> cacheable modules <span class="token number">530</span> KiB
<span class="token operator">&#x3C;</span>i<span class="token operator">></span>   ./src/index.js <span class="token number">406</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
<span class="token operator">&#x3C;</span>i<span class="token operator">></span>   ./src/print.js <span class="token number">83</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
<span class="token operator">&#x3C;</span>i<span class="token operator">></span>   ./node_modules/lodash/lodash.js <span class="token number">530</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
<span class="token operator">&#x3C;</span>i<span class="token operator">></span> webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">709</span> ms
<span class="token operator">&#x3C;</span>i<span class="token operator">></span> <span class="token punctuation">[</span>webpack-dev-middleware<span class="token punctuation">]</span> Compiled successfully.
<span class="token operator">&#x3C;</span>i<span class="token operator">></span> <span class="token punctuation">[</span>webpack-dev-middleware<span class="token punctuation">]</span> Compiling<span class="token punctuation">..</span>.
<span class="token operator">&#x3C;</span>i<span class="token operator">></span> <span class="token punctuation">[</span>webpack-dev-middleware<span class="token punctuation">]</span> assets by status <span class="token number">1.38</span> MiB <span class="token punctuation">[</span>cached<span class="token punctuation">]</span> <span class="token number">2</span> assets
<span class="token operator">&#x3C;</span>i<span class="token operator">></span> cached modules <span class="token number">530</span> KiB <span class="token punctuation">(</span>javascript<span class="token punctuation">)</span> <span class="token number">1.9</span> KiB <span class="token punctuation">(</span>runtime<span class="token punctuation">)</span> <span class="token punctuation">[</span>cached<span class="token punctuation">]</span> <span class="token number">12</span> modules
<span class="token operator">&#x3C;</span>i<span class="token operator">></span> webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">19</span> ms
<span class="token operator">&#x3C;</span>i<span class="token operator">></span> <span class="token punctuation">[</span>webpack-dev-middleware<span class="token punctuation">]</span> Compiled successfully.</code></pre> <p>이제 브라우저를 실행하고 <code>http://localhost:3000</code>로 이동합니다. webpack 앱이 실행하고 작동하는 것을 확인할 수 있습니다!</p> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>Hot Module Replacement 방식에 대해 자세히 알고 싶다면, <a href="/guides/hot-module-replacement/">Hot Module Replacement</a> 가이드를 읽어보세요.</p></aside> <h2 id="adjusting-your-text-editor">Adjusting Your Text Editor<a href="#adjusting-your-text-editor" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>코드 자동 컴파일을 사용하면, 파일을 저장할 때 문제가 발생할 수 있습니다. 일부 편집기에는 잠재적으로 재컴파일을 방해할 수 있는 "안전한 쓰기" 기능이 있습니다.</p> <p>일부 일반 편집기에서 이 기능을 비활성화하려면, 아래 목록을 참고하십시오.</p> <ul> <li><strong>Sublime Text 3</strong>: 사용자 환경 설정에 <code>atomic_save: 'false'</code>를 추가하십시오.</li> <li><strong>JetBrains IDEs (e.g. WebStorm)</strong>: <code>Preferences > Appearance &#x26; Behavior > System Settings</code>에서 "Use safe write" 선택을 해제하십시오.</li> <li><strong>Vim</strong>: 설정에 <code>:set backupcopy=yes</code>를 추가하십시오.</li> </ul> <h2 id="conclusion-2">Conclusion<a href="#conclusion-2" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>이제 자동으로 코드를 컴파일하고 간단한 개발 서버를 실행하는 방법을 배웠으므로, <a href="/guides/code-splitting/">코드 스플리팅</a>을 다룰 다음 가이드로 넘어가 볼까요?</p> <h1 id="code-splitting">Code Splitting<a href="#code-splitting" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>이 가이드는 <a href="/guides/getting-started">Getting Started</a>에 제공된 예제를 기준으로 합니다. 해당 예제와 <a href="/guides/output-management/">Output Management</a> 챕터를 미리 알아두도록 합니다.</p></aside> <p>코드 스플리팅은 webpack의 가장 매력적인 기능 중 하나입니다. 이 기능을 사용하여 코드를 다양한 번들로 분할하고, 요청에 따라 로드하거나 병렬로 로드할 수 있습니다. 더 작은 번들을 만들고 리소스 우선순위를 올바르게 제어하기 위해서 사용하며, 잘 활용하면 로드 시간에 큰 영향을 끼칠 수 있습니다.</p> <p>일반적으로 코드 스플리팅은 세 가지 방식으로 접근할 수 있습니다.</p> <ul> <li><strong>Entry Points</strong>: <a href="/configuration/entry-context"><code>entry</code></a> 설정을 사용하여 코드를 수동으로 분할합니다.</li> <li><strong>Prevent Duplication</strong>: <a href="/configuration/entry-context/#dependencies">Entry dependencies</a> 또는 <a href="/plugins/split-chunks-plugin/"><code>SplitChunksPlugin</code></a>을 사용하여 중복 청크를 제거하고 청크를 분할합니다.</li> <li><strong>Dynamic Imports</strong>: 모듈 내에서 인라인 함수 호출을 통해 코드를 분할합니다.</li> </ul> <h2 id="entry-points">Entry Points<a href="#entry-points" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>코드를 분할하는 가장 쉽고 직관적인 방법입니다. 그러나 다른 방법에 비해 수동적이며, 같이 살펴볼 몇 가지 함정이 있습니다. 메인 번들에서 다른 모듈을 어떻게 분리하는지 알아보겠습니다.</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff">webpack-demo
|- package.json
|- webpack.config.js
|- /dist
|- /src
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- index.js
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> |- another-module.js
</span></span>|- /node_modules</code></pre> <p><strong>another-module.js</strong></p> <pre><code class="hljs language-js"><span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">'lodash'</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Another'</span><span class="token punctuation">,</span> <span class="token string">'module'</span><span class="token punctuation">,</span> <span class="token string">'loaded!'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  entry: './src/index.js',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  mode: 'development',
</span><span class="token prefix inserted">+</span><span class="token line">  entry: {
</span><span class="token prefix inserted">+</span><span class="token line">    index: './src/index.js',
</span><span class="token prefix inserted">+</span><span class="token line">    another: './src/another-module.js',
</span><span class="token prefix inserted">+</span><span class="token line">  },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    filename: 'main.js',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    filename: '[name].bundle.js',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>다음과 같은 빌드 결과가 생성됩니다.</p> <pre><code class="hljs language-bash"><span class="token punctuation">..</span>.
<span class="token punctuation">[</span>webpack-cli<span class="token punctuation">]</span> Compilation finished
asset index.bundle.js <span class="token number">553</span> KiB <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: index<span class="token punctuation">)</span>
asset another.bundle.js <span class="token number">553</span> KiB <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: another<span class="token punctuation">)</span>
runtime modules <span class="token number">2.49</span> KiB <span class="token number">12</span> modules
cacheable modules <span class="token number">530</span> KiB
  ./src/index.js <span class="token number">257</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./src/another-module.js <span class="token number">84</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./node_modules/lodash/lodash.js <span class="token number">530</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">245</span> ms</code></pre> <p>언급했듯이 이 접근 방식에는 몇 가지 함정이 있습니다.</p> <ul> <li>엔트리 청크 사이에 중복된 모듈이 있는 경우 두 번들에 모두 포함됩니다.</li> <li>코어 애플리케이션 로직을 통한 코드의 동적 분할에는 사용할 수 없으며 유연하지 않습니다.</li> </ul> <p>이 중 첫 번째 항목을 통해 지금 예제의 문제를 알 수 있습니다. 왜냐하면 <code>./src/index.js</code>에서도 <code>lodash</code>를 가져오므로 양쪽 번들에서 중복으로 포함되기 때문입니다. 다음 섹션에서 중복된 것을 제거하겠습니다.</p> <h2 id="prevent-duplication">Prevent Duplication<a href="#prevent-duplication" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <h3 id="entry-dependencies">Entry dependencies<a href="#entry-dependencies" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p><a href="/configuration/entry-context/#dependencies"><code>dependOn</code> 옵션</a>을 사용하면 청크간 모듈을 공유할 수 있습니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  mode: 'development',
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    index: './src/index.js',
</span><span class="token prefix deleted">-</span><span class="token line">    another: './src/another-module.js',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    index: {
</span><span class="token prefix inserted">+</span><span class="token line">      import: './src/index.js',
</span><span class="token prefix inserted">+</span><span class="token line">      dependOn: 'shared',
</span><span class="token prefix inserted">+</span><span class="token line">    },
</span><span class="token prefix inserted">+</span><span class="token line">    another: {
</span><span class="token prefix inserted">+</span><span class="token line">      import: './src/another-module.js',
</span><span class="token prefix inserted">+</span><span class="token line">      dependOn: 'shared',
</span><span class="token prefix inserted">+</span><span class="token line">    },
</span><span class="token prefix inserted">+</span><span class="token line">    shared: 'lodash',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: '[name].bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>단일 HTML 페이지에서 여러 엔트리 포인트를 사용하는 경우 <code>optimization.runtimeChunk: 'single'</code>도 필요합니다. 그렇지 않으면 <a href="https://bundlers.tooling.report/">여기</a>에서 설명하는 문제가 발생할 수 있습니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  mode: 'development',
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: {
</span><span class="token prefix unchanged"> </span><span class="token line">    index: {
</span><span class="token prefix unchanged"> </span><span class="token line">      import: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">      dependOn: 'shared',
</span><span class="token prefix unchanged"> </span><span class="token line">    },
</span><span class="token prefix unchanged"> </span><span class="token line">    another: {
</span><span class="token prefix unchanged"> </span><span class="token line">      import: './src/another-module.js',
</span><span class="token prefix unchanged"> </span><span class="token line">      dependOn: 'shared',
</span><span class="token prefix unchanged"> </span><span class="token line">    },
</span><span class="token prefix unchanged"> </span><span class="token line">    shared: 'lodash',
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: '[name].bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  optimization: {
</span><span class="token prefix inserted">+</span><span class="token line">    runtimeChunk: 'single',
</span><span class="token prefix inserted">+</span><span class="token line">  },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>다음은 빌드 결과입니다.</p> <pre><code class="hljs language-bash"><span class="token punctuation">..</span>.
<span class="token punctuation">[</span>webpack-cli<span class="token punctuation">]</span> Compilation finished
asset shared.bundle.js <span class="token number">549</span> KiB <span class="token punctuation">[</span>compared <span class="token keyword">for</span> emit<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: shared<span class="token punctuation">)</span>
asset runtime.bundle.js <span class="token number">7.79</span> KiB <span class="token punctuation">[</span>compared <span class="token keyword">for</span> emit<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: runtime<span class="token punctuation">)</span>
asset index.bundle.js <span class="token number">1.77</span> KiB <span class="token punctuation">[</span>compared <span class="token keyword">for</span> emit<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: index<span class="token punctuation">)</span>
asset another.bundle.js <span class="token number">1.65</span> KiB <span class="token punctuation">[</span>compared <span class="token keyword">for</span> emit<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: another<span class="token punctuation">)</span>
Entrypoint index <span class="token number">1.77</span> KiB <span class="token operator">=</span> index.bundle.js
Entrypoint another <span class="token number">1.65</span> KiB <span class="token operator">=</span> another.bundle.js
Entrypoint shared <span class="token number">557</span> KiB <span class="token operator">=</span> runtime.bundle.js <span class="token number">7.79</span> KiB shared.bundle.js <span class="token number">549</span> KiB
runtime modules <span class="token number">3.76</span> KiB <span class="token number">7</span> modules
cacheable modules <span class="token number">530</span> KiB
  ./node_modules/lodash/lodash.js <span class="token number">530</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./src/another-module.js <span class="token number">84</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./src/index.js <span class="token number">257</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">249</span> ms</code></pre> <p>보시다시피 <code>shared.bundle.js</code>, <code>index.bundle.js</code> 및 <code>another.bundle.js</code> 외에 또 다른 <code>runtime.bundle.js</code> 파일이 생성됩니다.</p> <p>webpack은 하나의 페이지에 여러 엔트리 포인트를 허용하지만, 가능하다면 <code>entry: { page: ['./analytics', './app'] }</code>처럼 여러 개의 import가 포함된 엔트리 포인트 사용을 피해야 합니다. 이는 <code>async</code> 스크립트 태그를 사용할 때 최적화에 용이하며 일관된 순서로 실행할 수 있도록 합니다.</p> <h3 id="splitchunksplugin"><code>SplitChunksPlugin</code><a href="#splitchunksplugin" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p><a href="/plugins/split-chunks-plugin/"><code>SplitChunksPlugin</code></a>을 사용하면 기존 엔트리 청크 또는 완전히 새로운 청크로 공통 의존성을 추출할 수 있습니다. 이를 활용하여 이전 예제의 <code>lodash</code> 중복을 제거해 보겠습니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const path = require('path');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">   mode: 'development',
</span><span class="token prefix unchanged"> </span><span class="token line">   entry: {
</span><span class="token prefix unchanged"> </span><span class="token line">     index: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">     another: './src/another-module.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   output: {
</span><span class="token prefix unchanged"> </span><span class="token line">     filename: '[name].bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">     path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   optimization: {
</span><span class="token prefix inserted">+</span><span class="token line">     splitChunks: {
</span><span class="token prefix inserted">+</span><span class="token line">       chunks: 'all',
</span><span class="token prefix inserted">+</span><span class="token line">     },
</span><span class="token prefix inserted">+</span><span class="token line">   },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> };</span></span></code></pre> <p><a href="/plugins/split-chunks-plugin/#optimizationsplitchunks"><code>optimization.splitChunks</code></a> 설정 옵션을 적용하면 <code>index.bundle.js</code>와 <code>another.bundle.js</code>에서 중복 의존성이 제거된 것을 확인 할 수 있습니다. 플러그인은 <code>lodash</code>가 별도의 청크로 분리되었고 메인 번들에서도 제거된 것을 알 수 있습니다. 잘 동작하는지 확인하기 위해 <code>npm run build</code>를 실행해 보겠습니다.</p> <pre><code class="hljs language-bash"><span class="token punctuation">..</span>.
<span class="token punctuation">[</span>webpack-cli<span class="token punctuation">]</span> Compilation finished
asset vendors-node_modules_lodash_lodash_js.bundle.js <span class="token number">549</span> KiB <span class="token punctuation">[</span>compared <span class="token keyword">for</span> emit<span class="token punctuation">]</span> <span class="token punctuation">(</span>id hint: vendors<span class="token punctuation">)</span>
asset index.bundle.js <span class="token number">8.92</span> KiB <span class="token punctuation">[</span>compared <span class="token keyword">for</span> emit<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: index<span class="token punctuation">)</span>
asset another.bundle.js <span class="token number">8.8</span> KiB <span class="token punctuation">[</span>compared <span class="token keyword">for</span> emit<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: another<span class="token punctuation">)</span>
Entrypoint index <span class="token number">558</span> KiB <span class="token operator">=</span> vendors-node_modules_lodash_lodash_js.bundle.js <span class="token number">549</span> KiB index.bundle.js <span class="token number">8.92</span> KiB
Entrypoint another <span class="token number">558</span> KiB <span class="token operator">=</span> vendors-node_modules_lodash_lodash_js.bundle.js <span class="token number">549</span> KiB another.bundle.js <span class="token number">8.8</span> KiB
runtime modules <span class="token number">7.64</span> KiB <span class="token number">14</span> modules
cacheable modules <span class="token number">530</span> KiB
  ./src/index.js <span class="token number">257</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./src/another-module.js <span class="token number">84</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./node_modules/lodash/lodash.js <span class="token number">530</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">241</span> ms</code></pre> <p>다음은 코드 스플리팅을 위해 커뮤니티에서 제공하는 다른 유용한 플러그인과 로더입니다.</p> <p>-<a href="/plugins/mini-css-extract-plugin"><code>mini-css-extract-plugin</code></a> : 메인 애플리케이션에서 CSS를 분리하는데 유용합니다.</p> <h2 id="dynamic-imports">Dynamic Imports<a href="#dynamic-imports" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>webpack은 동적 코드 스플리팅에 두 가지 유사한 기술을 지원합니다. 첫 번째이자 권장하는 접근 방식은 <a href="https://github.com/tc39/proposal-dynamic-import">ECMAScript 제안을</a> 준수하는 <a href="/api/module-methods/#import-1"><code>import()</code>구문</a>을 사용하는 방식입니다. 기존의 webpack 전용 방식은 <a href="/api/module-methods/#requireensure"><code>require.ensure</code></a>를 사용하는 것입니다. 이 두 가지 중 첫 번째를 사용해 보겠습니다.</p> <aside class="warning"><h6 class="warning__prefix">warning</h6><p><code>import()</code> 호출은 내부적으로 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">promises</a>를 사용합니다. 이전 브라우저(예: IE 11)에서 <code>import()</code>를 사용하는 경우 <a href="https://github.com/stefanpenner/es6-promise">es6-promise</a>나 <a href="https://github.com/taylorhakes/promise-polyfill">promise-polyfill</a>과 같은 폴리필을 사용하여 <code>Promise</code>를 지원하도록 해야 합니다.</p></aside> <p>시작하기 전에 위 예제의 설정에서 추가 <a href="/concepts/entry-points/"><code>entry</code></a> 및 <a href="/plugins/split-chunks-plugin"><code>optimization.splitChunks</code></a>를 제거하겠습니다. 다음 데모에는 필요하지 않습니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  mode: 'development',
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: {
</span><span class="token prefix unchanged"> </span><span class="token line">    index: './src/index.js',
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    another: './src/another-module.js',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: '[name].bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  optimization: {
</span><span class="token prefix deleted">-</span><span class="token line">    splitChunks: {
</span><span class="token prefix deleted">-</span><span class="token line">      chunks: 'all',
</span><span class="token prefix deleted">-</span><span class="token line">    },
</span><span class="token prefix deleted">-</span><span class="token line">  },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>또한 현재 사용하지 않는 파일을 프로젝트에서 제거하겠습니다.</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff">webpack-demo
|- package.json
|- webpack.config.js
|- /dist
|- /src
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- index.js
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> |- another-module.js
</span></span>|- /node_modules</code></pre> <p>이제 정적으로 가져오던 <code>lodash</code>를 동적으로 가져와서 청크를 분리해보겠습니다.</p> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">import _ from 'lodash';
</span><span class="token prefix deleted">-</span><span class="token line">
</span><span class="token prefix deleted">-</span><span class="token line">function component() {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">function getComponent() {
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  const element = document.createElement('div');
</span></span>
<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  // Lodash, now imported by this script
</span><span class="token prefix deleted">-</span><span class="token line">  element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  return import('lodash')
</span><span class="token prefix inserted">+</span><span class="token line">    .then(({ default: _ }) => {
</span><span class="token prefix inserted">+</span><span class="token line">      const element = document.createElement('div');
</span><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line">      element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span>
<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  return element;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      return element;
</span><span class="token prefix inserted">+</span><span class="token line">    })
</span><span class="token prefix inserted">+</span><span class="token line">    .catch((error) => 'An error occurred while loading the component');
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">}
</span></span>
<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">document.body.appendChild(component());
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">getComponent().then((component) => {
</span><span class="token prefix inserted">+</span><span class="token line">  document.body.appendChild(component);
</span><span class="token prefix inserted">+</span><span class="token line">});</span></span></code></pre> <p><code>default</code>가 필요한 이유는 webpack 4 이후로 CommonJS 모듈을 가져올 때 더 이상 <code>module.exports</code> 값 으로 해석되지 않으며 대신 CommonJS 모듈에 대한 인공 네임 스페이스 객체를 생성하기 때문입니다. 그 이유에 대한 자세한 내용은 <a href="https://medium.com/webpack/webpack-4-import-and-commonjs-d619d626b655">webpack 4: import() 및 CommonJs</a>를 참고하세요.</p> <p>webpack을 실행하여 <code>lodash</code>가 별도의 번들로 분리되어 있는지 살펴보겠습니다.</p> <pre><code class="hljs language-bash"><span class="token punctuation">..</span>.
<span class="token punctuation">[</span>webpack-cli<span class="token punctuation">]</span> Compilation finished
asset vendors-node_modules_lodash_lodash_js.bundle.js <span class="token number">549</span> KiB <span class="token punctuation">[</span>compared <span class="token keyword">for</span> emit<span class="token punctuation">]</span> <span class="token punctuation">(</span>id hint: vendors<span class="token punctuation">)</span>
asset index.bundle.js <span class="token number">13.5</span> KiB <span class="token punctuation">[</span>compared <span class="token keyword">for</span> emit<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: index<span class="token punctuation">)</span>
runtime modules <span class="token number">7.37</span> KiB <span class="token number">11</span> modules
cacheable modules <span class="token number">530</span> KiB
  ./src/index.js <span class="token number">434</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./node_modules/lodash/lodash.js <span class="token number">530</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">268</span> ms</code></pre> <p><code>import()</code>는 promise를 반환하므로 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function"><code>async</code> 함수</a>와 함께 사용할 수 있습니다. 코드를 단순화하는 방법은 다음과 같습니다.</p> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">function getComponent() {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">async function getComponent() {
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  const element = document.createElement('div');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  const { default: _ } = await import('lodash');
</span></span>
<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  return import('lodash')
</span><span class="token prefix deleted">-</span><span class="token line">    .then(({ default: _ }) => {
</span><span class="token prefix deleted">-</span><span class="token line">      const element = document.createElement('div');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span>
<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">      element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span><span class="token prefix deleted">-</span><span class="token line">
</span><span class="token prefix deleted">-</span><span class="token line">      return element;
</span><span class="token prefix deleted">-</span><span class="token line">    })
</span><span class="token prefix deleted">-</span><span class="token line">    .catch((error) => 'An error occurred while loading the component');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  return element;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">}
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">getComponent().then((component) => {
</span><span class="token prefix unchanged"> </span><span class="token line">  document.body.appendChild(component);
</span><span class="token prefix unchanged"> </span><span class="token line">});</span></span></code></pre> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>나중에 계산된 변수를 기반으로 특정 모듈을 가져와야 할 경우 <code>import()</code>에 <a href="/api/module-methods/#dynamic-expressions-in-import">dynamic expression</a>을 사용 할 수 있습니다.</p></aside> <h2 id="prefetchingpreloading-modules">Prefetching/Preloading modules<a href="#prefetchingpreloading-modules" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>webpack 4.6.0+에서 프리페치 및 프리로드에 대한 지원이 추가되었습니다.</p> <p>모듈을 가져올 때 인라인 지시문을 사용하면 webpack이 브라우저에 아래와 같은 "리소스 힌트"를 줄 수 있습니다.</p> <ul> <li><strong>prefetch</strong> : 향후 일부 탐색에 리소스가 필요할 수 있습니다.</li> <li><strong>preload</strong> : 현재 탐색 중에 리소스도 필요합니다.</li> </ul> <p>간단한 프리페치의 예제를 들어보겠습니다. <code>HomePage</code> 컴포넌트에서 <code>LoginButton</code> 컴포넌트를 렌더링하고, 이 컴포넌트를 클릭하면 <code>LoginModal</code> 컴포넌트를 요청하여 로드하는 경우입니다.</p> <p><strong>LoginButton.js</strong></p> <pre><code class="hljs language-js"><span class="token comment">//...</span>
<span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackPrefetch: true */</span> <span class="token string">'./path/to/LoginModal.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p>이는 페이지 head에 <code>&#x3C;link rel="prefetch" href="login-modal-chunk.js"></code>를 추가하고 브라우저에 <code>login-modal-chunk.js</code>를 유휴 시간에 미리 가져오도록 지시합니다.</p> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>webpack은 부모 청크가 로드된 후 프리페치 힌트를 추가합니다.</p></aside> <p>프리로드 지시문은 프리페치와 비교했을 때 여러 가지 차이점이 있습니다.</p> <ul> <li>프리로드 청크는 부모 청크와 병렬로 로드를 시작합니다. 프리페치 청크는 부모 청크가 로드 완료된 후에 로드를 시작합니다.</li> <li>프리로드 청크는 중간 우선순위를 가지며 즉시 다운로드됩니다. 프리페치 청크는 브라우저가 유휴 상태일 때 다운로드 됩니다.</li> <li>프리로드 청크는 부모 청크에서 즉시 요청 되어야 합니다. 프리페치 청크는 나중에 언제라도 사용할 수 있습니다.</li> <li>지원하는 브라우저에 차이가 있습니다.</li> </ul> <p>간단한 프리로드의 예로는, 별도의 청크에 있어야 하는 큰 라이브러리에 항상 의존하는 <code>Component</code>를 생각해 볼 수 있습니다.</p> <p>거대한 <code>ChartingLibrary</code>가 필요한 <code>ChartComponent</code>를 상상해 봅시다. 렌더링 될 때 <code>LoadingIndicator</code>를 표시하고 즉시 <code>ChartingLibrary</code>를 요청하여 불러옵니다.</p> <p><strong>ChartComponent.js</strong></p> <pre><code class="hljs language-js"><span class="token comment">//...</span>
<span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackPreload: true */</span> <span class="token string">'ChartingLibrary'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p><code>ChartComponent</code>를 사용하는 페이지를 요청할 때 <code>&#x3C;link rel="preload"></code>를 통해 charting-library-chunk도 요청됩니다. page-chunk가 더 작고 더 빨리 완료된다고 가정하면 이미 요청된 <code>charting-library-chunk</code>가 완료될 때까지 페이지에는 <code>LoadingIndicator</code>가 표시됩니다. 두 번이 아닌 한 번의 라운드 트립이 필요하므로 대기 시간이 긴 환경에서 로드 시간이 증가할 수 있습니다.</p> <aside class="tip"><h6 class="tip__prefix">tip</h6><p><code>webpackPreload</code>를 잘못 사용하면 실제로 성능이 저하 될 수 있으므로 사용 시 주의하세요.</p></aside> <h2 id="bundle-analysis">Bundle Analysis<a href="#bundle-analysis" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>코드 스플리팅을 시작하면 출력을 분석하여 어디서 모듈이 종료되었는지 확인하는 데 유용합니다. <a href="https://github.com/webpack/analyse">공식 분석 도구</a>부터 시작하는 것이 좋습니다. 커뮤니티에서 지원하는 다른 옵션도 있습니다.</p> <ul> <li><a href="https://alexkuz.github.io/webpack-chart/">webpack-chart</a>: webpack 통계를 위한 인터렉티브 원형 차트.</li> <li><a href="https://chrisbateman.github.io/webpack-visualizer/">webpack-visualizer</a>: 번들을 시각화하고 분석하여 어떤 모듈이 공간을 차지하고 있고 어떤 모듈이 중복될 수 있는지 확인합니다.</li> <li><a href="https://github.com/webpack-contrib/webpack-bundle-analyzer">webpack-bundle-analyzer</a>: 확대/축소 가능한 편리한 인터렉티브 트리 맵으로 번들 콘텐츠를 표현하는 플러그인 및 CLI 유틸리티입니다.</li> <li><a href="https://webpack.jakoblind.no/optimize">webpack bundle optimize helper</a>: 이 도구는 번들을 분석하고 번들 크기를 줄이기 위한 실용적인 개선 사항을 제공합니다.</li> <li><a href="https://github.com/bundle-stats/bundle-stats">bundle-stats</a>: 번들 보고서(번들 크기, 애셋, 모듈)를 생성하고 서로 다른 빌드 간의 결과를 비교합니다.</li> </ul> <h2 id="next-steps">Next Steps<a href="#next-steps" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>실제 애플리케이션에서 어떻게 <code>import()</code>를 사용하는지 더 구체적으로 알고 싶다면 <a href="/guides/lazy-loading/">Lazy Loading</a>의 예제를 확인하세요. 더 효율적인 코드 스플리팅 방법은 <a href="/guides/caching/">Caching</a>을 참고하세요.</p> <h1 id="caching">Caching<a href="#caching" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <aside class="tip"><h6 class="tip__prefix">tip</h6><p><a href="/guides/getting-started">시작하기</a>, <a href="/guides/output-management">출력 관리</a>, <a href="/guides/code-splitting">코드 스플릿팅</a>의 예시를 사용합니다.</p></aside> <p>우리는 배포 가능한 <code>/dist</code>디렉토리를 생성하는 모듈형 애플리케이션을 번들링하기 위해 webpack을 사용하고 있습니다. 일단 서버에 <code>/dist</code>의 콘텐츠가 배포되면 클라이언트(일반적으로 브라우저)가 해당 서버에 접근하여 사이트와 애셋을 가져옵니다. 마지막 단계는 시간이 많이 걸릴 수 있기 때문에 브라우저는 <a href="https://en.wikipedia.org/wiki/Cache_(computing)">캐싱</a>이라는 기술을 사용합니다. 이렇게 하면 불필요한 네트워크 트래픽을 줄이면서 사이트를 더 빨리 로드할 수 있습니다. 그러나 새 코드를 불러올 경우에는 어려움을 느낄 수 있습니다.</p> <p>이 가이드는 webpack 컴파일로 생성 된 파일의 내용이 변경되지 않는 한 캐시된 상태로 유지되도록 하는 데 필요한 설정에 초점을 맞춥니다.</p> <h2 id="output-filenames">Output Filenames<a href="#output-filenames" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>output.filename</code> <a href="/configuration/output/#outputfilename">substitutions</a> 설정을 사용하여 출력 파일의 이름을 정의할 수 있습니다. webpack은 <strong>substitutions</strong> 이라고 하는 대괄호 문자열을 사용하여 파일 이름을 템플릿화하는 방법을 제공합니다. <code>[contenthash]</code> substitution은 애셋의 콘텐츠에 따라 고유한 해시를 추가합니다. 애셋의 콘텐츠가 변경되면 <code>[contenthash]</code>도 변경됩니다.</p> <p><code>index.html</code> 파일을 수동으로 관리할 필요가 없도록 <a href="/guides/output-management">출력 관리의</a> <code>플러그인</code>과 <a href="/guides/getting-started">시작하기의</a> 예제를 사용하여 프로젝트를 설정해 보겠습니다.</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff">webpack-demo
|- package.json
|- webpack.config.js
|- /dist
|- /src
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- index.js
</span></span>|- /node_modules</code></pre> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line"> const HtmlWebpackPlugin = require('html-webpack-plugin');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">   entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">     new HtmlWebpackPlugin({
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">       title: 'Output Management',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">       title: 'Caching',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     }),
</span><span class="token prefix unchanged"> </span><span class="token line">   ],
</span><span class="token prefix unchanged"> </span><span class="token line">   output: {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">     filename: 'bundle.js',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     filename: '[name].[contenthash].js',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">     clean: true,
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line"> };</span></span></code></pre> <p>이 설정으로 빌드 스크립트 <code>npm run build</code>를 실행하면, 다음과 같은 출력이 생성됩니다.</p> <pre><code class="hljs language-bash"><span class="token punctuation">..</span>.
                       Asset       Size  Chunks                    Chunk Names
main.7e2c49a622975ebd9b7e.js     <span class="token number">544</span> kB       <span class="token number">0</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  <span class="token punctuation">[</span>big<span class="token punctuation">]</span>  main
                  index.html  <span class="token number">197</span> bytes          <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>
<span class="token punctuation">..</span>.</code></pre> <p>보다시피, 번들의 이름은 해시를 통해 콘텐츠를 반영합니다. 변경하지 않고 다른 빌드를 실행하면 해당 파일 이름이 동일하게 유지될 거라고 생각합니다. 그러나 다시 실행하면 이 경우에는 그렇지 않을 수 있다는 것을 알 수 있습니다.</p> <pre><code class="hljs language-bash"><span class="token punctuation">..</span>.
                       Asset       Size  Chunks                    Chunk Names
main.205199ab45963f6a62ec.js     <span class="token number">544</span> kB       <span class="token number">0</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  <span class="token punctuation">[</span>big<span class="token punctuation">]</span>  main
                  index.html  <span class="token number">197</span> bytes          <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>
<span class="token punctuation">..</span>.</code></pre> <p>이것은 webpack이 특정 보일러플레이트, 특히 런타임과 매니페스트를 엔트리 청크에 포함하기 때문입니다.</p> <aside class="warning"><h6 class="warning__prefix">warning</h6><p>현재 webpack 버전에 따라 출력이 다를 수 있습니다. 최신 버전에는 일부 이전 버전과 동일한 해싱 문제가 없을 수 있지만, 안전을 위해 다음 단계를 권장합니다.</p></aside> <h2 id="extracting-boilerplate">Extracting Boilerplate<a href="#extracting-boilerplate" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><a href="/guides/code-splitting">코드 스플릿팅</a>에서 배운 것처럼 <a href="/plugins/split-chunks-plugin/"><code>SplitChunksPlugin</code></a>을 사용하여 모듈을 별도의 번들로 분할 할 수 있습니다. webpack은 <a href="/configuration/optimization/#optimizationruntimechunk"><code>optimization.runtimeChunk</code></a> 옵션을 사용하여 런타임 코드를 별도의 청크로 분할하는 최적화 기능을 제공합니다. 모든 청크에 대해 단일 런타임 번들을 생성하려면 <code>single</code>로 설정합니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line"> const HtmlWebpackPlugin = require('html-webpack-plugin');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">   entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">     new HtmlWebpackPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">       title: 'Caching',
</span><span class="token prefix unchanged"> </span><span class="token line">     }),
</span><span class="token prefix unchanged"> </span><span class="token line">   ],
</span><span class="token prefix unchanged"> </span><span class="token line">   output: {
</span><span class="token prefix unchanged"> </span><span class="token line">     filename: '[name].[contenthash].js',
</span><span class="token prefix unchanged"> </span><span class="token line">     path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">     clean: true,
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   optimization: {
</span><span class="token prefix inserted">+</span><span class="token line">     runtimeChunk: 'single',
</span><span class="token prefix inserted">+</span><span class="token line">   },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> };</span></span></code></pre> <p>추출한 <code>런타임</code> 번들을 보기위해 다른 빌드를 실행해 보겠습니다.</p> <pre><code class="hljs language-bash">Hash: 82c9c385607b2150fab2
Version: webpack <span class="token number">4.12</span>.0
Time: 3027ms
                          Asset       Size  Chunks             Chunk Names
runtime.cc17ae2a94ec771e9221.js   <span class="token number">1.42</span> KiB       <span class="token number">0</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  runtime
   main.e81de2cf758ada72f306.js   <span class="token number">69.5</span> KiB       <span class="token number">1</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  main
                     index.html  <span class="token number">275</span> bytes          <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">(</span>webpack<span class="token punctuation">)</span>/buildin/module.js <span class="token number">497</span> bytes <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token punctuation">(</span>webpack<span class="token punctuation">)</span>/buildin/global.js <span class="token number">489</span> bytes <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> ./src/index.js <span class="token number">309</span> bytes <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span>
    + <span class="token number">1</span> hidden module</code></pre> <p><code>lodash</code> 또는 <code>react</code>와 같은 타사 라이브러리는 로컬 소스 코드보다 변경 될 가능성이 적기 때문에 별도의 <code>vendor</code> 청크로 추출하는 것도 좋은 방법입니다. 이 단계를 통해 클라이언트는 최신 상태를 유지하기 위해 서버에 더 적은 요청을 할 수 있습니다. 이는 <a href="/plugins/split-chunks-plugin/#split-chunks-example-2">Example 2 of SplitChunksPlugin</a>에 표시된 <a href="/plugins/split-chunks-plugin/"><code>SplitChunksPlugin</code></a>의 <a href="/plugins/split-chunks-plugin/#splitchunkscachegroups"><code>cacheGroups</code></a> 옵션을 사용하여 수행할 수 있습니다. <code>cacheGroups</code>과 함께 <code>optimization.splitChunks</code>를 추가하고 다음 파라미터를 사용하여 빌드합니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line"> const HtmlWebpackPlugin = require('html-webpack-plugin');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">   entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">     new HtmlWebpackPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">       title: 'Caching',
</span><span class="token prefix unchanged"> </span><span class="token line">     }),
</span><span class="token prefix unchanged"> </span><span class="token line">   ],
</span><span class="token prefix unchanged"> </span><span class="token line">   output: {
</span><span class="token prefix unchanged"> </span><span class="token line">     filename: '[name].[contenthash].js',
</span><span class="token prefix unchanged"> </span><span class="token line">     path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">     clean: true,
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   optimization: {
</span><span class="token prefix unchanged"> </span><span class="token line">     runtimeChunk: 'single',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     splitChunks: {
</span><span class="token prefix inserted">+</span><span class="token line">       cacheGroups: {
</span><span class="token prefix inserted">+</span><span class="token line">         vendor: {
</span><span class="token prefix inserted">+</span><span class="token line">           test: /[\\/]node_modules[\\/]/,
</span><span class="token prefix inserted">+</span><span class="token line">           name: 'vendors',
</span><span class="token prefix inserted">+</span><span class="token line">           chunks: 'all',
</span><span class="token prefix inserted">+</span><span class="token line">         },
</span><span class="token prefix inserted">+</span><span class="token line">       },
</span><span class="token prefix inserted">+</span><span class="token line">     },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line"> };</span></span></code></pre> <p>새로운 <code>vendor</code>번들을 확인하기 위해 다른 빌드를 실행해 보겠습니다.</p> <pre><code class="hljs language-bash"><span class="token punctuation">..</span>.
                          Asset       Size  Chunks             Chunk Names
runtime.cc17ae2a94ec771e9221.js   <span class="token number">1.42</span> KiB       <span class="token number">0</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  runtime
vendors.a42c3ca0d742766d7a28.js   <span class="token number">69.4</span> KiB       <span class="token number">1</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  vendors
   main.abf44fedb7d11d4312d7.js  <span class="token number">240</span> bytes       <span class="token number">2</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  main
                     index.html  <span class="token number">353</span> bytes          <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>
<span class="token punctuation">..</span>.</code></pre> <p>이제 <code>main</code> 번들에 <code>node_modules</code> 디렉토리의 <code>vendor</code> 코드가 포함되어 있지 않고 크기가 <code>240 bytes</code>로 줄어든 것을 볼 수 있습니다!</p> <h2 id="module-identifiers">Module Identifiers<a href="#module-identifiers" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>프로젝트에 다른 모듈<code>print.js</code>를 추가해 보겠습니다.</p> <p><strong>프로젝트</strong></p> <pre><code class="hljs language-diff">webpack-demo
|- package.json
|- webpack.config.js
|- /dist
|- /src
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- index.js
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> |- print.js
</span></span>|- /node_modules</code></pre> <p><strong>print.js</strong></p> <pre><code class="hljs language-diff"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> export default function print(text) {
</span><span class="token prefix inserted">+</span><span class="token line">   console.log(text);
</span><span class="token prefix inserted">+</span><span class="token line"> };</span></span></code></pre> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> import _ from 'lodash';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> import Print from './print';
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">   const element = document.createElement('div');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   // Lodash, now imported by this script
</span><span class="token prefix unchanged"> </span><span class="token line">   element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   element.onclick = Print.bind(null, 'Hello webpack!');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   return element;
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> document.body.appendChild(component());</span></span></code></pre> <p>다른 빌드를 실행하면 <code>main</code> 번들의 해시만 변경 될 것으로 예상합니다, 하지만...</p> <pre><code class="hljs language-bash"><span class="token punctuation">..</span>.
                           Asset       Size  Chunks                    Chunk Names
  runtime.1400d5af64fc1b7b3a45.js    <span class="token number">5.85</span> kB      <span class="token number">0</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>         runtime
  vendor.a7561fb0e9a071baadb9.js     <span class="token number">541</span> kB       <span class="token number">1</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  <span class="token punctuation">[</span>big<span class="token punctuation">]</span>  vendor
    main.b746e3eb72875af2caa9.js    <span class="token number">1.22</span> kB       <span class="token number">2</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>         main
                      index.html  <span class="token number">352</span> bytes          <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>
<span class="token punctuation">..</span>.</code></pre> <p>... 세가지 모두가 변경 된 것을 볼 수 있습니다. 이는 각 <a href="/api/module-variables/#moduleid-commonjs"><code>module.id</code></a>가 기본적으로 해석 순서에 따라 증가하기 때문입니다. 해석 순서가 변경되면 ID도 변경됩니다. 그래서 요약하자면:</p> <ul> <li>새로운 콘텐츠로 인해 <code>main</code> 번들이 변경되었습니다.</li> <li><code>module.id</code>가 바뀌어 <code>vendor</code> 번들이 변경되었습니다.</li> <li>그리고, <code>runtime</code> 번들은 이제 새로운 모듈에 대한 참조를 포함하기 때문에 변경되었습니다.</li> </ul> <p>첫번째와 마지막은 우리가 고치고 싶은 <code>vendor</code> 해시입니다. <code>'deterministic'</code>옵션과 함께 <a href="/configuration/optimization/#optimizationmoduleids"><code>optimization.moduleIds</code></a>를 사용하겠습니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line"> const HtmlWebpackPlugin = require('html-webpack-plugin');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">   entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">     new HtmlWebpackPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">       title: 'Caching',
</span><span class="token prefix unchanged"> </span><span class="token line">     }),
</span><span class="token prefix unchanged"> </span><span class="token line">   ],
</span><span class="token prefix unchanged"> </span><span class="token line">   output: {
</span><span class="token prefix unchanged"> </span><span class="token line">     filename: '[name].[contenthash].js',
</span><span class="token prefix unchanged"> </span><span class="token line">     path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">     clean: true,
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   optimization: {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     moduleIds: 'deterministic',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     runtimeChunk: 'single',
</span><span class="token prefix unchanged"> </span><span class="token line">     splitChunks: {
</span><span class="token prefix unchanged"> </span><span class="token line">       cacheGroups: {
</span><span class="token prefix unchanged"> </span><span class="token line">         vendor: {
</span><span class="token prefix unchanged"> </span><span class="token line">           test: /[\\/]node_modules[\\/]/,
</span><span class="token prefix unchanged"> </span><span class="token line">           name: 'vendors',
</span><span class="token prefix unchanged"> </span><span class="token line">           chunks: 'all',
</span><span class="token prefix unchanged"> </span><span class="token line">         },
</span><span class="token prefix unchanged"> </span><span class="token line">       },
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line"> };</span></span></code></pre> <p>이제 새로운 로컬 의존성에도 불구하고 <code>vendor</code>해시는 빌드간에 일관성을 유지해야합니다.</p> <pre><code class="hljs language-bash"><span class="token punctuation">..</span>.
                          Asset       Size  Chunks             Chunk Names
   main.216e852f60c8829c2289.js  <span class="token number">340</span> bytes       <span class="token number">0</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  main
vendors.55e79e5927a639d21a1b.js   <span class="token number">69.5</span> KiB       <span class="token number">1</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  vendors
runtime.725a1a51ede5ae0cfde0.js   <span class="token number">1.42</span> KiB       <span class="token number">2</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  runtime
                     index.html  <span class="token number">353</span> bytes          <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>
Entrypoint main <span class="token operator">=</span> runtime.725a1a51ede5ae0cfde0.js vendors.55e79e5927a639d21a1b.js main.216e852f60c8829c2289.js
<span class="token punctuation">..</span>.</code></pre> <p>그리고 <code>src/index.js</code>를 수정하여 추가 의존성을 일시적으로 제거해 보겠습니다.</p> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> import _ from 'lodash';
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> import Print from './print';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> // import Print from './print';
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">   const element = document.createElement('div');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   // Lodash, now imported by this script
</span><span class="token prefix unchanged"> </span><span class="token line">   element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">   element.onclick = Print.bind(null, 'Hello webpack!');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   // element.onclick = Print.bind(null, 'Hello webpack!');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   return element;
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> document.body.appendChild(component());</span></span></code></pre> <p>마지막으로 빌드를 다시 실행합니다.</p> <pre><code class="hljs language-bash"><span class="token punctuation">..</span>.
                          Asset       Size  Chunks             Chunk Names
   main.ad717f2466ce655fff5c.js  <span class="token number">274</span> bytes       <span class="token number">0</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  main
vendors.55e79e5927a639d21a1b.js   <span class="token number">69.5</span> KiB       <span class="token number">1</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  vendors
runtime.725a1a51ede5ae0cfde0.js   <span class="token number">1.42</span> KiB       <span class="token number">2</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  runtime
                     index.html  <span class="token number">353</span> bytes          <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>
Entrypoint main <span class="token operator">=</span> runtime.725a1a51ede5ae0cfde0.js vendors.55e79e5927a639d21a1b.js main.ad717f2466ce655fff5c.js
<span class="token punctuation">..</span>.</code></pre> <p>두 빌드 모두 <code>55e79e5927a639d21a1b</code>를 vendor 번들 파일 이름으로 표시한 것을 알 수 있습니다.</p> <h2 id="conclusion-3">Conclusion<a href="#conclusion-3" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>캐싱은 복잡할 수 있지만, 애플리케이션이나 사이트 사용자에게 주는 이점으로 그만한 가치가 있습니다. 자세한 내용은 아래의 <em>추가 자료</em> 섹션을 참고하세요.</p> <h1 id="authoring-libraries">Authoring Libraries<a href="#authoring-libraries" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p>애플리케이션 외에도 JavaScript 라이브러리를 번들링 할 때도 webpack을 사용할 수 있습니다. 아래의 가이드는 번들링 전략을 간소화하려는 라이브러리 작성자를 위한 것입니다.</p> <h2 id="authoring-a-library">Authoring a Library<a href="#authoring-a-library" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>사용자가 1부터 5까지의 숫자를 숫자 표현에서 텍스트로 또는 그 반대로 변환할 수 있는 작은 라이브러리 <code>webpack-numbers</code>를 작성한다고 가정해 보겠습니다. 예. 2 에서 'two'.</p> <p>프로젝트의 기본 구조는 다음과 같을 것입니다.</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  |- webpack.config.js
</span><span class="token prefix inserted">+</span><span class="token line">  |- package.json
</span><span class="token prefix inserted">+</span><span class="token line">  |- /src
</span><span class="token prefix inserted">+</span><span class="token line">    |- index.js
</span><span class="token prefix inserted">+</span><span class="token line">    |- ref.json</span></span></code></pre> <p>npm을 초기화하고 <code>webpack</code>, <code>webpack-cli</code>, <code>lodash</code>를 설치합니다.</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> init -y
<span class="token function">npm</span> <span class="token function">install</span> --save-dev webpack webpack-cli lodash</code></pre> <p>라이브러리에 번들 되는 것을 막고 라이브러리가 비대해지는 것을 방지하기 위해 <code>lodash</code>를 <code>dependencies</code> 대신 <code>devDependencies</code>로 설치합니다.</p> <p><strong>src/ref.json</strong></p> <pre><code class="hljs language-json"><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token property">"num"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"word"</span><span class="token operator">:</span> <span class="token string">"One"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"num"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">"word"</span><span class="token operator">:</span> <span class="token string">"Two"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"num"</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token property">"word"</span><span class="token operator">:</span> <span class="token string">"Three"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"num"</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token property">"word"</span><span class="token operator">:</span> <span class="token string">"Four"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"num"</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
    <span class="token property">"word"</span><span class="token operator">:</span> <span class="token string">"Five"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"num"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"word"</span><span class="token operator">:</span> <span class="token string">"Zero"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span></code></pre> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-js"><span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">'lodash'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> numRef <span class="token keyword">from</span> <span class="token string">'./ref.json'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">numToWord</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> _<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span>
    numRef<span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token parameter">accum<span class="token punctuation">,</span> ref</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> ref<span class="token punctuation">.</span>num <span class="token operator">===</span> num <span class="token operator">?</span> ref<span class="token punctuation">.</span>word <span class="token operator">:</span> accum<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">''</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">wordToNum</span><span class="token punctuation">(</span><span class="token parameter">word</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> _<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span>
    numRef<span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token parameter">accum<span class="token punctuation">,</span> ref</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> ref<span class="token punctuation">.</span>word <span class="token operator">===</span> word <span class="token operator">&#x26;&#x26;</span> word<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> ref<span class="token punctuation">.</span>num <span class="token operator">:</span> accum<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token number">1</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> <h2 id="webpack-configuration">Webpack Configuration<a href="#webpack-configuration" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>아래의 기본적인 webpack 설정으로 시작해봅시다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">'webpack-numbers.js'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p>webpack으로 애플리케이션을 번들해보았다면 익숙할 것입니다. 기본적으로 webpack에게 <code>src/index.js</code>를 <code>dist/webpack-numbers.js</code>로 번들하도록 지시합니다.</p> <h2 id="expose-the-library">Expose the Library<a href="#expose-the-library" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>지금까지는 애플리케이션 번들링과 동일하며 다른 점은 <a href="/configuration/output/#outputlibrary"><code>output.library</code></a> 옵션을 통해 엔트리 포인트를 export 해야 합니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const path = require('path');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">   entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   output: {
</span><span class="token prefix unchanged"> </span><span class="token line">     path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">     filename: 'webpack-numbers.js',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     library: "webpackNumbers",
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line"> };</span></span></code></pre> <p>사용자가 script 태그를 통해 사용할 수 있도록 엔트리 포인트를 <code>webpackNumbers</code>로 export 했습니다.</p> <pre><code class="hljs language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://example.org/webpack-numbers.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
  window<span class="token punctuation">.</span>webpackNumbers<span class="token punctuation">.</span><span class="token function">wordToNum</span><span class="token punctuation">(</span><span class="token string">'Five'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>script</span><span class="token punctuation">></span></span></code></pre> <p>그러나, script 태그를 통해 참조될 때만 작동하며 CommonJS, AMD, Node.js 등과 같은 다른 환경에서는 사용할 수 없습니다.</p> <p>라이브러리 작성자는 다양한 환경에서 호환되기를 원합니다. 즉, 사용자가 아래 나열된 여러 방법으로 번들 된 라이브러리를 사용할 수 있어야 합니다.</p> <ul> <li> <p><strong>CommonJS module require</strong>:</p> <pre><code class="hljs language-js"><span class="token keyword">const</span> webpackNumbers <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-numbers'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>
webpackNumbers<span class="token punctuation">.</span><span class="token function">wordToNum</span><span class="token punctuation">(</span><span class="token string">'Two'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> </li> <li> <p><strong>AMD module require</strong>:</p> <pre><code class="hljs language-js"><span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'webpackNumbers'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">webpackNumbers</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  webpackNumbers<span class="token punctuation">.</span><span class="token function">wordToNum</span><span class="token punctuation">(</span><span class="token string">'Two'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> </li> <li> <p><strong>script tag</strong>:</p> <pre><code class="hljs language-html"><span class="token doctype"><span class="token punctuation">&#x3C;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>html</span><span class="token punctuation">></span></span>
  ...
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://example.org/webpack-numbers.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
    <span class="token comment">// ...</span>
    <span class="token comment">// 전역 변수</span>
    webpackNumbers<span class="token punctuation">.</span><span class="token function">wordToNum</span><span class="token punctuation">(</span><span class="token string">'Five'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// window 객체의 프로퍼티</span>
    window<span class="token punctuation">.</span>webpackNumbers<span class="token punctuation">.</span><span class="token function">wordToNum</span><span class="token punctuation">(</span><span class="token string">'Five'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ...</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>html</span><span class="token punctuation">></span></span></code></pre> </li> </ul> <p><code>type</code>을 <a href="/configuration/output/#type-amd"><code>'umd'</code></a>로 설정하여 <code>output.library</code> 옵션을 업데이트해 보겠습니다.</p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: 'webpack-numbers.js',
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    library: 'webpackNumbers',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    library: {
</span><span class="token prefix inserted">+</span><span class="token line">      name: 'webpackNumbers',
</span><span class="token prefix inserted">+</span><span class="token line">      type: 'umd',
</span><span class="token prefix inserted">+</span><span class="token line">    },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>webpack은 라이브러리를 CommonJS, AMD, script 태그에서 사용할 수 있도록 번들할 것입니다.</p> <aside class="tip"><h6 class="tip__prefix">tip</h6><p><code>library</code> 설정은 <code>entry</code> 설정과 연관되어 있습니다. 대부분의 라이브러리의 경우 단일 엔트리 포인트를 지정하는 것으로 충분합니다. <a href="https://github.com/webpack/webpack/tree/master/examples/multi-part-library">다중 진입 라이브러리</a>도 가능하지만, <a href="https://stackoverflow.com/questions/34072598/es6-exporting-importing-in-index-file">index script</a>를 통해 부분적으로 export하는 것이 더 간단합니다. 라이브러리의 <code>entry</code>를 <code>array</code>를 사용하는 것은 <strong>권장되지 않습니다.</strong></p></aside> <h2 id="externalize-lodash">Externalize Lodash<a href="#externalize-lodash" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>npx webpack</code>을 실행하면 큰 번들이 생성 된 것을 알 수 있습니다. 파일을 검사하면 lodash가 코드와 함께 번들로 제공되는 것을 볼 수 있습니다. 이 경우 <code>lodash</code>를 <em>peer dependency</em> 로 취급하는 것이 좋습니다. 사용자는 이미 <code>lodash</code>가 설치되어 있어야합니다. 따라서 이 외부 라이브러리의 제어권을 라이브러리 사용자에게 넘겨야합니다.</p> <p><a href="/configuration/externals/"><code>externals</code></a> 설정을 사용하면 됩니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const path = require('path');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">   entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   output: {
</span><span class="token prefix unchanged"> </span><span class="token line">     path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">     filename: 'webpack-numbers.js',
</span><span class="token prefix unchanged"> </span><span class="token line">     library: {
</span><span class="token prefix unchanged"> </span><span class="token line">       name: "webpackNumbers",
</span><span class="token prefix unchanged"> </span><span class="token line">       type: "umd"
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   externals: {
</span><span class="token prefix inserted">+</span><span class="token line">     lodash: {
</span><span class="token prefix inserted">+</span><span class="token line">       commonjs: 'lodash',
</span><span class="token prefix inserted">+</span><span class="token line">       commonjs2: 'lodash',
</span><span class="token prefix inserted">+</span><span class="token line">       amd: 'lodash',
</span><span class="token prefix inserted">+</span><span class="token line">       root: '_',
</span><span class="token prefix inserted">+</span><span class="token line">     },
</span><span class="token prefix inserted">+</span><span class="token line">   },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> };</span></span></code></pre> <p>이는 라이브러리가 사용자 환경에서 <code>lodash</code>라는 종속성을 사용할 수 있다고 예상한다는 것을 의미합니다.</p> <h3 id="external-limitations">External Limitations<a href="#external-limitations" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>종속성에서 여러 파일을 사용하는 라이브러리의 경우:</p> <pre><code class="hljs language-js"><span class="token keyword">import</span> <span class="token constant">A</span> <span class="token keyword">from</span> <span class="token string">'library/one'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token constant">B</span> <span class="token keyword">from</span> <span class="token string">'library/two'</span><span class="token punctuation">;</span>

<span class="token comment">// ...</span></code></pre> <p>externals에서 <code>library</code>를 지정하여 번들에서 제외할 수 없습니다. 하나씩 또는 정규식을 사용하여 제외해야 합니다.</p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
  externals<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">'library/one'</span><span class="token punctuation">,</span>
    <span class="token string">'library/two'</span><span class="token punctuation">,</span>
    <span class="token comment">// "library/"로 시작하는 모든 것</span>
    <span class="token operator">/</span><span class="token operator">^</span>library\<span class="token regex">/.+$/</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h2 id="final-steps">Final Steps<a href="#final-steps" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><a href="/guides/production">프로덕션 가이드</a>에 언급된 단계에 따라 프로덕션에 맞게 출력을 최적화하세요. 또한 생성된 번들의 경로를 <code>package.json</code>의 <code>main</code> 필드에 추가하세요.</p> <p><strong>package.json</strong></p> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  ...
  <span class="token property">"main"</span><span class="token operator">:</span> <span class="token string">"dist/webpack-numbers.js"</span><span class="token punctuation">,</span>
  ...
<span class="token punctuation">}</span></code></pre> <p>또는 <a href="https://github.com/dherman/defense-of-dot-js/blob/master/proposal.md#typical-usage">이 가이드</a>에 따라 표준 모듈로 추가하세요.</p> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  ...
  <span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"src/index.js"</span><span class="token punctuation">,</span>
  ...
<span class="token punctuation">}</span></code></pre> <p>키 <code>main</code>은 <a href="https://docs.npmjs.com/files/package.json#main"><code>package.json</code>의 표준</a>을, <code>module</code>은 JavaScript 생태계 업그레이드가 하위 호환성을 깨지 않고 ES2015 모듈을 사용할 수 있도록 하는 제안<a href="https://github.com/dherman/defense-of-dot-js/blob/master/proposal.md">[1]</a><a href="https://github.com/rollup/rollup/wiki/pkg.module">[2]</a>을 의미합니다.</p> <aside class="warning"><h6 class="warning__prefix">warning</h6><p><code>module</code> 속성은 ES2015 모듈 구문을 사용하는 스크립트를 가리켜야 하지만 아직 브라우저나 노드에서 지원하지 않는 다른 구문 기능은 없습니다. 이를 통해 webpack은 사용자가 라이브러리의 특정 부분만 소비하는 경우 모듈 구문 자체를 파싱하여 <a href="https://webpack.js.org/guides/tree-shaking/">트리 쉐이킹</a>을 통해 보다 가벼운 번들을 제공할 수 있습니다.</p></aside> <p>이제 사용자에게 배포하기 위해 <a href="https://docs.npmjs.com/getting-started/publishing-npm-packages">npm 패키지로 게시하고</a> <a href="https://unpkg.com/#/">unpkg.com</a>에서 찾을 수 있습니다.</p> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>라이브러리와 관련된 스타일 시트를 노출하려면 <a href="/plugins/mini-css-extract-plugin"><code>MiniCssExtractPlugin</code></a>을 사용해야 합니다. 사용자는 다른 스타일 시트와 마찬가지로 이를 사용하고 로드 할 수 있습니다.</p></aside> <h1 id="environment-variables">Environment Variables<a href="#environment-variables" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p><code>webpack.config.js</code>에서 <a href="/guides/development">development와</a> <a href="/guides/production">production의</a> 빌드를 명확하게 구분하기 위해 환경 변수를 사용할 수 있습니다.</p> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>webpack의 환경 변수는 <code>bash</code>와 <code>CMD.exe</code> 같은 운영체제 쉘에서의 <a href="https://en.wikipedia.org/wiki/Environment_variable">환경 변수와</a> 다릅니다.</p></aside> <p>webpack 커맨드라인 <a href="/api/cli/#environment-options">환경 옵션인</a> <code>--env</code> 를 사용하면 원하는 만큼 많은 환경 변수를 전달할 수 있습니다. 환경 변수는 <code>webpack.config.js</code>에서 액세스 할 수 있습니다. 예를 들면, <code>--env production</code> 나 <code>--env goal=local</code>.</p> <pre><code class="hljs language-bash">npx webpack --env <span class="token assign-left variable">goal</span><span class="token operator">=</span>local --env production --progress</code></pre> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>할당없이 <code>env</code> 변수를 설정하면 <code>--env production</code>은 기본적으로 <code>env.production</code> 값을 <code>true</code>로 설정합니다. 사용할 수 있는 다른 구문도 있습니다. 자세한 내용은 <a href="/api/cli/#environment-options">webpack CLI</a> 문서를 참고하세요.</p></aside> <p>webpack 설정을 변경해야 할 사항이 있습니다. 일반적으로, <code>module.exports</code>는 설정 객체를 가리킵니다. <code>env</code> 변수를 사용하려면 <code>module.exports</code>를 함수로 변환해야 합니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">env</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// 여기에서 env.&#x3C;변수> 를 사용하세요.</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Goal: '</span><span class="token punctuation">,</span> env<span class="token punctuation">.</span>goal<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'local'</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Production: '</span><span class="token punctuation">,</span> env<span class="token punctuation">.</span>production<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    entry<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
    output<span class="token operator">:</span> <span class="token punctuation">{</span>
      filename<span class="token operator">:</span> <span class="token string">'bundle.js'</span><span class="token punctuation">,</span>
      path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>Webpack CLI는 webpack 설정 내에서 접근할 수 있는 <a href="/api/cli/#environment-variables">빌트인 환경 변수</a>를 제공합니다.</p></aside> <h1 id="build-performance">Build Performance<a href="#build-performance" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p>이 가이드에는 빌드/컴파일 성능을 개선하기 위한 몇 가지 유용한 팁이 포함되어 있습니다.</p> <hr> <h2 id="general">General<a href="#general" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>다음의 모범 사례는 <a href="/guides/development">development</a> 또는 <a href="/guides/production">production</a>에서 빌드 스크립트를 실행하는 경우 도움이 될 것입니다.</p> <h3 id="stay-up-to-date">Stay Up to Date<a href="#stay-up-to-date" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>최신 webpack 버전을 사용하세요. 우리는 항상 성능을 개선하고 있습니다. webpack의 권장 최신 버전은 다음과 같습니다.</p> <p><a href="https://github.com/webpack/webpack/releases"><img src="https://img.shields.io/github/package-json/v/webpack/webpack.svg?label=webpack&#x26;style=flat-square&#x26;maxAge=3600" alt="latest webpack version"></a></p> <p><strong>Node.js를</strong> 최신 상태로 유지하면 성능에 도움이 될 수 있습니다. 또한 패키지 관리자(예: <code>npm</code> 또는 <code>yarn</code>)를 최신 상태로 유지하는 것도 도움이 될 수 있습니다. 최신 버전은 더 효율적인 모듈 트리를 생성하고 해석하는 속도를 높입니다.</p> <h3 id="loaders">Loaders<a href="#loaders" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>최소한으로 필요한 모듈에만 로더를 적용하세요.</p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span>
        loader<span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p>위와 같은 방식보다는 아래처럼 <code>include</code> 필드를 사용하여 실제로 변환해야 하는 모듈에만 로더를 적용합니다.</p> <pre><code class="hljs language-js"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span>
        include<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        loader<span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h3 id="bootstrap">Bootstrap<a href="#bootstrap" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>각각의 추가 로더/플러그인에는 부팅 시간이 있습니다. 가능한 한 도구를 적게 사용하세요.</p> <h3 id="resolving">Resolving<a href="#resolving" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>아래의 단계들로 해석 속도를 향상 시킬 수 있습니다.</p> <ul> <li>파일 시스템의 호출 수가 증가되기 때문에 <code>resolve.modules</code>, <code>resolve.extensions</code>, <code>resolve.mainFiles</code>, <code>resolve.descriptionFiles</code>의 항목 수를 최소화하세요.</li> <li>심볼릭 링크를 사용하지 않는 경우 <code>resolve.symlinks: false</code>를 설정하세요(예: <code>npm link</code> 또는 <code>yarn link</code>).</li> <li>컨텍스트에 특정적이지 않은 커스텀 해석 플러그인을 사용하는 경우 <code>resolve.cacheWithContext: false</code>를 설정하세요.</li> </ul> <h3 id="dlls">Dlls<a href="#dlls" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>자주 변경되지 않는 코드를 별도의 컴파일로 이동하려면 <code>DllPlugin</code>을 사용하세요. 이렇게 하면 빌드 프로세스가 복잡해 지지만 애플리케이션의 컴파일 속도가 향상됩니다.</p> <h3 id="smaller--faster">Smaller = Faster<a href="#smaller--faster" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>빌드 성능을 높이려면 컴파일의 총 크기를 줄이세요. 청크를 작게 유지하세요.</p> <ul> <li>더 적고 작은 라이브러리 사용</li> <li>다중 페이지 애플리케이션에서 <code>SplitChunksPlugin</code>을 사용</li> <li>다중 페이지 애플리케이션의 <code>async</code> 모드에서 <code>SplitChunksPlugin</code>을 사용</li> <li>사용하지 않는 코드를 제거</li> <li>현재 개발중인 코드의 일부만 컴파일</li> </ul> <h3 id="worker-pool">Worker Pool<a href="#worker-pool" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p><code>thread-loader</code>는 작업량이 큰 로더를 worker 풀에 작업을 분담할 때 사용할 수 있습니다.</p> <aside class="warning"><h6 class="warning__prefix">warning</h6><p>Node.js 런타임 및 로더에 대한 부팅 오버헤드가 있음으로 너무 많은 worker를 사용하지 마세요. worker와 메인 프로세스 간의 모듈 전송을 최소화하세요. IPC는 큰 비용을 필요로 합니다.</p></aside> <h3 id="persistent-cache">Persistent cache<a href="#persistent-cache" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>webpack 설정에서 <a href="/configuration/other-options/#cache"><code>cache</code></a> 옵션을 사용하세요. <code>package.json</code>의 <code>"postinstall"</code>에서 캐시 디렉터리를 지우세요.</p> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>영구 캐싱을 위해 yarn PnP 버전 3 <a href="https://yarnpkg.com/features/pnp"><code>yarn 2 berry</code></a>를 지원합니다.</p></aside> <h3 id="custom-pluginsloaders">Custom plugins/loaders<a href="#custom-pluginsloaders" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>커스텀 플러그인과 로더에서 성능 문제가 발생하지 않도록 프로파일 하세요.</p> <h3 id="progress-plugin">Progress plugin<a href="#progress-plugin" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>webpack 구성에서 <code>ProgressPlugin</code>을 제거하여 빌드 시간을 단축 할 수 있습니다. <code>ProgressPlugin</code>은 빠른 빌드에 유용하지 않을 수 있기 때문에 이점을 잘 활용하고 있는지 확인하세요.</p> <hr> <h2 id="development-1">Development<a href="#development-1" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>다음 단계는 <em>개발 단계에서</em> 특히 유용합니다.</p> <h3 id="incremental-builds">Incremental Builds<a href="#incremental-builds" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>webpack의 watch 모드를 사용하세요. 다른 도구를 사용하여 파일을 보고 webpack을 호출하지 마세요. 내장된 watch 모드는 타임 스탬프를 추적하고 캐시 무효화를 위해 이 정보를 컴파일에 전달합니다.</p> <p>일부 설정에서는 watch가 폴링 모드로 돌아갑니다. watch 되는 파일이 많으면 이로 인해 많은 CPU 로드가 발생할 수 있습니다. 이 경우 <code>watchOptions.poll</code>을 사용하여 폴링 간격을 늘릴 수 있습니다.</p> <h3 id="compile-in-memory">Compile in Memory<a href="#compile-in-memory" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>아래의 유틸리티는 디스크에 쓰는 대신 메모리에서 애셋을 컴파일하고 제공하여 성능을 향상시킵니다.</p> <ul> <li><code>webpack-dev-server</code></li> <li><code>webpack-hot-middleware</code></li> <li><code>webpack-dev-middleware</code></li> </ul> <h3 id="statstojson-speed">stats.toJson speed<a href="#statstojson-speed" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>webpack 4는 기본적으로 <code>stats.toJson()</code>을 사용하여 많은 양의 데이터를 출력합니다. 증분 단계에서 필요한 경우가 아니면 <code>stats</code> 개체의 일부를 찾지 마세요. v3.1.3 이후의 <code>webpack-dev-server</code>에는 증분 빌드 단계에서 <code>stats</code> 객체에서 검색되는 데이터의 양을 최소화하기 위한 상당한 성능 수정이 포함되었습니다.</p> <h3 id="devtool">Devtool<a href="#devtool" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>서로 다른 <code>devtool</code> 설정 간의 성능 차이에 유의하세요.</p> <ul> <li><code>"eval"</code>은 성능이 좋지만 트랜스파일 된 코드에는 도움이 되지 않습니다.</li> <li><code>cheap-source-map</code> 변형은 매핑의 질이 약간 떨어지지만, 성능이 좋습니다.</li> <li>증분 빌드에서는 <code>eval-source-map</code> 변형을 사용합니다.</li> </ul> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>대부분의 경우 <code>eval-cheap-module-source-map</code>이 가장 좋은 옵션입니다.</p></aside> <h3 id="avoid-production-specific-tooling">Avoid Production Specific Tooling<a href="#avoid-production-specific-tooling" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>특정 유틸리티, 플러그인 및 로더는 production으로 빌드할 때만 의미가 있습니다. 예를 들어, 개발 중에 <code>TerserPlugin</code>을 사용하여 코드를 축소하고 조작하는 것은 일반적으로 이치에 맞지 않습니다. 이러한 도구는 일반적으로 개발 단계에서 제외되어야 합니다.</p> <ul> <li><code>TerserPlugin</code></li> <li><code>[fullhash]</code>/<code>[chunkhash]</code>/<code>[contenthash]</code></li> <li><code>AggressiveSplittingPlugin</code></li> <li><code>AggressiveMergingPlugin</code></li> <li><code>ModuleConcatenationPlugin</code></li> </ul> <h3 id="minimal-entry-chunk">Minimal Entry Chunk<a href="#minimal-entry-chunk" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>webpack은 파일 시스템에 업데이트된 청크만 내보냅니다. 일부 설정 옵션의 경우(HMR, <code>output.chunkFilename</code>,<code>[fullhash]</code> 안의 <code>[name]</code>/<code>[chunkhash]</code>/<code>[contenthash]</code>) 변경된 청크와 함께 엔트리 청크가 무효화됩니다.</p> <p>엔트리 청크를 작게 유지하여 내보내는 비용이 저렴한지 확인하세요. 아래의 설정은 런타임 코드에 대한 추가 청크를 생성하므로 생성 비용이 저렴합니다.</p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>
    runtimeChunk<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h3 id="avoid-extra-optimization-steps">Avoid Extra Optimization Steps<a href="#avoid-extra-optimization-steps" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>webpack은 크기 및 부하 성능에 대한 출력을 최적화하기 위해 추가 알고리즘 작업을 수행합니다. 이러한 최적화는 작은 코드 베이스에서는 성능이 좋지만 큰 코드에서는 비용이 많이들 수 있습니다.</p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>
    removeAvailableModules<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    removeEmptyChunks<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    splitChunks<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h3 id="output-without-path-info">Output Without Path Info<a href="#output-without-path-info" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>webpack은 출력 번들에 경로 정보를 생성하는 기능이 있습니다. 그러나 이것은 수천 개의 모듈을 번들로 묶는 프로젝트에서 가비지 컬렉션에 과부화를 줍니다. <code>options.output.pathinfo</code> 설정에서 이 기능을 끄세요.</p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    pathinfo<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h3 id="nodejs-versions-8910-9111">Node.js Versions 8.9.10-9.11.1<a href="#nodejs-versions-8910-9111" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>Node.js 버전 8.9.10 - 9.11.1의 ES2015 <code>Map</code> 및 <code>Set</code> 구현에서 <a href="https://github.com/nodejs/node/issues/19769">성능 저하</a>가 있었습니다. webpack은 이러한 데이터 구조를 자유롭게 사용하므로 이 성능저하는 컴파일 시간에 영향을 줍니다.</p> <p>이전 및 이후 Node.js 버전은 영향을 받지 않습니다.</p> <h3 id="typescript-loader">TypeScript Loader<a href="#typescript-loader" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p><code>ts-loader</code>를 사용할 때 빌드 시간을 개선하려면 <code>transpileOnly</code> 로더 옵션을 사용하세요. 이 옵션은 자체적으로 타입 검사를 해제합니다. 타입 검사를 다시 받으려면 <a href="https://www.npmjs.com/package/fork-ts-checker-webpack-plugin"><code>ForkTsCheckerWebpackPlugin</code></a>을 사용하세요. 이렇게 각각 별도의 프로세스로 이동시키면 TypeScript 유형 검사 및 ESLint linting 속도가 빨라집니다.</p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  test<span class="token operator">:</span> <span class="token regex">/\.tsx?$/</span><span class="token punctuation">,</span>
  use<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      loader<span class="token operator">:</span> <span class="token string">'ts-loader'</span><span class="token punctuation">,</span>
      options<span class="token operator">:</span> <span class="token punctuation">{</span>
        transpileOnly<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <aside class="tip"><h6 class="tip__prefix">tip</h6><p><code>ts-loader</code> GitHub 저장소에 <a href="https://github.com/TypeStrong/ts-loader/tree/master/examples/fork-ts-checker-webpack-plugin">전체 예시</a>가 있습니다.</p></aside> <hr> <h2 id="production">Production<a href="#production" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>다음 단계는 <em>production에서</em> 특히 유용합니다.</p> <aside class="warning"><h6 class="warning__prefix">warning</h6><p><strong>작은 성능 향상을 위해 애플리케이션의 품질을 희생하지 마세요!</strong> 대부분의 경우 최적화 품질이 빌드 성능보다 더 중요합니다.</p></aside> <h3 id="multiple-compilations">Multiple Compilations<a href="#multiple-compilations" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>다중 컴파일을 사용할 때 다음 도구가 도움이 될 수 있습니다.</p> <ul> <li><a href="https://github.com/trivago/parallel-webpack"><code>parallel-webpack</code></a>: worker 풀에서 컴파일 할 수 있습니다.</li> <li><code>cache-loader</code>: 캐시는 여러 컴파일 간에 공유될 수 있습니다.</li> </ul> <h3 id="source-maps">Source Maps<a href="#source-maps" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>소스맵은 비용이 많이 듭니다. 정말로 필요한가요?</p> <hr> <h2 id="specific-tooling-issues">Specific Tooling Issues<a href="#specific-tooling-issues" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>다음 도구에는 빌드 성능을 저하시킬 수 있는 특정 문제가 있습니다.</p> <h3 id="babel">Babel<a href="#babel" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <ul> <li>preset/plugins 수를 최소화하세요.</li> </ul> <h3 id="typescript">TypeScript<a href="#typescript" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <ul> <li>별도의 프로세스에서 타입 검사를 위해 <code>fork-ts-checker-webpack-plugin</code>을 사용하세요.</li> <li>타입 검사를 건너뛰도록 로더를 설정합니다.</li> <li><code>happyPackMode: true</code> / <code>transpileOnly: true</code>에서 <code>ts-loader</code>를 사용합니다.</li> </ul> <h3 id="sass">Sass<a href="#sass" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <ul> <li><code>node-sass</code>에는 Node.js 스레드 풀의 스레드를 차단하는 버그가 있습니다. <code>thread-loader</code>와 함께 사용하는 경우 <code>workerParallelJobs: 2</code>를 설정하세요.</li> </ul> <h1 id="content-security-policies">Content Security Policies<a href="#content-security-policies" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p>webpack은 로드하는 모든 스크립트에 <code>nonce</code>를 추가할 수 있습니다. 기능세트를 활성화하려면 엔트리 스크립트에 <code>__webpack_nonce__</code> 변수를 포함해야합니다. 고유한 해시 기반 nonce가 생성되고 고유한 페이지 뷰에 대해 각각 제공되어야 합니다. 이것이 바로 <code>__webpack_nonce__</code> 가 설정이 아닌 엔트리 파일에 지정된 이유입니다. <code>nonce</code>는 항상 base64로 인코딩된 문자열이어야 합니다.</p> <h2 id="examples">Examples<a href="#examples" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>엔트리 파일 안의 경우:</p> <pre><code class="hljs language-js"><span class="token comment">// ...</span>
__webpack_nonce__ <span class="token operator">=</span> <span class="token string">'c29tZSBjb29sIHN0cmluZyB3aWxsIHBvcCB1cCAxMjM='</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span></code></pre> <h2 id="enabling-csp">Enabling CSP<a href="#enabling-csp" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>CSP는 기본적으로 활성화되어 있지 않습니다. 브라우저에 CSP를 사용하도록 지시하려면 해당하는 헤더인 <code>Content-Security-Policy</code> 혹은 메타 태그 <code>&#x3C;meta http-equiv="Content-Security-Policy" ...></code>를 도큐먼트와 함께 보내야 합니다. 다음은 CDN 화이트리스트 URL을 포함한 CSP 헤더의 예시입니다.</p> <pre><code class="hljs language-html">Content-Security-Policy: default-src 'self'; script-src 'self'
https://trusted.cdn.com;</code></pre> <p>CSP 및 <code>nonce</code> 속성에 대한 자세한 내용은 이 페이지 하단의 <strong>더 읽어보기</strong> 섹션을 참고하세요.</p> <h2 id="trusted-types">Trusted Types<a href="#trusted-types" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>Webpack은 또한 Trusted Types을 사용하여 동적으로 구성된 스크립트를 로드하고 CSP <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/require-trusted-types-for"><code>require-trusted-types-for</code></a> 지시문의 제한을 준수할 수 있습니다. <a href="/configuration/output/#outputtrustedtypes"><code>output.trustedTypes</code></a> 설정 옵션을 참고하세요.</p> <h1 id="development---vagrant">Development - Vagrant<a href="#development---vagrant" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p><a href="https://www.vagrantup.com/">Vagrant를</a> 사용하여 가상 머신에서 개발 환경을 실행하는 경우, 가상 머신에서도 webpack을 실행하고 싶을 수 있습니다.</p> <h2 id="configuring-the-project">Configuring the Project<a href="#configuring-the-project" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>시작하려면, <code>Vagrantfile</code>에 고정 IP가 있는지 확인하세요.</p> <pre><code class="hljs language-ruby"><span class="token constant">Vagrant</span><span class="token punctuation">.</span>configure<span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token operator">|</span>config<span class="token operator">|</span>
  config<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>network <span class="token symbol">:private_network</span><span class="token punctuation">,</span> ip<span class="token punctuation">:</span> <span class="token string">"10.10.10.61"</span>
<span class="token keyword">end</span></code></pre> <p>다음으로, 프로젝트에 <code>webpack</code>과 <code>webpack-dev-server</code>를 설치하세요.</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev webpack webpack-dev-server</code></pre> <p><code>webpack.config.js</code> 파일이 있는지 확인하세요. 만약 파일이 없다면 다음을 최소한의 예제로 사용해 시작하세요.</p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  context<span class="token operator">:</span> __dirname<span class="token punctuation">,</span>
  entry<span class="token operator">:</span> <span class="token string">'./app.js'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p>그리고 <code>index.html</code> 파일을 만듭니다. 스크립트 태그는 번들을 가리켜야 합니다. <code>output.filename</code>이 지정되어 있지 않다면, <code>bundle.js</code>가 됩니다.</p> <pre><code class="hljs language-html"><span class="token doctype"><span class="token punctuation">&#x3C;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>html</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/bundle.js<span class="token punctuation">"</span></span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>body</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h2</span><span class="token punctuation">></span></span>Heey!<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h2</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>html</span><span class="token punctuation">></span></span></code></pre> <p><code>app.js</code> 파일도 만들어야 합니다.</p> <h2 id="running-the-server">Running the Server<a href="#running-the-server" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>이제, 서버를 실행하세요.</p> <pre><code class="hljs language-bash">webpack serve --host <span class="token number">0.0</span>.0.0 --public <span class="token number">10.10</span>.10.61:8080 --watch-poll</code></pre> <p>기본적으로, 서버는 로컬 호스트에서만 접근할 수 있습니다. 호스트 PC에서 접근할 것이므로, 이를 허용하려면 <code>--host</code>를 변경해야 합니다.</p> <p><code>webpack-dev-server</code>는 파일이 변경될 때 다시 로드하기 위해 WebSocket에 연결하는 스크립트를 번들에 포함합니다. <code>--public</code> 플래그는 스크립트가 WebSocket을 찾을 위치를 알고 있는지 확인합니다. 서버는 기본적으로 <code>8080</code> 포트를 사용하므로, 여기에서도 지정해야 합니다.</p> <p><code>--watch-poll</code>은 webpack이 파일의 변경을 감지할 수 있도록 합니다. 기본적으로, webpack은 파일 시스템에 의해 트리거되는 이벤트를 수신하지만, VirtualBox에는 이와 관련된 많은 문제가 있습니다.</p> <p>서버는 이제 <code>http://10.10.10.61:8080</code>에서 접근할 수 있습니다. <code>app.js</code>를 변경하면 실시간으로 다시 로드됩니다.</p> <h2 id="advanced-usage-with-nginx">Advanced Usage with nginx<a href="#advanced-usage-with-nginx" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>좀 더 생산적인 환경을 모방하기 위해, nginx로 <code>webpack-dev-server</code>를 프록시 할 수도 있습니다.</p> <p>nginx 설정 파일에 다음을 추가하십시오.</p> <pre><code class="hljs language-nginx"><span class="token keyword">server</span> <span class="token punctuation">{</span>
  <span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span>
    <span class="token keyword">proxy_pass</span> <span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">8080</span><span class="token punctuation">;</span>
    <span class="token keyword">proxy_http_version</span> <span class="token number">1.1</span><span class="token punctuation">;</span>
    <span class="token keyword">proxy_set_header</span> Upgrade <span class="token variable">$http_upgrade</span><span class="token punctuation">;</span>
    <span class="token keyword">proxy_set_header</span> Connection <span class="token string">"upgrade"</span><span class="token punctuation">;</span>
    <span class="token keyword">error_page</span> <span class="token number">502</span> @start<span class="token operator">-</span>webpack<span class="token operator">-</span>dev<span class="token operator">-</span><span class="token keyword">server</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">location</span> @start<span class="token operator">-</span>webpack<span class="token operator">-</span>dev<span class="token operator">-</span><span class="token keyword">server</span> <span class="token punctuation">{</span>
    <span class="token keyword">default_type</span> text<span class="token operator">/</span>plain<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">502</span> <span class="token string">"Please start the webpack-dev-server first."</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <p><code>proxy_set_header</code> 줄은 WebSocket이 올바르게 작동하도록 허용하기 때문에 중요합니다.</p> <p><code>webpack-dev-server</code>를 시작하는 명령을 다음과 같이 변경할 수 있습니다.</p> <pre><code class="hljs language-bash">webpack serve --public <span class="token number">10.10</span>.10.61 --watch-poll</code></pre> <p>이렇게 하면, <code>127.0.0.1</code>에서만 서버에 접근할 수 있으며, nginx가 호스트 PC에서 사용할 수 있도록 처리하므로 괜찮습니다.</p> <h2 id="conclusion-4">Conclusion<a href="#conclusion-4" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>고정 IP에서 Vagrant box에 접근할 수 있도록 만든 다음, <code>webpack-dev-server</code>를 공개적으로 접근할 수 있도록 하여 브라우저에서 접근할 수 있도록 했습니다. VirtualBox가 파일 시스템 이벤트를 보내지 않아 서버가 파일 변경 시 다시 로드되지 않는 일반적인 문제를 해결했습니다.</p> <h1 id="dependency-management">Dependency Management<a href="#dependency-management" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <blockquote> <p>es6 modules</p> </blockquote> <blockquote> <p>commonjs</p> </blockquote> <blockquote> <p>amd</p> </blockquote> <h2 id="require-with-expression">require with expression<a href="#require-with-expression" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>요청에 표현식이 포함된 경우 컨텍스트가 생성되므로, 컴파일 시간에 <strong>정확한</strong> 모듈을 알 수 없습니다.</p> <p>예를 들어, <code>.ejs</code> 파일을 포함하는 다음과 같은 폴더 구조가 있습니다.</p> <pre><code class="hljs language-bash">example_directory
│
└───template
│   │   table.ejs
│   │   table-row.ejs
│   │
│   └───directory
│       │   another.ejs</code></pre> <p>다음의 <code>require()</code> 호출이 평가될 때</p> <pre><code class="hljs language-javascript"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./template/'</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">'.ejs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p>webpack은 <code>require()</code> 호출을 구문 분석하고 일부 정보를 추출합니다.</p> <pre><code class="hljs language-code">Directory: ./template
Regular expression: /^.*\.ejs$/
</code></pre> <p><strong>컨텍스트 모듈</strong></p> <p>컨텍스트 모듈이 생성됩니다. 정규 표현식과 일치하는 요청에 필요할 수 있는 <strong>해당 디렉터리의 모든 모듈에</strong> 대한 참조를 포함합니다. 컨텍스트 모듈은 요청을 모듈 id로 변환하는 맵을 포함합니다.</p> <p>맵 예제:</p> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"./table.ejs"</span><span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span>
  <span class="token property">"./table-row.ejs"</span><span class="token operator">:</span> <span class="token number">43</span><span class="token punctuation">,</span>
  <span class="token property">"./directory/another.ejs"</span><span class="token operator">:</span> <span class="token number">44</span>
<span class="token punctuation">}</span></code></pre> <p>컨텍스트 모듈은 또한 맵에 접근하기 위한 런타임 로직도 포함합니다.</p> <p>이것은 동적으로 요청하는 기능이 지원되지만 모든 모듈이 번들에 포함되는 것을 의미합니다.</p> <h2 id="requirecontext"><code>require.context</code><a href="#requirecontext" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>require.context()</code> 함수로 자신만의 컨텍스트를 만들 수 있습니다.</p> <p>검색할 디렉터리, 하위 디렉터리를 검색해야 하는지 여부를 나타내는 플래그, 일치하는 파일의 정규식을 전달할 수 있습니다.</p> <p>webpack은 빌드 하는 동안 코드에서 <code>require.context()</code>를 구문 분석합니다.</p> <p>구문은 다음과 같습니다.</p> <pre><code class="hljs language-javascript">require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span>
  directory<span class="token punctuation">,</span>
  <span class="token punctuation">(</span>useSubdirectories <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span>regExp <span class="token operator">=</span> <span class="token regex">/^\.\/.*$/</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span>mode <span class="token operator">=</span> <span class="token string">'sync'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p>예:</p> <pre><code class="hljs language-javascript">require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">'./test'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token regex">/\.test\.js$/</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// test 디렉터리에서 요청이 `.test.js`로 끝나는 파일이 있는 컨텍스트입니다.</span></code></pre> <pre><code class="hljs language-javascript">require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">'../'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token regex">/\.stories\.js$/</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 상위 폴더와 그 하위 폴더에서 `.stories.js`로 끝나는 파일이 있는 컨텍스트입니다.</span></code></pre> <aside class="warning"><h6 class="warning__prefix">warning</h6><p><code>require.context</code>에 전달할 인수는 리터럴이어야 합니다!</p></aside> <h3 id="context-module-api">context module API<a href="#context-module-api" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>컨텍스트 모듈은 하나의 인수(요청)를 가지는 함수를 export 합니다.</p> <p>export 한 함수는 <code>resolve</code>, <code>keys</code>, <code>id</code> 3가지 속성을 가집니다.</p> <ul> <li><code>resolve</code>는 파싱된 요청의 모듈 id를 반환하는 함수입니다.</li> <li><code>keys</code>는 컨텍스트 모듈이 처리할 수 있는 가능한 모든 요청의 배열을 반환하는 함수입니다.</li> </ul> <p>이것은 디렉터리의 모든 파일을 요청하거나 패턴과 일치시키려는 경우에 유용할 수 있습니다. 예제는 다음과 같습니다.</p> <pre><code class="hljs language-javascript"><span class="token keyword">function</span> <span class="token function">importAll</span><span class="token punctuation">(</span><span class="token parameter">r</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  r<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">importAll</span><span class="token punctuation">(</span>require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">'../components/'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token regex">/\.js$/</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <pre><code class="hljs language-javascript"><span class="token keyword">const</span> cache <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">importAll</span><span class="token punctuation">(</span><span class="token parameter">r</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  r<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>cache<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">r</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">importAll</span><span class="token punctuation">(</span>require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">'../components/'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token regex">/\.js$/</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 빌드 시 캐시는 모든 필수 모듈로 채워집니다.</span></code></pre> <ul> <li><code>id</code>는 컨텍스트 모듈의 모듈 id입니다. 이것은 <code>module.hot.accept</code>에서 유용할 수 있습니다.</li> </ul> <h1 id="installation">Installation<a href="#installation" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p>이 가이드에서는 webpack을 설치하는 데 사용되는 다양한 방법에 대해 설명합니다.</p> <h2 id="prerequisites">Prerequisites<a href="#prerequisites" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>시작하기 전에, <a href="https://nodejs.org/en/">Node.js가</a> 최신 버전으로 설치되어 있는지 확인하세요. 현재 장기 지원 버전(LTS)은 이상적인 시작점입니다. 이전 버전에서는 webpack 혹은 관련 패키지에 필요한 기능이 누락되어 있을 수 있기 때문에 다양한 문제가 발생할 수 있습니다.</p> <h2 id="local-installation">Local Installation<a href="#local-installation" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>최신 webpack 릴리스는 다음과 같습니다.</p> <p><a href="https://github.com/webpack/webpack/releases"><img src="https://img.shields.io/npm/v/webpack.svg?label=webpack&#x26;style=flat-square&#x26;maxAge=3600" alt="GitHub release"></a></p> <p>최신 릴리스 또는 특정 버전을 설치하려면 다음 명령 중 하나를 실행하세요.</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev webpack
<span class="token comment"># 또는 특정 버전</span>
<span class="token function">npm</span> <span class="token function">install</span> --save-dev webpack@<span class="token operator">&#x3C;</span>version<span class="token operator">></span></code></pre> <aside class="tip"><h6 class="tip__prefix">tip</h6><p><code>--save-dev</code>의 사용 여부는 사례에 따라 다릅니다. webpack을 번들링을 위해서만 사용한다고 가정하면, 프로덕션 빌드에 webpack을 포함하지 않을 것이므로 <code>--save-dev</code> 옵션으로 설치하는 것이 좋습니다. 그렇지 않으면 <code>--save-dev</code> 를 무시할 수 있습니다.</p></aside> <p>webpack v4 이상을 사용하는 경우 <a href="/api/cli/">CLI</a>도 설치해야 합니다.</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev webpack-cli</code></pre> <p>대부분의 프로젝트에서는 로컬 설치를 권장합니다. 이를 통해 주요 변경사항이 있을 때 개별적으로 프로젝트를 쉽게 업그레이드 할 수 있습니다. 일반적으로 webpack은 하나 이상의 <a href="https://docs.npmjs.com/misc/scripts">npm scripts</a>를 통해 실행되며 이 스크립트는 로컬의 <code>node_modules</code> 디렉터리에 설치된 webpack을 찾습니다.</p> <pre><code class="hljs language-json"><span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"webpack --config webpack.config.js"</span>
<span class="token punctuation">}</span></code></pre> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>webpack의 로컬 설치를 실행하려면, 바이너리 버전인 <code>node_modules/.bin/webpack</code>으로 접근할 수 있습니다. 또는 npm v5.2.0이나 이상 버전을 사용하는 경우 <code>npx webpack</code>을 실행하여 이 작업을 수행할 수 있습니다.</p></aside> <h2 id="global-installation">Global Installation<a href="#global-installation" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>다음과 같이 NPM을 설치하면 webpack을 전역적으로 사용할 수 있습니다.</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --global webpack</code></pre> <aside class="warning"><h6 class="warning__prefix">warning</h6><p>이것을 <strong>권장하지 않는다는 것을</strong> 기억하세요. 전역으로 설치하면 특정 버전의 webpack만 사용할 수 있고 다른 버전을 사용할 경우 실패할 수 있습니다.</p></aside> <h2 id="bleeding-edge">Bleeding Edge<a href="#bleeding-edge" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>webpack이 제공하는 최신 버전을 사용하는 데 관심이 있다면 다음 명령을 사용하여 베타 버전을 설치하거나 webpack 저장소에서 직접 설치해 볼 수 있습니다.</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev webpack@next
<span class="token comment"># 또는 특정 tagname/branchname</span>
<span class="token function">npm</span> <span class="token function">install</span> --save-dev webpack/webpack<span class="token comment">#&#x3C;tagname/branchname></span></code></pre> <aside class="warning"><h6 class="warning__prefix">warning</h6><p>이러한 최신 릴리스를 설치할 때 주의하세요! 여전히 버그가 있을 수 있기 때문에 프로덕션에 사용하면 안됩니다.</p></aside> <h1 id="hot-module-replacement">Hot Module Replacement<a href="#hot-module-replacement" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>이 가이드는 <a href="/guides/development">개발 가이드</a>에 있는 코드 예제를 확장합니다.</p></aside> <p>Hot Module Replacement(또는 HMR)는 webpack에서 제공하는 가장 유용한 기능 중 하나입니다. 모든 종류의 모듈을 새로고침 할 필요 없이 런타임에 업데이트 할 수 있습니다. 이 페이지는 <strong>구현에</strong> 초점을 맞추고 <a href="/concepts/hot-module-replacement">개념 페이지</a>는 작동 원리와 왜 유용한지에 대한 자세한 내용을 제공합니다.</p> <aside class="warning"><h6 class="warning__prefix">warning</h6><p><strong>HMR</strong>은 프로덕션용이 아니므로 개발용으로만 사용해야 합니다. 자세한 내용은 <a href="/guides/production">프로덕션 구축 가이드</a>를 참고하세요.</p></aside> <h2 id="enabling-hmr">Enabling HMR<a href="#enabling-hmr" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>이 기능은 생산성에 많은 도움을 줍니다. <a href="https://github.com/webpack/webpack-dev-server">webpack-dev-server</a> 설정을 업데이트하고 webpack의 내장 HMR 플러그인을 사용하면 됩니다. <code>index.js</code> 모듈에서 사용될 것이므로 <code>print.js</code>의 엔트리 포인트도 제거합니다.</p> <aside class="tip"><h6 class="tip__prefix">tip</h6><p><code>webpack-dev-server</code> 대신 <code>webpack-dev-middleware</code>를 사용한다면 <a href="https://github.com/webpack-contrib/webpack-hot-middleware"><code>webpack-hot-middleware</code></a> 패키지를 사용하여 커스텀 서버 또는 애플리케이션에서 HMR을 활성화하세요.</p></aside> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line"> const HtmlWebpackPlugin = require('html-webpack-plugin');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">   entry: {
</span><span class="token prefix unchanged"> </span><span class="token line">      app: './src/index.js',
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">      print: './src/print.js',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   devtool: 'inline-source-map',
</span><span class="token prefix unchanged"> </span><span class="token line">   devServer: {
</span><span class="token prefix unchanged"> </span><span class="token line">     contentBase: './dist',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     hot: true,
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">     new HtmlWebpackPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">       title: 'Hot Module Replacement',
</span><span class="token prefix unchanged"> </span><span class="token line">     }),
</span><span class="token prefix unchanged"> </span><span class="token line">   ],
</span><span class="token prefix unchanged"> </span><span class="token line">   output: {
</span><span class="token prefix unchanged"> </span><span class="token line">     filename: '[name].bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">     path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">     clean: true,
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line"> };</span></span></code></pre> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>CLI를 사용하여 <code>webpack serve --hot = only</code> 명령어로 <a href="https://github.com/webpack/webpack-dev-server">webpack-dev-server</a> 구성을 수정할 수 있습니다.</p></aside> <p>이제 <code>index.js</code> 파일을 업데이트하여 <code>print.js</code> 내부의 변경이 감지되면 webpack에서 업데이트된 모듈을 수락하도록 지시합니다.</p> <p><strong>index.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> import _ from 'lodash';
</span><span class="token prefix unchanged"> </span><span class="token line"> import printMe from './print.js';
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">   const element = document.createElement('div');
</span><span class="token prefix unchanged"> </span><span class="token line">   const btn = document.createElement('button');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   btn.innerHTML = 'Click me and check the console!';
</span><span class="token prefix unchanged"> </span><span class="token line">   btn.onclick = printMe;
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   element.appendChild(btn);
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   return element;
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> document.body.appendChild(component());
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line"> if (module.hot) {
</span><span class="token prefix inserted">+</span><span class="token line">   module.hot.accept('./print.js', function() {
</span><span class="token prefix inserted">+</span><span class="token line">     console.log('Accepting the updated printMe module!');
</span><span class="token prefix inserted">+</span><span class="token line">     printMe();
</span><span class="token prefix inserted">+</span><span class="token line">   })
</span><span class="token prefix inserted">+</span><span class="token line"> }</span></span></code></pre> <p><code>print.js</code>에서 <code>console.log</code> 문을 변경하면 브라우저 콘솔에 다음과 같은 출력이 표시됩니다. (당분간 <code>button.onclick = printMe</code> 출력에 대해 걱정하지 마세요. 나중에 해당 부분을 변경할 것입니다.)</p> <p><strong>print.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> export default function printMe() {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">   console.log('I get called from print.js!');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   console.log('Updating print.js...');
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> }</span></span></code></pre> <p><strong>console</strong></p> <pre><code class="hljs language-diff">[HMR] Waiting for update signal from WDS...
main.js:4395 [WDS] Hot Module Replacement enabled.
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> 2main.js:4395 [WDS] App updated. Recompiling...
</span><span class="token prefix inserted">+</span><span class="token line"> main.js:4395 [WDS] App hot update...
</span><span class="token prefix inserted">+</span><span class="token line"> main.js:4330 [HMR] Checking for updates on the server...
</span><span class="token prefix inserted">+</span><span class="token line"> main.js:10024 Accepting the updated printMe module!
</span><span class="token prefix inserted">+</span><span class="token line"> 0.4b8ee77….hot-update.js:10 Updating print.js...
</span><span class="token prefix inserted">+</span><span class="token line"> main.js:4330 [HMR] Updated modules:
</span><span class="token prefix inserted">+</span><span class="token line"> main.js:4330 [HMR]  - 20</span></span></code></pre> <h2 id="via-the-nodejs-api">Via the Node.js API<a href="#via-the-nodejs-api" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>Node.js API와 함께 Webpack Dev Server를 사용하는 경우 webpack 설정 객체에 dev 서버 옵션을 추가하지 마십시오. 대신 생성 시 두 번째 매개 변수로 전달하십시오. 예를 들어 보겠습니다.</p> <p><code>new WebpackDevServer(compiler, options)</code></p> <p>HMR을 활성화하려면 HMR 엔트리 포인트를 포함하도록 webpack 설정 객체도 수정해야 합니다. <code>webpack-dev-server</code> 패키지에는 이를 수행하는 데 사용할 수 있는 <code>addDevServerEntrypoints</code>라는 메서드가 포함되어 있습니다. 다음은 그 모습에 대한 간단한 예시입니다.</p> <p><strong>dev-server.js</strong></p> <pre><code class="hljs language-javascript"><span class="token keyword">const</span> webpackDevServer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-dev-server'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack.config.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  contentBase<span class="token operator">:</span> <span class="token string">'./dist'</span><span class="token punctuation">,</span>
  hot<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  host<span class="token operator">:</span> <span class="token string">'localhost'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

webpackDevServer<span class="token punctuation">.</span><span class="token function">addDevServerEntrypoints</span><span class="token punctuation">(</span>config<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> compiler <span class="token operator">=</span> <span class="token function">webpack</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">webpackDevServer</span><span class="token punctuation">(</span>compiler<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>

server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">,</span> <span class="token string">'localhost'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'dev server listening on port 5000'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <aside class="tip"><h6 class="tip__prefix">tip</h6><p><a href="/guides/development/#using-webpack-dev-middleware"><code>webpack-dev-middleware</code> 사용</a>의 경우 <a href="https://github.com/webpack-contrib/webpack-hot-middleware"><code>webpack-hot-middleware</code></a> 패키지를 사용하여 커스텀 개발 서버에서 HMR을 활성화합니다.</p></aside> <h2 id="gotchas">Gotchas<a href="#gotchas" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>Hot Module Replacement는 까다로울 수 있습니다. 이를 보여주기 위해 작업 예제로 돌아갑시다. 계속해서 예제 페이지의 버튼을 클릭하면 콘솔이 이전 <code>printMe</code> 함수를 인쇄하고 있음을 알 수 있습니다.</p> <p>이것은 버튼의 <code>onclick</code> 이벤트 핸들러가 여전히 원래의 <code>printMe</code> 함수에 바인딩 되어 있기 때문에 발생합니다.</p> <p>HMR에서 이 작업을 수행하려면 <code>module.hot.accept</code>를 사용하여 새 <code>printMe</code> 함수에 대한 바인딩을 업데이트해야 합니다.</p> <p><strong>index.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> import _ from 'lodash';
</span><span class="token prefix unchanged"> </span><span class="token line"> import printMe from './print.js';
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">   const element = document.createElement('div');
</span><span class="token prefix unchanged"> </span><span class="token line">   const btn = document.createElement('button');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   btn.innerHTML = 'Click me and check the console!';
</span><span class="token prefix unchanged"> </span><span class="token line">   btn.onclick = printMe;  // onclick 이벤트는 원래 printMe 함수에 바인딩 됩니다.
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   element.appendChild(btn);
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   return element;
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>
<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> document.body.appendChild(component());
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> let element = component(); // print.js 변경 시 다시 렌더링할 요소 저장
</span><span class="token prefix inserted">+</span><span class="token line"> document.body.appendChild(element);
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> if (module.hot) {
</span><span class="token prefix unchanged"> </span><span class="token line">   module.hot.accept('./print.js', function() {
</span><span class="token prefix unchanged"> </span><span class="token line">     console.log('Accepting the updated printMe module!');
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">     printMe();
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     document.body.removeChild(element);
</span><span class="token prefix inserted">+</span><span class="token line">     element = component(); // 클릭 핸들러를 업데이트하려면 "component"를 다시 렌더링하십시오.
</span><span class="token prefix inserted">+</span><span class="token line">     document.body.appendChild(element);
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   })
</span><span class="token prefix unchanged"> </span><span class="token line"> }</span></span></code></pre> <p>이것은 하나의 예시일 뿐이지만 사람들이 실수할 수 있는 상황이 많이 있습니다. 운 좋게도 Hot Module Replacement를 훨씬 쉽게 만들어주는 많은 로더가 있습니다. (그중 일부는 아래에 언급됨).</p> <h2 id="hmr-with-stylesheets">HMR with Stylesheets<a href="#hmr-with-stylesheets" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>CSS Hot Module Replacement는 실제로 <code>style-loader</code>의 도움으로 상당히 간단합니다. 이 로더는 CSS 의존성이 업데이트될 때 <code>&#x3C;style></code>태그를 패치하기 위해 백그라운드에서 <code>module.hot.accept</code>를 사용합니다.</p> <p>먼저 다음 명령으로 두 로더를 모두 설치해 보겠습니다.</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev style-loader css-loader</code></pre> <p>이제 로더를 사용하도록 설정 파일을 업데이트 하겠습니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line"> const HtmlWebpackPlugin = require('html-webpack-plugin');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">   entry: {
</span><span class="token prefix unchanged"> </span><span class="token line">     app: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   devtool: 'inline-source-map',
</span><span class="token prefix unchanged"> </span><span class="token line">   devServer: {
</span><span class="token prefix unchanged"> </span><span class="token line">     contentBase: './dist',
</span><span class="token prefix unchanged"> </span><span class="token line">     hot: true,
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   module: {
</span><span class="token prefix inserted">+</span><span class="token line">     rules: [
</span><span class="token prefix inserted">+</span><span class="token line">       {
</span><span class="token prefix inserted">+</span><span class="token line">         test: /\.css$/,
</span><span class="token prefix inserted">+</span><span class="token line">         use: ['style-loader', 'css-loader'],
</span><span class="token prefix inserted">+</span><span class="token line">       },
</span><span class="token prefix inserted">+</span><span class="token line">     ],
</span><span class="token prefix inserted">+</span><span class="token line">   },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">     new HtmlWebpackPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">       title: 'Hot Module Replacement',
</span><span class="token prefix unchanged"> </span><span class="token line">     }),
</span><span class="token prefix unchanged"> </span><span class="token line">   ],
</span><span class="token prefix unchanged"> </span><span class="token line">   output: {
</span><span class="token prefix unchanged"> </span><span class="token line">     filename: '[name].bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">     path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">     clean: true,
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line"> };</span></span></code></pre> <p>스타일 시트 핫 로딩은 모듈로 가져오는 것만큼 쉽습니다.</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> webpack-demo
</span><span class="token prefix unchanged"> </span><span class="token line"> | - package.json
</span><span class="token prefix unchanged"> </span><span class="token line"> | - webpack.config.js
</span><span class="token prefix unchanged"> </span><span class="token line"> | - /dist
</span><span class="token prefix unchanged"> </span><span class="token line">   | - bundle.js
</span><span class="token prefix unchanged"> </span><span class="token line"> | - /src
</span><span class="token prefix unchanged"> </span><span class="token line">   | - index.js
</span><span class="token prefix unchanged"> </span><span class="token line">   | - print.js
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   | - styles.css</span></span></code></pre> <p><strong>styles.css</strong></p> <pre><code class="hljs language-css"><span class="token selector">body</span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> blue<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> <p><strong>index.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> import _ from 'lodash';
</span><span class="token prefix unchanged"> </span><span class="token line"> import printMe from './print.js';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> import './styles.css';
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">   const element = document.createElement('div');
</span><span class="token prefix unchanged"> </span><span class="token line">   const btn = document.createElement('button');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   btn.innerHTML = 'Click me and check the console!';
</span><span class="token prefix unchanged"> </span><span class="token line">   btn.onclick = printMe;  // onclick 이벤트는 원래 printMe 함수에 바인딩 됩니다.
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   element.appendChild(btn);
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   return element;
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> let element = component();
</span><span class="token prefix unchanged"> </span><span class="token line"> document.body.appendChild(element);
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> if (module.hot) {
</span><span class="token prefix unchanged"> </span><span class="token line">   module.hot.accept('./print.js', function() {
</span><span class="token prefix unchanged"> </span><span class="token line">     console.log('Accepting the updated printMe module!');
</span><span class="token prefix unchanged"> </span><span class="token line">     document.body.removeChild(element);
</span><span class="token prefix unchanged"> </span><span class="token line">     element = component(); // 클릭 핸들러를 업데이트하려면 "component"를 다시 렌더링하십시오.
</span><span class="token prefix unchanged"> </span><span class="token line">     document.body.appendChild(element);
</span><span class="token prefix unchanged"> </span><span class="token line">   })
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span></code></pre> <p><code>body</code>의 스타일을 <code>background : red;</code>로 변경하면 새로고침 없이도 페이지의 배경색이 변경되는 것을 즉시 확인할 수 있습니다.</p> <p><strong>styles.css</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> body {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">   background: blue;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   background: red;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> }</span></span></code></pre> <h2 id="other-code-and-frameworks">Other Code and Frameworks<a href="#other-code-and-frameworks" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>HMR이 다양한 프레임워크 및 라이브러리와 원활하게 상호 작용할 수 있도록 커뮤니티에는 다른 많은 로더와 예제가 있습니다.</p> <ul> <li><a href="https://github.com/gaearon/react-hot-loader">React Hot Loader</a>: 실시간으로 React 컴포넌트를 조정</li> <li><a href="https://github.com/vuejs/vue-loader">Vue Loader</a>: Vue 캄포넌트에 대한 HMR을 즉시 지원하는 로더</li> <li><a href="https://github.com/klazuka/elm-hot-webpack-loader">Elm Hot webpack Loader</a>: Elm 프로그래밍 언어에 대한 HMR 지원</li> <li><a href="https://github.com/gdi2290/angular-hmr">Angular HMR</a>: 로더가 필요 없습니다! 기본 NgModule 파일을 간단히 변경하면 HMR API를 완전히 제어 할 수 있습니다.</li> <li><a href="https://github.com/sveltejs/svelte-loader">Svelte Loader</a>: Svelte 컴포넌트에 대한 HMR을 즉시 지원하는 로더</li> </ul> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>HMR을 돕거나 향상시키는 다른 로더나 플러그인을 알고 있다면 pull request를 제출하여 이 목록에 추가해주세요!</p></aside> <h1 id="tree-shaking">Tree Shaking<a href="#tree-shaking" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p><em>Tree shaking은</em> 사용되지 않는 코드를 제거하기 위해 JavaScript 컨텍스트에서 일반적으로 사용되는 용어입니다. ES2015 모듈 구문은 <a href="http://exploringjs.com/es6/ch_modules.html#static-module-structure">정적 구조</a>에 의존합니다. 예를 들면, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import"><code>import</code></a>와 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/export"><code>export</code></a>가 있습니다. 이름과 개념은 ES2015 모듈 번들러의 <a href="https://github.com/rollup/rollup">rollup</a>에 의해 대중화되었습니다.</p> <p>webpack 2 릴리스에서는 ES2015 모듈(별칭 <em>harmony 모듈</em>)과 사용하지 않는 모듈의 export를 감지하는 기능을 제공합니다. 새로운 webpack 4의 릴리스는 <code>package.json</code>의 <code>"sideEffects"</code> 프로퍼티를 통해 컴파일러에 힌트를 제공하는 방식으로 기능을 확장합니다. 프로젝트의 어떤 파일이 "순수"한지 나타내며, 만약 사용하지 않는다면 제거해도 괜찮은지 표시합니다.</p> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>이 가이드의 나머지 부분은 <a href="/guides/getting-started">Getting Started에서</a> 시작합니다. 가이드를 아직 읽지 않았다면 지금 읽어보세요.</p></aside> <h2 id="add-a-utility">Add a Utility<a href="#add-a-utility" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>다음 두 함수를 내보내는 새 유틸리티 파일인 <code>src/math.js</code>를 프로젝트에 추가해 보겠습니다.</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff">webpack-demo
|- package.json
|- webpack.config.js
|- /dist
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- bundle.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- index.html
</span></span>|- /src
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- index.js
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> |- math.js
</span></span>|- /node_modules</code></pre> <p><strong>src/math.js</strong></p> <pre><code class="hljs language-javascript"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">square</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> x <span class="token operator">*</span> x<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">cube</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> x <span class="token operator">*</span> x <span class="token operator">*</span> x<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> <p><code>mode</code> 옵션을 <a href="/configuration/mode/#mode-development">development</a>로 설정하여 번들이 압축되지 않도록 합니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff">const path = require('path');

module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line"> output: {
</span><span class="token prefix unchanged"> </span><span class="token line">   filename: 'bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> mode: 'development',
</span><span class="token prefix inserted">+</span><span class="token line"> optimization: {
</span><span class="token prefix inserted">+</span><span class="token line">   usedExports: true,
</span><span class="token prefix inserted">+</span><span class="token line"> },
</span></span>};</code></pre> <p>이를 통해 새로운 메소드 중 하나를 사용하도록 entry 스크립트를 업데이트하고, 스크립트를 간단하게 하기 위해 <code>lodash</code>를 삭제하겠습니다.</p> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> import _ from 'lodash';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> import { cube } from './math.js';
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> function component() {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">   const element = document.createElement('div');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   const element = document.createElement('pre');
</span></span>
<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">   // 이제 Lodash를 스크립트로 가져왔습니다.
</span><span class="token prefix deleted">-</span><span class="token line">   element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   element.innerHTML = [
</span><span class="token prefix inserted">+</span><span class="token line">     'Hello webpack!',
</span><span class="token prefix inserted">+</span><span class="token line">     '5 cubed is equal to ' + cube(5)
</span><span class="token prefix inserted">+</span><span class="token line">   ].join('\n\n');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   return element;
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> document.body.appendChild(component());</span></span></code></pre> <p>우리는 <code>src/math.js</code> 모듈에서 <strong><code>square</code> 메소드를 <code>가져오지</code> 않았습니다</strong>. 이 함수는 "사용하지 않는 코드"로 알려져 있고, 사용하지 않아 삭제되어야 하는 <code>export</code>를 의미합니다. 이제 npm 스크립트인 <code>npm run build</code>를 실행하여 출력된 번들을 살펴보겠습니다.</p> <p><strong>dist/bundle.js (around lines 90 - 100)</strong></p> <pre><code class="hljs language-js"><span class="token comment">/* 1 */</span>
<span class="token comment">/***/</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">module<span class="token punctuation">,</span> __webpack_exports__<span class="token punctuation">,</span> __webpack_require__</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token string">'use strict'</span><span class="token punctuation">;</span>
  <span class="token comment">/* unused harmony export square */</span>
  <span class="token comment">/* harmony export (immutable) */</span> __webpack_exports__<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span> <span class="token operator">=</span> cube<span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">square</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">*</span> x<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">cube</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">*</span> x <span class="token operator">*</span> x<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p>위의 <code>unused harmony export square</code> 주석을 참고하세요. 아래 코드를 보면 <code>square</code>를 가져오지 않지만, 여전히 번들에 포함되어 있습니다. 다음 섹션에서 수정해 보겠습니다.</p> <h2 id="mark-the-file-as-side-effect-free">Mark the file as side-effect-free<a href="#mark-the-file-as-side-effect-free" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>100% ESM 모듈에서는 사이드 이펙트를 쉽게 식별할 수 있습니다. 그러나 우리는 아직 거기까지는 도달하지 않았으므로, 도달하기 까지는 코드의 "순수성"에 대한 힌트를 webpack 컴파일러에 제공해야 합니다.</p> <p>이를 수행하는 방법은 package.json의 <code>"sideEffects"</code> 속성입니다.</p> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"your-project"</span><span class="token punctuation">,</span>
  <span class="token property">"sideEffects"</span><span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span></code></pre> <p>위에 언급한 코드는 사이드 이펙트를 포함하지 않으므로, 간단하게 <code>false</code>로 프로퍼티를 표시하여 사용하지 않는 export는 제거해도 괜찮다는 것을 webpack에 알릴 수 있습니다.</p> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>"사이드 이펙트"는 하나 이상의 export를 보여주는 것 이외에도 import할 때 특별한 동작을 수행하는 코드입니다. 예를 들면 폴리필이 있습니다. 폴리필은 전체 스코프에 영향을 미치며 일반적으로 export를 제공하지 않습니다.</p></aside> <p>코드에 사이드 이펙트가 있다면 대신 배열을 사용할 수 있습니다.</p> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"your-project"</span><span class="token punctuation">,</span>
  <span class="token property">"sideEffects"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"./src/some-side-effectful-file.js"</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre> <p>배열은 관련된 파일의 간단한 전역 패턴을 허용합니다. 내부적으로 <a href="https://github.com/fitzgen/glob-to-regexp">glob-to-regexp</a>을 사용합니다 (사용 가능: <code>*</code>, <code>**</code>, <code>{a,b}</code>, <code>[a-z]</code>). <code>/</code>을 포함하지 않는 <code>*.css</code>와 같은 패턴은 <code>**/*.css</code>처럼 취급합니다.</p> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>가져온 파일은 tree shaking의 대상이 됩니다. 즉, 프로젝트에서 CSS 파일을 가져오기 위해 <code>css-loader</code> 같은 것을 사용하는 경우 side effect 목록에 추가해야 프로덕션 모드에서 실수로 삭제되는 것을 방지할 수 있습니다.</p></aside> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"your-project"</span><span class="token punctuation">,</span>
  <span class="token property">"sideEffects"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"./src/some-side-effectful-file.js"</span><span class="token punctuation">,</span> <span class="token string">"*.css"</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre> <p>마지막으로 <code>"sideEffects"</code>는 <a href="https://webpack.js.org/configuration/module/#modulerules"><code>module.rules</code> 옵션</a>으로도 설정할 수 있습니다.</p> <h2 id="clarifying-tree-shaking-and-sideeffects">Clarifying tree shaking and <code>sideEffects</code><a href="#clarifying-tree-shaking-and-sideeffects" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><a href="/configuration/optimization/#optimizationsideeffects"><code>sideEffects</code></a>와 <a href="/configuration/optimization/#optimizationusedexports"><code>usedExports</code></a>(트리 쉐이킹으로 알려져 있음)의 최적화는 두 가지 다른 점이 있습니다.</p> <p><strong><code>sideEffects</code>는</strong> 전체 모듈 및 파일, 전체 하위 트리를 건너뛸 수 있기 때문에 <strong>훨씬 더 효율적입니다.</strong></p> <p><code>usedExports</code>는 <a href="https://github.com/terser-js/terser">terser</a>를 사용하여 문장에서 사이드 이펙트를 감지합니다. 이것은 JavaScript에서 어려운 작업이며 간단한 <code>sideEffects</code> 플래그만큼 효과적이지 않습니다. 또한 사이드 이펙트를 확인해야 하는 명세가 있기 때문에 하위트리 및 의존성을 무시할 수 없습니다. export 기능은 잘 동작하지만, React의 Higher Order Components(HOC)는 이와 관련된 문제가 있습니다.</p> <p>예를 들어보겠습니다.</p> <pre><code class="hljs language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> Button <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@shopify/polaris'</span><span class="token punctuation">;</span></code></pre> <p>미리 번들된 버전은 아래와 같습니다.</p> <pre><code class="hljs language-javascript"><span class="token keyword">import</span> hoistStatics <span class="token keyword">from</span> <span class="token string">'hoist-non-react-statics'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">Button</span><span class="token punctuation">(</span><span class="token parameter">_ref</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">merge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> _final <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span>
    <span class="token keyword">var</span> _len <span class="token operator">=</span> arguments<span class="token punctuation">.</span>length<span class="token punctuation">,</span> objs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span>_len<span class="token punctuation">)</span><span class="token punctuation">,</span> _key <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    _key <span class="token operator">&#x3C;</span> _len<span class="token punctuation">;</span>
    _key<span class="token operator">++</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    objs<span class="token punctuation">[</span>_key<span class="token punctuation">]</span> <span class="token operator">=</span> arguments<span class="token punctuation">[</span>_key<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> _i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> _objs <span class="token operator">=</span> objs<span class="token punctuation">;</span> _i <span class="token operator">&#x3C;</span> _objs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> _i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> obj <span class="token operator">=</span> _objs<span class="token punctuation">[</span>_i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">mergeRecursively</span><span class="token punctuation">(</span>_final<span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> _final<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">withAppProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">addProvider</span><span class="token punctuation">(</span><span class="token parameter">WrappedComponent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> WithProvider <span class="token operator">=</span>
      <span class="token comment">/*#__PURE__*/</span>
      <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">_React$Component</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ...</span>
        <span class="token keyword">return</span> WithProvider<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>Component<span class="token punctuation">)</span><span class="token punctuation">;</span>

    WithProvider<span class="token punctuation">.</span>contextTypes <span class="token operator">=</span> WrappedComponent<span class="token punctuation">.</span>contextTypes
      <span class="token operator">?</span> <span class="token function">merge</span><span class="token punctuation">(</span>WrappedComponent<span class="token punctuation">.</span>contextTypes<span class="token punctuation">,</span> polarisAppProviderContextTypes<span class="token punctuation">)</span>
      <span class="token operator">:</span> polarisAppProviderContextTypes<span class="token punctuation">;</span>
    <span class="token keyword">var</span> FinalComponent <span class="token operator">=</span> <span class="token function">hoistStatics</span><span class="token punctuation">(</span>WithProvider<span class="token punctuation">,</span> WrappedComponent<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> FinalComponent<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> Button$<span class="token number">1</span> <span class="token operator">=</span> <span class="token function">withAppProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>Button<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...,</span>
  Button$<span class="token number">1</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p><code>Button</code>이 사용되지 않으면 <code>export { Button$1 };</code>을 효과적으로 제거하고 나머지 코드를 모두 남길 수 있습니다. "이 코드가 사이드 이펙트가 없거나 안전하게 삭제할 수 있을까요?"라는 질문을 할 수 있습니다. <code>withAppProvider()(Button)</code> 라인 때문에 말하기 어렵습니다. <code>withAppProvider</code>가 호출되고 리턴 값도 호출됩니다. <code>merge</code> 또는 <code>hoistStatics</code>를 호출할 때 사이드 이펙트가 있나요? <code>WrappedComponent.contextTypes</code> (Getter?)를 읽거나 <code>WithProvider.contextTypes</code> (Setter?)를 할당할 때 사이드 이펙트가 있나요?</p> <p>Terser는 알아내려고 노력하지만 여러 상황에서 장담할 수는 없습니다. 이것은 terser가 알아낼 수 없기 때문에, terser가 역할을 잘 수행하지 못한다는 것이 아닙니다. JavaScript 같은 동적 언어에서 확실하게 판단하는 것은 매우 어렵습니다.</p> <p>그러나 <code>/*#__PURE__*/</code> 어노테이션을 이용하여 terser를 도와줄 수 있습니다. 그 구문은 사이드 이펙트가 없는 것으로 표시합니다. 그래서 간단한 변경만으로 코드를 tree-shake 할 수 있습니다.</p> <pre><code class="hljs language-javascript"><span class="token keyword">var</span> Button$<span class="token number">1</span> <span class="token operator">=</span> <span class="token comment">/*#__PURE__*/</span> <span class="token function">withAppProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>Button<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p>이렇게 하면 이 코드를 제거 할 수 있습니다. 그러나 포함되어야 하거나 평가가 필요한 import는 사이드 이펙트가 있을 수 있기 때문에 여전히 이에 대한 문제가 남아 있습니다.</p> <p>이 문제를 해결하기 위해 <code>package.json</code>의 <a href="/guides/tree-shaking/#mark-the-file-as-side-effect-free"><code>"sideEffects"</code></a> 프로퍼티를 사용합니다.</p> <p>이것은 <code>/*#__PURE__*/</code>와 비슷하지만, 구문 레벨이 아닌 모듈 레벨에서 사용합니다. <code>"sideEffects"</code> 프로퍼티에 대해 "sideEffect가 없다고 플래그된 모듈에서 직접적인 export가 없는 경우 번들러는 사이드 이펙트에 대한 평가를 건너 뛸 수 있다."라고 설명하고 있습니다.</p> <p>Shopify's Polaris 예시에서 원래 모듈은 다음과 같습니다.</p> <p><strong>index.js</strong></p> <pre><code class="hljs language-javascript"><span class="token keyword">import</span> <span class="token string">'./configure'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">'./types'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">'./components'</span><span class="token punctuation">;</span></code></pre> <p><strong>components/index.js</strong></p> <pre><code class="hljs language-javascript"><span class="token comment">// ...</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> <span class="token keyword">default</span> <span class="token keyword">as</span> Breadcrumbs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./Breadcrumbs'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> <span class="token keyword">default</span> <span class="token keyword">as</span> Button<span class="token punctuation">,</span> buttonFrom<span class="token punctuation">,</span> buttonsFrom <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./Button'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> <span class="token keyword">default</span> <span class="token keyword">as</span> ButtonGroup <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./ButtonGroup'</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span></code></pre> <p><strong>package.json</strong></p> <pre><code class="hljs language-json"><span class="token comment">// ...</span>
<span class="token property">"sideEffects"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token string">"**/*.css"</span><span class="token punctuation">,</span>
  <span class="token string">"**/*.scss"</span><span class="token punctuation">,</span>
  <span class="token string">"./esnext/index.js"</span><span class="token punctuation">,</span>
  <span class="token string">"./esnext/configure.js"</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token comment">// ...</span></code></pre> <p><code>import { Button } from "@shopify/polaris";</code>는 다음과 같이 동작합니다.</p> <ul> <li>포함: 모듈을 포함하고 평가하며 계속 의존성을 분석합니다.</li> <li>건너뛰기: 포함하지 않으며 평가하지 않으나 계속 의존성을 평가합니다.</li> <li>제외: 포함하지 않으며 평가하지 않고 의존성도 분석하지 않습니다.</li> </ul> <p>매칭되는 리소스별로 자세히 보겠습니다.</p> <ul> <li><code>index.js</code>: 직접 export하여 사용하진 않지만 sideEffect의 플래그는 사용 -> 포함</li> <li><code>configure.js</code>: export하여 사용되지 않지만 sideEffect의 플래그는 사용 -> 포함</li> <li><code>types/index.js</code>: export하여 사용되지 않고 sideEffect로 플래그도 사용하지 않음 -> 제외</li> <li><code>components/index.js</code>: 직접 export하여 사용하지 않고 sideEffect로 플래그도 사용하지 않음, 그러나 다시 export한 export는 사용됨 -> 건너 뜀</li> <li><code>components/Breadcrumbs.js</code>: export하여 사용되지 않고 sideEffect로 플래그도 사용하지 않음 -> 제외 sideEffect 플래그가 있더라도 <code>components/Breadcrumbs.css</code>와 같은 모든 의존성은 제외됩니다.</li> <li><code>components/Button.js</code>: 직접 export를 사용하고 sideEffect 플래그는 사용하지 않음 -> 포함</li> <li><code>components/Button.css</code>: 직접 export를 사용하지 않지만 sideEffect 플래그는 사용함 ->포함</li> </ul> <p>위의 경우에 4개 모듈만 번들에 포함됩니다.</p> <ul> <li><code>index.js</code>: 거의 없음</li> <li><code>configure.js</code></li> <li><code>components/Button.js</code></li> <li><code>components/Button.css</code></li> </ul> <p>이 최적화 후, 다른 최적화도 적용할 수 있습니다. 예를 들면, <code>buttonFrom</code>과 <code>Button.js</code>에서 export하는 <code>buttonsFrom</code>은 사용되지 않습니다. <code>usedExports</code> 최적화는 이를 알아채고 terser는 모듈에서 일부 명령문을 삭제할 수 있습니다.</p> <p>모듈의 연결에도 적용됩니다. 따라서 이 4개의 모듈과 엔트리 모듈(그리고 아마도 좀 더 많은 의존성)을 연결할 수 있습니다. <strong>결국 <code>index.js</code>에는 생성되는 코드가 없습니다.</strong></p> <h2 id="mark-a-function-call-as-side-effect-free">Mark a function call as side-effect-free<a href="#mark-a-function-call-as-side-effect-free" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>/*#__PURE__*/</code>어노테이션을 사용하여 해당 함수 호출이 사이드 이펙트가 없다(side-effect-free)(순수하다)는 것을 webpack에 알릴 수 있습니다. 함수 호출 앞에 추가하여 사이드 이펙트가 없는 것으로 표시할 수 있습니다. 함수에 전달된 인수는 어노테이션으로 표시되지 않고 개별적으로 표시해야 할 수 있습니다. 사용하지 않는 변수의 초기값이 사이드 이펙트가 없다(순수하다)면, 사용하지 않는 코드로 표시되고 실행되지 않으며 최소화할 때 삭제됩니다. 이런 동작은 <a href="/configuration/optimization/#optimizationinnergraph"><code>optimization.innerGraph</code></a>가 <code>true</code> 일 때 활성화됩니다.</p> <p><strong>file.js</strong></p> <pre><code class="hljs language-javascript"><span class="token comment">/*#__PURE__*/</span> <span class="token function">double</span><span class="token punctuation">(</span><span class="token number">55</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <h2 id="minify-the-output">Minify the Output<a href="#minify-the-output" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>import</code>와 <code>export</code> 구문을 통해 "사용하지 않는 코드"를 삭제했습니다. 하지만 번들에서도 삭제해야 합니다. 이렇게 하려면 <code>mode</code> 옵션을 <a href="/configuration/mode/#mode-production"><code>production</code></a>으로 설정해야 합니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff">const path = require('path');

module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line"> output: {
</span><span class="token prefix unchanged"> </span><span class="token line">   filename: 'bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> mode: 'development',
</span><span class="token prefix deleted">-</span><span class="token line"> optimization: {
</span><span class="token prefix deleted">-</span><span class="token line">   usedExports: true,
</span><span class="token prefix deleted">-</span><span class="token line"> }
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> mode: 'production',
</span></span>};</code></pre> <aside class="tip"><h6 class="tip__prefix">tip</h6><p><code>--optimize-minimize</code> 플래그를 사용하여 <code>TerserPlugin</code>도 활성화 할 수 있습니다.</p></aside> <p>즉, 다른 <code>npm run build</code>를 실행하고 변경된 사항이 있는지 볼 수 있습니다.</p> <p><code>dist/bundle.js</code>에서 다른 점을 찾았나요? 정확하게 전체 번들이 최소화되고 난독화 되었지만, 자세히 보면 포함되어 있던 <code>square</code> 함수가 없으며 난독화 된 <code>cube</code> 함수 (<code>function r(e){return e*e*e}n.a=r</code>)를 볼 수 있습니다. 최소화와 tree shaking으로 번들은 이제 몇 바이트 더 작아졌습니다! 위의 임의로 만든 예제에서는 큰 변화를 느끼지 못하겠지만 tree shaking은 복잡한 의존성 트리가 있는 커다란 애플리케이션에서 작업할 때 번들의 크기를 많이 줄일 수 있습니다.</p> <aside class="tip"><h6 class="tip__prefix">tip</h6><p><a href="/plugins/module-concatenation-plugin/"><code>ModuleConcatenationPlugin</code></a>은 tree shaking이 동작하기 위해 필요합니다. <code>mode: 'production'</code>에 의해 추가됩니다. 만약 사용하지 않는다면, <a href="/plugins/module-concatenation-plugin/"><code>ModuleConcatenationPlugin</code></a>을 수동으로 추가해야 합니다.</p></aside> <h2 id="conclusion-5">Conclusion<a href="#conclusion-5" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>그래서 <em>tree shaking의</em> 이점을 살리기 위하여</p> <ul> <li>ES2015 모듈 구문을 사용해야 하는 것을 배웠습니다. (예: <code>import</code>와 <code>export</code>)</li> <li>컴파일러가 ES2015 모듈 구문을 CommonJS 모듈로 변환하지 않도록 해야 합니다. (이것은 인기 있는 Babel preset @babel/preset-env의 기본 동작입니다. 자세한 내용은 <a href="https://babeljs.io/docs/en/babel-preset-env#modules">documentation</a>를 참고하세요.)</li> <li><code>package.json</code> 파일에 <code>"sideEffects"</code> 속성을 추가하세요.</li> <li>최소화와 tree shaking을 포함한 <a href="/configuration/mode/#usage">다양한 최적화를</a> 사용하려면 <a href="/configuration/mode/#mode-production"><code>production</code></a> <code>mode</code> 설정 옵션을 사용하세요.</li> </ul> <p>애플리케이션을 나무와 같이 생각할 수 있습니다. 실제로 사용되는 소스 코드와 라이브러리는 나무의 살아있는 잎과 같은 녹색을 나타냅니다. 사용하지 않는 코드는 가을에 바싹 마른 나무의 죽은 잎사귀처럼 갈색입니다. 낙엽을 없애기 위해서 나무를 흔들어서 낙엽을 떨어 뜨려야 합니다.</p> <p>산출물에 대한 최적화에 더 관심이 있다면 <a href="/guides/production">production</a>을 빌드하기 위한 상세 가이드로 이동하세요.</p> <h1 id="production-1">Production<a href="#production-1" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p>이 가이드에서 프로덕션 사이트나 애플리케이션을 구축하기 위한 유틸리티와 좋은 사례들에 대해서 자세히 알아보겠습니다.</p> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>이 연습은 <a href="/guides/tree-shaking">Tree shaking</a>과 <a href="/guides/development">Development</a>에서 시작합니다. 계속하기 전에 해당 가이드에 소개된 콘셉트 및 설정을 잘 알고 있어야 합니다.</p></aside> <h2 id="setup-1">Setup<a href="#setup-1" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><em>development와</em> <em>production의</em> 빌드 목표는 매우 다릅니다. <em>development</em> 에서는 강력한 소스 매핑, localhost 서버에서는 라이브 리로딩이나 hot module replacement 기능을 원합니다. <em>production에서의</em> 목표는 로드 시간을 줄이기 위해 번들 최소화, 가벼운 소스맵 및 애셋 최적화에 초점을 맞추는 것으로 변경됩니다. 논리적으로 분리를 해야 하면 일반적으로 환경마다 <strong>webpack 설정을 분리하여</strong> 작성하는 것이 좋습니다.</p> <p><em>production과</em> <em>development에</em> 관련된 부분을 분리하더라도, 중복을 제거하기 위해 "공통"의 설정은 계속 유지해야 합니다. 이러한 설정을 합치기 위해 <a href="https://github.com/survivejs/webpack-merge"><code>webpack-merge</code></a> 유틸리티를 사용합니다. "공통"의 설정을 사용하면 환경별 설정에서 코드를 복사하지 않아도 됩니다.</p> <p><code>webpack-merge</code>를 설치하고 이전 가이드에서 이미 작업 한 부분을 분리하겠습니다.</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev webpack-merge</code></pre> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> webpack-demo
</span><span class="token prefix unchanged"> </span><span class="token line"> |- package.json
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> |- webpack.config.js
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> |- webpack.common.js
</span><span class="token prefix inserted">+</span><span class="token line"> |- webpack.dev.js
</span><span class="token prefix inserted">+</span><span class="token line"> |- webpack.prod.js
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- /dist
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /src
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.js
</span><span class="token prefix unchanged"> </span><span class="token line">   |- math.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /node_modules</span></span></code></pre> <p><strong>webpack.common.js</strong></p> <pre><code class="hljs language-diff"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> const path = require('path');
</span><span class="token prefix inserted">+</span><span class="token line"> const HtmlWebpackPlugin = require('html-webpack-plugin');
</span><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line"> module.exports = {
</span><span class="token prefix inserted">+</span><span class="token line">   entry: {
</span><span class="token prefix inserted">+</span><span class="token line">     app: './src/index.js',
</span><span class="token prefix inserted">+</span><span class="token line">   },
</span><span class="token prefix inserted">+</span><span class="token line">   plugins: [
</span><span class="token prefix inserted">+</span><span class="token line">     new HtmlWebpackPlugin({
</span><span class="token prefix inserted">+</span><span class="token line">       title: 'Production',
</span><span class="token prefix inserted">+</span><span class="token line">     }),
</span><span class="token prefix inserted">+</span><span class="token line">   ],
</span><span class="token prefix inserted">+</span><span class="token line">   output: {
</span><span class="token prefix inserted">+</span><span class="token line">     filename: '[name].bundle.js',
</span><span class="token prefix inserted">+</span><span class="token line">     path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix inserted">+</span><span class="token line">     clean: true,
</span><span class="token prefix inserted">+</span><span class="token line">   },
</span><span class="token prefix inserted">+</span><span class="token line"> };</span></span></code></pre> <p><strong>webpack.dev.js</strong></p> <pre><code class="hljs language-diff"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> const { merge } = require('webpack-merge');
</span><span class="token prefix inserted">+</span><span class="token line"> const common = require('./webpack.common.js');
</span><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line"> module.exports = merge(common, {
</span><span class="token prefix inserted">+</span><span class="token line">   mode: 'development',
</span><span class="token prefix inserted">+</span><span class="token line">   devtool: 'inline-source-map',
</span><span class="token prefix inserted">+</span><span class="token line">   devServer: {
</span><span class="token prefix inserted">+</span><span class="token line">     contentBase: './dist',
</span><span class="token prefix inserted">+</span><span class="token line">   },
</span><span class="token prefix inserted">+</span><span class="token line"> });</span></span></code></pre> <p><strong>webpack.prod.js</strong></p> <pre><code class="hljs language-diff"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> const { merge } = require('webpack-merge');
</span><span class="token prefix inserted">+</span><span class="token line"> const common = require('./webpack.common.js');
</span><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line"> module.exports = merge(common, {
</span><span class="token prefix inserted">+</span><span class="token line">   mode: 'production',
</span><span class="token prefix inserted">+</span><span class="token line"> });</span></span></code></pre> <p><code>webpack.common.js</code>에서 <code>entry</code>와 <code>output</code>을 설정했으며, 두 환경에서 필요한 플러그인들을 포함했습니다. <code>webpack.dev.js</code>에서 <code>mode</code>를 <code>development</code>으로 설정했습니다. 또한, 해당 환경에 권장(강력한 소스 매핑)되는 <code>devtool</code>과 간단한 <code>devServer</code> 설정을 추가했습니다. 마지막으로 <code>webpack.prod.js</code>에 <code>mode</code>를 <a href="/guides/tree-shaking/">Tree shaking</a> 가이드에서 처음 언급했던 <a href="/plugins/terser-webpack-plugin/"><code>TerserPlugin</code></a>을 로드하기 위해 <code>production</code>으로 설정 합니다.</p> <p>환경별 설정에서 <code>merge()</code>를 사용하여 호출하면 <code>webpack.dev.js</code> 및 <code>webpack.prod.js</code>에 공통 설정을 포함합니다. <code>webpack-merge</code> 툴은 병합을 위한 다양한 고급 기능을 제공하지만, 지금 사례에서는 이런 기능이 필요하지 않습니다.</p> <h2 id="npm-scripts-1">NPM Scripts<a href="#npm-scripts-1" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>지금부터 새로운 설정 파일을 사용하기 위해 npm 스크립트를 수정해 보겠습니다. <code>webpack-dev-server</code>를 실행하는 <code>start</code> 스크립트의 경우 <code>webpack.dev.js</code>를 사용하고, 프로덕션 빌드를 만들기 위해 <code>webpack</code>을 실행하는 <code>build</code> 스크립트의 경우 <code>webpack.prod.js</code>를 사용합니다.</p> <p><strong>package.json</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> {
</span><span class="token prefix unchanged"> </span><span class="token line">   "name": "development",
</span><span class="token prefix unchanged"> </span><span class="token line">   "version": "1.0.0",
</span><span class="token prefix unchanged"> </span><span class="token line">   "description": "",
</span><span class="token prefix unchanged"> </span><span class="token line">   "main": "src/index.js",
</span><span class="token prefix unchanged"> </span><span class="token line">   "scripts": {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">     "start": "webpack serve --open",
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     "start": "webpack serve --open --config webpack.dev.js",
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">     "build": "webpack"
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     "build": "webpack --config webpack.prod.js"
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   "keywords": [],
</span><span class="token prefix unchanged"> </span><span class="token line">   "author": "",
</span><span class="token prefix unchanged"> </span><span class="token line">   "license": "ISC",
</span><span class="token prefix unchanged"> </span><span class="token line">   "devDependencies": {
</span><span class="token prefix unchanged"> </span><span class="token line">     "css-loader": "^0.28.4",
</span><span class="token prefix unchanged"> </span><span class="token line">     "csv-loader": "^2.1.1",
</span><span class="token prefix unchanged"> </span><span class="token line">     "express": "^4.15.3",
</span><span class="token prefix unchanged"> </span><span class="token line">     "file-loader": "^0.11.2",
</span><span class="token prefix unchanged"> </span><span class="token line">     "html-webpack-plugin": "^2.29.0",
</span><span class="token prefix unchanged"> </span><span class="token line">     "style-loader": "^0.18.2",
</span><span class="token prefix unchanged"> </span><span class="token line">     "webpack": "^4.30.0",
</span><span class="token prefix unchanged"> </span><span class="token line">     "webpack-dev-middleware": "^1.12.0",
</span><span class="token prefix unchanged"> </span><span class="token line">     "webpack-dev-server": "^2.9.1",
</span><span class="token prefix unchanged"> </span><span class="token line">     "webpack-merge": "^4.1.0",
</span><span class="token prefix unchanged"> </span><span class="token line">     "xml-loader": "^1.2.1"
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }</span></span></code></pre> <p><em>production</em> 설정을 계속 추가하는대로 출력이 어떻게 변경되는지 위 스크립트를 자유롭게 실행하여 확인해보세요.</p> <h2 id="specify-the-mode">Specify the Mode<a href="#specify-the-mode" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>많은 라이브러리는 <code>process.env.NODE_ENV</code> 변수를 이용하여 어떤 라이브러리를 포함해야 하는지 결정합니다. 예를 들어 <code>process.env.NODE_ENV</code>가 <code>'production'</code>으로 설정되지 않으면 몇몇 라이브러리는 디버깅의 편의성을 위해 로그 및 테스트를 추가할 수도 있습니다. 그러나 <code>process.env.NODE_ENV</code>가 <code>'production'</code>으로 설정되어 있으면 실제 사용자의 작업 실행 방식을 최적화 하기 위해 코드의 중요한 부분을 추가하거나 삭제 할 수 있습니다. webpack v4부터 <a href="/configuration/mode/"><code>mode</code></a>를 지정하면 <a href="/plugins/define-plugin"><code>DefinePlugin</code></a>이 자동으로 설정됩니다.</p> <p><strong>webpack.prod.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const { merge } = require('webpack-merge');
</span><span class="token prefix unchanged"> </span><span class="token line"> const common = require('./webpack.common.js');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module.exports = merge(common, {
</span><span class="token prefix unchanged"> </span><span class="token line">   mode: 'production',
</span><span class="token prefix unchanged"> </span><span class="token line"> });</span></span></code></pre> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>기술적으로 <code>NODE_ENV</code>는 Node.js가 실행 중인 스크립트가 참고할 수 있는 시스템 환경 변수입니다. 이것은 서버 툴, 빌드 스크립트 및 클라이언트 라이브러리에 의한 dev-vs-prod의 동작을 결정하는 규칙에 사용됩니다. 예상과 달리 <code>process.env.NODE_ENV</code>는 빌드 스크립트인 <code>webpack.config.js</code> <strong>안에서</strong> <code>'production'</code>으로 설정되지 않습니다. <a href="https://github.com/webpack/webpack/issues/2537">#2537</a>을 참조해 주세요. 따라서 다음과 같은 조건은 <code>process.env.NODE_ENV === 'production' ? '[name].[contenthash].bundle.js' : '[name].bundle.js'</code> webpack 설정에서 예상대로 동작하지 않습니다.</p></aside> <p><a href="https://reactjs.org/"><code>react</code></a>와 같은 라이브러리를 사용한다면 <code>DefinePlugin</code>을 추가한 후에 명확하게 번들 크기가 줄어야 합니다. 또한 로컬 <code>/src</code>의 코드 역시 제어 할 수 있습니다. 따라서 다음 검사는 유효합니다.</p> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> import { cube } from './math.js';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line"> if (process.env.NODE_ENV !== 'production') {
</span><span class="token prefix inserted">+</span><span class="token line">   console.log('Looks like we are in development mode!');
</span><span class="token prefix inserted">+</span><span class="token line"> }
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">   const element = document.createElement('pre');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   element.innerHTML = [
</span><span class="token prefix unchanged"> </span><span class="token line">     'Hello webpack!',
</span><span class="token prefix unchanged"> </span><span class="token line">     '5 cubed is equal to ' + cube(5)
</span><span class="token prefix unchanged"> </span><span class="token line">   ].join('\n\n');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   return element;
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> document.body.appendChild(component());</span></span></code></pre> <h2 id="minification">Minification<a href="#minification" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>webpack v4+의 <a href="/configuration/mode/#mode-production"><code>production mode</code></a>에서는 기본으로 코드를 최소화합니다.</p> <p><a href="/plugins/terser-webpack-plugin/"><code>TerserPlugin</code></a>은 최소화를 시작하고 기본으로 사용하기에 좋지만 다른 옵션도 있습니다.</p> <ul> <li><a href="https://github.com/webpack-contrib/closure-webpack-plugin"><code>ClosureWebpackPlugin</code></a></li> </ul> <p>만약 다른 최소화 플러그인을 사용하기로 결정했다면, 다른 플러그인이 <a href="/guides/tree-shaking">Tree shaking</a> 가이드에 설명 된 대로 사용하지 않는 코드를 제거하고 <a href="/configuration/optimization/#optimizationminimizer"><code>optimization.minimizer</code></a>를 제공하는지 확인해야 합니다.</p> <h2 id="source-mapping">Source Mapping<a href="#source-mapping" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>소스맵은 디버깅뿐만 아니라 벤치마크 테스트에도 유용하므로 프로덕션에도 활성화하는 것이 좋습니다. 즉, 프로덕션용으로 추천되는 빌드 속도가 가장 빠른 것을 선택해야 합니다. (<a href="/configuration/devtool"><code>devtool</code></a> 참조) 이 가이드에서는 <em>development에서</em> 사용한 <code>inline-source-map</code>이 아닌 <em>production의</em> <code>source-map</code>을 사용합니다.</p> <p><strong>webpack.prod.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const { merge } = require('webpack-merge');
</span><span class="token prefix unchanged"> </span><span class="token line"> const common = require('./webpack.common.js');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module.exports = merge(common, {
</span><span class="token prefix unchanged"> </span><span class="token line">   mode: 'production',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   devtool: 'source-map',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> });</span></span></code></pre> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>프로덕션에서 <code>inline-***</code>과 <code>eval-***</code>은 번들 크기가 커질 수 있으므로 전체 성능을 향상을 위해 사용하지 않습니다.</p></aside> <h2 id="minimize-css">Minimize CSS<a href="#minimize-css" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>프로덕션을 위해 CSS를 최소화하는 것이 중요합니다. <a href="/plugins/mini-css-extract-plugin/#minimizing-for-production">Minimizing for Production</a>을 참고하세요.</p> <h2 id="cli-alternatives">CLI Alternatives<a href="#cli-alternatives" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>위에서 설명한 대부분의 옵션은 커맨드 라인 인자로 설정할 수 있습니다. 예를 들어 <a href="/configuration/optimization/#optimizationminimize"><code>optimization.minimize은</code></a> <code>--optimization-minimize</code>, 그리고 <a href="/configuration/mode/"><code>mode는</code></a> <code>--mode</code>로 설정할 수 있습니다. CLI 인자의 전체 목록을 보려면 <code>npx webpack --help=verbose</code>를 실행하세요.</p> <p>이런 간단한 방식은 편리하지만, 좀 더 알맞은 설정을 위해 webpack 설정 파일에서 이런 옵션을 설정하는 것이 좋습니다.</p> <h1 id="lazy-loading">Lazy Loading<a href="#lazy-loading" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>이 가이드는 <a href="/guides/code-splitting">코드 스플리팅</a>에 대한 작은 후속 작업입니다. 해당 가이드를 아직 읽지 않았다면, 지금 읽어보세요.</p></aside> <p>지연 로딩 또는 "온 디맨드" 로딩은 사이트나 애플리케이션을 최적화하는 좋은 방법입니다. 이 방법은 기본적으로 논리적인 중단점에서 코드를 분할한 다음 유저가 새로운 코드 블록을 요구하거나 필요로 하는 작업을 수행한 후 코드를 로딩하는 것입니다. 이렇게 하면 애플리케이션의 초기 로드 속도가 빨라지고 일부 블록이 로드되지 않을 수도 있어서 전체 무게가 줄어 듭니다.</p> <h2 id="example">Example<a href="#example" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><a href="/guides/code-splitting/#dynamic-imports">코드 스플리팅</a>의 예제를 가져와 이 개념을 더욱 잘 보여주기 위해 약간 수정해 보겠습니다. 이 코드는 별도의 청크인 <code>lodash.bundle.js</code>를 생성하고 스크립트가 실행되자마자 기술적으로 "지연 로드"됩니다. 문제는 번들을 로드하는데 유저 상호 작용이 필요하지 않다는 것입니다. 즉, 페이지가 로드 될 때마다 요청이 실행됩니다. 이것은 우리에게 큰 도움이 되지 않고 성능에 부정적인 영향을 미치게 됩니다.</p> <p>다른 것을 시도해 봅시다. 유저가 버튼을 클릭 할 때 일부 텍스트를 콘솔에 기록하는 상호 작용을 추가합니다. 그러나 (<code>print.js</code>)를 로드하는 동안 처음 상호작용이 발생하기까지 기다려보겠습니다. 이를 위해 다시 돌아가서 <em>코드 스플리팅의</em> <a href="/guides/code-splitting/#dynamic-imports">final <em>Dynamic Imports</em> 예제를</a> 다시 작업하고 메인 청크에 <code>lodash</code>를 남겨 둡니다.</p> <p><strong>프로젝트</strong></p> <pre><code class="hljs language-diff">webpack-demo
|- package.json
|- webpack.config.js
|- /dist
|- /src
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- index.js
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> |- print.js
</span></span>|- /node_modules</code></pre> <p><strong>src/print.js</strong></p> <pre><code class="hljs language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
  <span class="token string">'The print.js module has loaded! See the network tab in dev tools...'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Button Clicked: Here\'s "some text"!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> import _ from 'lodash';
</span><span class="token prefix inserted">+</span><span class="token line">
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> async function getComponent() {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> function component() {
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   const element = document.createElement('div');
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">   const _ = await import(/* webpackChunkName: "lodash" */ 'lodash');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   const button = document.createElement('button');
</span><span class="token prefix inserted">+</span><span class="token line">   const br = document.createElement('br');
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   button.innerHTML = 'Click me and look at the console!';
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   element.appendChild(br);
</span><span class="token prefix inserted">+</span><span class="token line">   element.appendChild(button);
</span><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line">   // Note that because a network request is involved, some indication
</span><span class="token prefix inserted">+</span><span class="token line">   // of loading would need to be shown in a production-level site/app.
</span><span class="token prefix inserted">+</span><span class="token line">   button.onclick = e => import(/* webpackChunkName: "print" */ './print').then(module => {
</span><span class="token prefix inserted">+</span><span class="token line">     const print = module.default;
</span><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line">     print();
</span><span class="token prefix inserted">+</span><span class="token line">   });
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   return element;
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>
<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> getComponent().then(component => {
</span><span class="token prefix deleted">-</span><span class="token line">   document.body.appendChild(component);
</span><span class="token prefix deleted">-</span><span class="token line"> });
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> document.body.appendChild(component());</span></span></code></pre> <aside class="warning"><h6 class="warning__prefix">warning</h6><p>ES6 모듈에서 <code>import()</code> 를 사용할 때 promise가 해결 될 때 반환되는 실제 <code>module</code> 객체이므로 <code>.default</code> 속성을 참조해야 합니다.</p></aside> <p>이제 webpack을 실행하고 새로운 지연 로딩 기능을 확인해 보겠습니다.</p> <pre><code class="hljs language-bash"><span class="token punctuation">..</span>.
          Asset       Size  Chunks                    Chunk Names
print.bundle.js  <span class="token number">417</span> bytes       <span class="token number">0</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>         print
index.bundle.js     <span class="token number">548</span> kB       <span class="token number">1</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  <span class="token punctuation">[</span>big<span class="token punctuation">]</span>  index
     index.html  <span class="token number">189</span> bytes          <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>
<span class="token punctuation">..</span>.</code></pre> <h2 id="frameworks">Frameworks<a href="#frameworks" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>많은 프레임워크와 라이브러리에는 방법론 안에서 구현하는 방법에 대한 자체 권고안이 있습니다. 다음은 몇 가지 예시입니다.</p> <ul> <li>React: <a href="https://reacttraining.com/react-router/web/guides/code-splitting">Code Splitting and Lazy Loading</a></li> <li>Vue: <a href="https://vuedose.tips/tips/dynamic-imports-in-vue-js-for-better-performance/">Dynamic Imports in Vue.js for better performance</a></li> <li>Angular: <a href="https://angular.io/guide/router#milestone-6-asynchronous-routing">Lazy Loading route configuration</a> 그리고 <a href="https://medium.com/@var_bin/angularjs-webpack-lazyload-bb7977f390dd">AngularJS + webpack = lazyLoad</a></li> </ul> <h1 id="ecmascript-modules">ECMAScript Modules<a href="#ecmascript-modules" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p>ECMAScript 모듈(ESM)은 웹에서 모듈을 사용하기 위한 <a href="https://tc39.github.io/ecma262/#sec-modules">사양</a>입니다. 모든 최신 브라우저와 권장하는 웹 모듈 코드 작성법에서 지원됩니다.</p> <p>webpack은 ECMAScript 모듈을 최적화하기 위한 처리를 지원했습니다.</p> <h2 id="exporting">Exporting<a href="#exporting" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>export</code> 키워드를 사용하면 ESM 항목을 다른 모듈에 노출할 수 있습니다.</p> <pre><code class="hljs language-js"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">CONSTANT</span> <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">let</span> variable <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>
<span class="token comment">// 오직 읽는 값만 노출됩니다.</span>
<span class="token comment">// 외부에서 변수를 수정할 수 없습니다.</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'fun'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">C</span> <span class="token keyword">extends</span> <span class="token class-name">Super</span> <span class="token punctuation">{</span>
  <span class="token function">method</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'method'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> other<span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> other <span class="token keyword">as</span> c <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">+</span> <span class="token function">more</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <h2 id="importing">Importing<a href="#importing" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>import</code> 키워드를 사용하면 다른 모듈에 대한 참조를 ESM으로 가져올 수 있습니다.</p> <pre><code class="hljs language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">CONSTANT</span><span class="token punctuation">,</span> variable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./module.js'</span><span class="token punctuation">;</span>
<span class="token comment">// 다른 모듈에 export하기 위해 "bindings"를 가져옵니다.</span>
<span class="token comment">// 바인딩은 활성상태입니다. 값은 복사되지 않습니다.</span>
<span class="token comment">// 대신 "변수"에 접근하면 현재 값을 얻습니다.</span>
<span class="token comment">// 가져온 모듈에서</span>

<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> module <span class="token keyword">from</span> <span class="token string">'./module.js'</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 모든 export를 가지는 "네임스페이스 객체"를 가져옵니다.</span>

<span class="token keyword">import</span> theDefaultValue <span class="token keyword">from</span> <span class="token string">'./module.js'</span><span class="token punctuation">;</span>
<span class="token comment">// "기본" export를 가져오는 단축입니다.</span></code></pre> <h2 id="flagging-modules-as-esm">Flagging modules as ESM<a href="#flagging-modules-as-esm" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>기본적으로 webpack은 파일이 ESM인지 또는 다른 모듈 시스템인지 자동으로 감지합니다.</p> <p>Node.js는 <code>package.json</code>의 속성을 사용하여 파일의 모듈 유형을 명시적으로 설정하는 방법을 확립했습니다. package.json에서 <code>"type": "module"</code>을 설정하면 package.json 아래의 모든 파일이 ECMAScript 모듈이 됩니다. <code>"type": "commonjs"</code>를 설정하면 CommonJS 모듈이 됩니다.</p> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"module"</span>
<span class="token punctuation">}</span></code></pre> <p>또한, 파일은 <code>.mjs</code> 또는 <code>.cjs</code> 확장자를 사용해서 모듈 유형을 설정할 수 있습니다. <code>.mjs</code>는 ESM이 되도록 강제하고, <code>.cjs</code>는 CommonJS가 되도록 강제합니다.</p> <p>DataURIs에서 <code>text/javascript</code> 또는 <code>application/javascript</code> mime 유형을 사용하면 모듈 유형도 ESM으로 강제로 적용됩니다.</p> <p>모듈 형식뿐 아니라 모듈 플래그를 ESM으로 지정하는 것은 로직 해석, interop 로직 및 모듈에서 사용 가능한 심볼에 영향을 줍니다.</p> <p>ESM의 import는 더 엄격하게 해석됩니다. 상대적 요청에는 파일 이름과 파일 확장자가 포함되어야 합니다.</p> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>import "lodash" 같이 패키지에 대한 요청은 여전히 지원됩니다.</p></aside> <p>ESM이 아닌 경우는 "기본" export만 가져올 수 있습니다. 명명된 export를 사용할 수 없습니다.</p> <p><code>require</code>, <code>module</code>, <code>exports</code>, <code>__filename</code>, <code>__dirname</code> 같은 CommonJs 구문을 사용할 수 없습니다.</p> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>HMR은 <a href="/api/module-variables/#modulehot-webpack-specific"><code>module.hot</code></a> 대신 <a href="/api/module-variables/#importmetawebpackhot"><code>import.meta.webpackHot</code></a>과 함께 사용할 수 있습니다.</p></aside> <h1 id="shimming">Shimming<a href="#shimming" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p><code>webpack</code> 컴파일러는 ES2015 모듈, CommonJS 또는 AMD로 작성된 모듈을 이해할 수 있습니다. 그러나 일부 써드 파티 라이브러리는 전역 종속성을 필요로 할 수 있습니다. (예: <code>jQuery</code>의 경우 <code>$</code>) 라이브러리는 내보낼 필요가 있는 전역 변수를 만들 수도 있습니다. 이러한 "깨진 모듈은" <em>shimming이</em> 작동하는 하나의 인스턴스입니다.</p> <aside class="warning"><h6 class="warning__prefix">warning</h6><p><strong>전역 변수를 사용하지 않는 것이 좋습니다!</strong> webpack의 전체 개념은 더 많은 모듈식 프런트엔드 개발을 허용하는 것입니다. 이는 응집도가 높고 숨겨진 종속성(예: 전역 변수)에 의존하지 않는 격리 된 모듈을 작성하는 것을 의미합니다. 그러므로 필요한 경우에만 이 기능을 사용하세요.</p></aside> <p><em>shimming</em> 이 유용한 또 다른 경우는 더 많은 사용자를 지원하기 위해 브라우저 기능을 <a href="https://en.wikipedia.org/wiki/Polyfill_%28programming%29">폴리필</a>하려는 경우입니다. 이 경우 패치가 필요한 브라우저에만 해당 폴리필을 제공할 수 있습니다. (예: 요청 시 로드)</p> <p>해당 글에서는 이러한 두 가지 사용 사례를 모두 살펴봅니다.</p> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>간단하게 시작하기 위해 이 가이드는 <a href="/guides/getting-started">시작하기</a>의 예에서 시작합니다. 계속해서 진행하기에 앞서 설정에 익숙해져야 합니다.</p></aside> <h2 id="shimming-globals">Shimming Globals<a href="#shimming-globals" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>전역 변수 shimming의 첫 번째 사용 사례부터 시작하겠습니다. 시작하기 전에 프로젝트를 다시 한번 살펴보겠습니다.</p> <p><strong>프로젝트</strong></p> <pre><code class="hljs language-diff">webpack-demo
|- package.json
|- webpack.config.js
|- /dist
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- index.html
</span></span>|- /src
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- index.js
</span></span>|- /node_modules</code></pre> <p>우리가 사용했던 <code>lodash</code> 패키지를 기억하시나요? 데모 목적으로 애플리케이션에서 전역적으로 제공하고 싶다고 가정해 보겠습니다. 이를 위해 <code>ProvidePlugin</code>을 사용할 수 있습니다.</p> <p><a href="/plugins/provide-plugin"><code>ProvidePlugin</code></a>은 webpack을 통해 컴파일된 모든 모듈에서 패키지를 변수로 사용할 수 있게 해줍니다. 변수가 사용되는 것을 webpack에서 확인하면 최종 번들에 주어진 패키지를 포함합니다. <code>lodash</code>에 대한 <code>import</code>문을 제거하고 플러그인을 통해 제공해보겠습니다.</p> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">import _ from 'lodash';
</span><span class="token prefix deleted">-</span><span class="token line">
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">  const element = document.createElement('div');
</span></span>
<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  // 이제 이 스크립트로 Lodash를 가져옵니다.
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  return element;
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">document.body.appendChild(component());</span></span></code></pre> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">const webpack = require('webpack');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: 'main.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  plugins: [
</span><span class="token prefix inserted">+</span><span class="token line">    new webpack.ProvidePlugin({
</span><span class="token prefix inserted">+</span><span class="token line">      _: 'lodash',
</span><span class="token prefix inserted">+</span><span class="token line">    }),
</span><span class="token prefix inserted">+</span><span class="token line">  ],
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>여기서 우리가 실질적으로 한 것은 webpack에게 알려주는 것입니다.</p> <blockquote> <p>변수 <code>_</code>의 인스턴스가 하나 이상 존재한다면 <code>lodash</code> 패키지를 포함하고 필요한 모듈에 제공합니다.</p> </blockquote> <p>빌드를 실행해도 동일한 출력이 표시되어야 합니다.</p> <pre><code class="hljs language-bash">$ <span class="token function">npm</span> run build

<span class="token punctuation">..</span>

<span class="token punctuation">[</span>webpack-cli<span class="token punctuation">]</span> Compilation finished
asset main.js <span class="token number">69.1</span> KiB <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span> <span class="token punctuation">[</span>minimized<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: main<span class="token punctuation">)</span> <span class="token number">1</span> related asset
runtime modules <span class="token number">344</span> bytes <span class="token number">2</span> modules
cacheable modules <span class="token number">530</span> KiB
  ./src/index.js <span class="token number">191</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./node_modules/lodash/lodash.js <span class="token number">530</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">2910</span> ms</code></pre> <p>또한 <code>ProvidePlugin</code>에서 "배열 경로"(예: <code>[module, child, ...children?]</code>)를 구성하여 모듈의 일부분만 내보낼 수 있습니다. 호출될 때마다 <code>lodash</code>에서 <code>join</code> 메소드만 제공하고 싶다고 가정해 보겠습니다.</p> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">  const element = document.createElement('div');
</span></span>
<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  element.innerHTML = join(['Hello', 'webpack'], ' ');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  return element;
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">document.body.appendChild(component());</span></span></code></pre> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line">const webpack = require('webpack');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: 'main.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">    new webpack.ProvidePlugin({
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">      _: 'lodash',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      join: ['lodash', 'join'],
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    }),
</span><span class="token prefix unchanged"> </span><span class="token line">  ],
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p><code>lodash</code> 라이브러리의 나머지는 삭제되므로 <a href="/guides/tree-shaking">트리 쉐이킹</a>이 잘 수행됩니다.</p> <h2 id="granular-shimming">Granular Shimming<a href="#granular-shimming" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>일부 레거시 모듈은 <code>this</code>가 <code>window</code> 객체에 의존합니다. <code>index.js</code>를 업데이트해 보겠습니다.</p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">  const element = document.createElement('div');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  element.innerHTML = join(['Hello', 'webpack'], ' ');
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  // `window의` 컨텍스트에 있다고 가정합니다.
</span><span class="token prefix inserted">+</span><span class="token line">  this.alert("Hmmm, this probably isn't a great idea...");
</span><span class="token prefix inserted">+</span><span class="token line">
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  return element;
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">document.body.appendChild(component());</span></span></code></pre> <p>이것은 <code>this</code>가 <code>module.exports</code>와 같은 CommonJS 컨텍스트에서 모듈이 실행될 때 문제가 됩니다. 이 경우 <a href="/loaders/imports-loader/"><code>imports-loader</code></a>를 사용하여 <code>this</code>를 재정의할 수 있습니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line">const webpack = require('webpack');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: 'main.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  module: {
</span><span class="token prefix inserted">+</span><span class="token line">    rules: [
</span><span class="token prefix inserted">+</span><span class="token line">      {
</span><span class="token prefix inserted">+</span><span class="token line">        test: require.resolve('./src/index.js'),
</span><span class="token prefix inserted">+</span><span class="token line">        use: 'imports-loader?wrapper=window',
</span><span class="token prefix inserted">+</span><span class="token line">      },
</span><span class="token prefix inserted">+</span><span class="token line">    ],
</span><span class="token prefix inserted">+</span><span class="token line">  },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">    new webpack.ProvidePlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">      join: ['lodash', 'join'],
</span><span class="token prefix unchanged"> </span><span class="token line">    }),
</span><span class="token prefix unchanged"> </span><span class="token line">  ],
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <h2 id="global-exports">Global Exports<a href="#global-exports" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>라이브러리가 사용자가 사용할 것으로 예상하는 전역 변수를 생성한다고 가정해 보겠습니다. 이를 증명하기 위해 작은 모듈을 추가할 수 있습니다.</p> <p><strong>프로젝트</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> webpack-demo
</span><span class="token prefix unchanged"> </span><span class="token line"> |- package.json
</span><span class="token prefix unchanged"> </span><span class="token line"> |- webpack.config.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /dist
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /src
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.js
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   |- globals.js
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- /node_modules</span></span></code></pre> <p><strong>src/globals.js</strong></p> <pre><code class="hljs language-js"><span class="token keyword">const</span> file <span class="token operator">=</span> <span class="token string">'blah.txt'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> helpers <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">test</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'test something'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">parse</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'parse something'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p>소스 코드에서 이러한 작업을 수행할 수는 없지만, 위에 표시된 코드와 유사한 오래된 라이브러리를 접했을 수 있습니다. 이 경우 <a href="/loaders/exports-loader/"><code>exports-loader</code></a>를 사용하여 해당 전역 변수를 일반 모듈로 내보낼 수 있습니다. 예를 들어 <code>file</code>을 <code>file</code>로, <code>helpers.parse</code>를 <code>parse</code>로 내보내 봅시다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line">const webpack = require('webpack');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: 'main.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  module: {
</span><span class="token prefix unchanged"> </span><span class="token line">    rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">      {
</span><span class="token prefix unchanged"> </span><span class="token line">        test: require.resolve('./src/index.js'),
</span><span class="token prefix unchanged"> </span><span class="token line">        use: 'imports-loader?wrapper=window',
</span><span class="token prefix unchanged"> </span><span class="token line">      },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      {
</span><span class="token prefix inserted">+</span><span class="token line">        test: require.resolve('./src/globals.js'),
</span><span class="token prefix inserted">+</span><span class="token line">        use:
</span><span class="token prefix inserted">+</span><span class="token line">          'exports-loader?type=commonjs&#x26;exports=file,multiple|helpers.parse|parse',
</span><span class="token prefix inserted">+</span><span class="token line">      },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    ],
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">    new webpack.ProvidePlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">      join: ['lodash', 'join'],
</span><span class="token prefix unchanged"> </span><span class="token line">    }),
</span><span class="token prefix unchanged"> </span><span class="token line">  ],
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>이제 엔트리 스크립트(예: <code>src/index.js</code>)에서 <code>const {file, parse} = require('./globals.js');</code>를 사용할 수 있으며 원활하게 작동합니다.</p> <h2 id="loading-polyfills">Loading Polyfills<a href="#loading-polyfills" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>지금까지 논의한 대부분은 레거시 패키지 처리와 관련이 있습니다. 두 번째 주제인 <strong>폴리필로</strong> 넘어가겠습니다.</p> <p>폴리필을 로드하는 방법에는 여러 가지가 있습니다. 예를 들어 <a href="https://babeljs.io/docs/en/babel-polyfill/"><code>babel-polyfill</code></a>을 포함하려면 다음과 같이하면 됩니다.</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save babel-polyfill</code></pre> <p>메인 번들에 포함되도록 <code>import</code> 합니다.</p> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import 'babel-polyfill';
</span><span class="token prefix inserted">+</span><span class="token line">
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">  const element = document.createElement('div');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  element.innerHTML = join(['Hello', 'webpack'], ' ');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  // `window`의 컨텍스트에 있다고 가정합니다.
</span><span class="token prefix unchanged"> </span><span class="token line">  this.alert("Hmmm, this probably isn't a great idea...");
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  return element;
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">document.body.appendChild(component());</span></span></code></pre> <aside class="tip"><h6 class="tip__prefix">tip</h6><p><code>import</code>한 것을 변수에 바인딩하지 않습니다. 이는 폴리필이 나머지 코드 베이스 이전에 자체적으로 실행되는 특정 기능이 존재한다고 가정하기 때문입니다.</p></aside> <p>이 접근 방식은 번들 크기보다 정확성을 우선시합니다. 안전과 견고함을 위해서는 폴리필이나 shim이 <strong>다른 모든 코드보다 먼저</strong> 실행되어야 하므로 동기식으로 로드하거나 모든 앱 코드는 모든 폴리필이나 shim이 로드된 후에 로드해야 합니다. 또한 커뮤니티에는 최신 브라우저에 폴리필이 "필요하지 않다"거나 폴리필이나 shim이 누락된 기능을 추가하는 역할 만한다는 오해가 많이 있습니다. 사실, 가장 최신 브라우저에서도 종종 <em>깨진 구현을 복구</em> 합니다. 따라서 번들 크기 비용이 발생하더라도 모든 폴리필이나 shim을 무조건 동기식으로 로드하는 것이 모범 사례입니다.</p> <p>문제가 해결됐다고 생각하고 위험을 감수하고 싶다면 다음과 같은 방법도 있습니다. <code>import</code>를 새 파일로 이동하고 <a href="https://github.com/github/fetch"><code>whatwg-fetch</code></a> 폴리필을 추가해 보겠습니다.</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save whatwg-fetch</code></pre> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">import 'babel-polyfill';
</span><span class="token prefix deleted">-</span><span class="token line">
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">  const element = document.createElement('div');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  element.innerHTML = join(['Hello', 'webpack'], ' ');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  // `window`의 컨텍스트에 있다고 가정합니다.
</span><span class="token prefix unchanged"> </span><span class="token line">  this.alert("Hmmm, this probably isn't a great idea...");
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  return element;
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">document.body.appendChild(component());</span></span></code></pre> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> webpack-demo
</span><span class="token prefix unchanged"> </span><span class="token line"> |- package.json
</span><span class="token prefix unchanged"> </span><span class="token line"> |- webpack.config.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /dist
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /src
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.js
</span><span class="token prefix unchanged"> </span><span class="token line">   |- globals.js
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   |- polyfills.js
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- /node_modules</span></span></code></pre> <p><strong>src/polyfills.js</strong></p> <pre><code class="hljs language-javascript"><span class="token keyword">import</span> <span class="token string">'babel-polyfill'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'whatwg-fetch'</span><span class="token punctuation">;</span></code></pre> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line">const webpack = require('webpack');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  entry: './src/index.js',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  entry: {
</span><span class="token prefix inserted">+</span><span class="token line">    polyfills: './src/polyfills',
</span><span class="token prefix inserted">+</span><span class="token line">    index: './src/index.js',
</span><span class="token prefix inserted">+</span><span class="token line">  },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    filename: 'main.js',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    filename: '[name].bundle.js',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  module: {
</span><span class="token prefix unchanged"> </span><span class="token line">    rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">      {
</span><span class="token prefix unchanged"> </span><span class="token line">        test: require.resolve('./src/index.js'),
</span><span class="token prefix unchanged"> </span><span class="token line">        use: 'imports-loader?wrapper=window',
</span><span class="token prefix unchanged"> </span><span class="token line">      },
</span><span class="token prefix unchanged"> </span><span class="token line">      {
</span><span class="token prefix unchanged"> </span><span class="token line">        test: require.resolve('./src/globals.js'),
</span><span class="token prefix unchanged"> </span><span class="token line">        use:
</span><span class="token prefix unchanged"> </span><span class="token line">          'exports-loader?type=commonjs&#x26;exports[]=file&#x26;exports[]=multiple|helpers.parse|parse',
</span><span class="token prefix unchanged"> </span><span class="token line">      },
</span><span class="token prefix unchanged"> </span><span class="token line">    ],
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">    new webpack.ProvidePlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">      join: ['lodash', 'join'],
</span><span class="token prefix unchanged"> </span><span class="token line">    }),
</span><span class="token prefix unchanged"> </span><span class="token line">  ],
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>이를 통해 새로운 <code>polyfills.bundle.js</code> 파일을 조건부로 로드하는 로직을 추가 할 수 있습니다. 이 결정을 내리는 방법은 지원 기술과 브라우저에 따라 다릅니다. polyfill이 필요한지 여부를 확인하기 위해 몇 가지 간단한 테스트를 수행합니다.</p> <p><strong>dist/index.html</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">&#x3C;!DOCTYPE html>
</span><span class="token prefix unchanged"> </span><span class="token line">&#x3C;html>
</span><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;head>
</span><span class="token prefix unchanged"> </span><span class="token line">    &#x3C;meta charset="utf-8" />
</span><span class="token prefix unchanged"> </span><span class="token line">    &#x3C;title>Getting Started&#x3C;/title>
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &#x3C;script>
</span><span class="token prefix inserted">+</span><span class="token line">      const modernBrowser = 'fetch' in window &#x26;&#x26; 'assign' in Object;
</span><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line">      if (!modernBrowser) {
</span><span class="token prefix inserted">+</span><span class="token line">        const scriptElement = document.createElement('script');
</span><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line">        scriptElement.async = false;
</span><span class="token prefix inserted">+</span><span class="token line">        scriptElement.src = '/polyfills.bundle.js';
</span><span class="token prefix inserted">+</span><span class="token line">        document.head.appendChild(scriptElement);
</span><span class="token prefix inserted">+</span><span class="token line">      }
</span><span class="token prefix inserted">+</span><span class="token line">    &#x3C;/script>
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;/head>
</span><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;body>
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    &#x3C;script src="main.js">&#x3C;/script>
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &#x3C;script src="index.bundle.js">&#x3C;/script>
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;/body>
</span><span class="token prefix unchanged"> </span><span class="token line">&#x3C;/html></span></span></code></pre> <p>이제 엔트리 스크립트에서 일부 데이터를 가져올 수 있습니다.</p> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">  const element = document.createElement('div');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  element.innerHTML = join(['Hello', 'webpack'], ' ');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  // `window`의 컨텍스트에 있다고 가정합니다.
</span><span class="token prefix unchanged"> </span><span class="token line">  this.alert("Hmmm, this probably isn't a great idea...");
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  return element;
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">document.body.appendChild(component());
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line">fetch('https://jsonplaceholder.typicode.com/users')
</span><span class="token prefix inserted">+</span><span class="token line">  .then((response) => response.json())
</span><span class="token prefix inserted">+</span><span class="token line">  .then((json) => {
</span><span class="token prefix inserted">+</span><span class="token line">    console.log(
</span><span class="token prefix inserted">+</span><span class="token line">      "We retrieved some data! AND we're confident it will work on a variety of browser distributions."
</span><span class="token prefix inserted">+</span><span class="token line">    );
</span><span class="token prefix inserted">+</span><span class="token line">    console.log(json);
</span><span class="token prefix inserted">+</span><span class="token line">  })
</span><span class="token prefix inserted">+</span><span class="token line">  .catch((error) =>
</span><span class="token prefix inserted">+</span><span class="token line">    console.error('Something went wrong when fetching this data: ', error)
</span><span class="token prefix inserted">+</span><span class="token line">  );</span></span></code></pre> <p>빌드를 실행하면 <code>polyfills.bundle.js</code> 파일이 생성되고 브라우저에서 원활하게 동작하게 됩니다. 이 설정은 개선될 수 있지만 실제로 필요한 사용자에게만 폴리필을 제공하는 방법에 대한 좋은 아이디어입니다.</p> <h2 id="further-optimizations">Further Optimizations<a href="#further-optimizations" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>babel-preset-env</code> 패키지는 <a href="https://github.com/browserslist/browserslist">browserslist</a>를 사용하여 브라우저 매트릭스에서 지원되지 않는 항목만 트랜스파일합니다. 이 사전 설정은 <a href="https://babeljs.io/docs/en/babel-preset-env#usebuiltins"><code>useBuiltIns</code></a> 옵션(기본값 <code>false</code>)과 함께 제공되며, 전역 <code>babel-polyfill</code>을 가져오는 것을 <code>import</code> 패턴을 통해 더 세분화 된 기능으로 변환할 수 있습니다.</p> <pre><code class="hljs language-js"><span class="token keyword">import</span> <span class="token string">'core-js/modules/es7.string.pad-start'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'core-js/modules/es7.string.pad-end'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'core-js/modules/web.timers'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'core-js/modules/web.immediate'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'core-js/modules/web.dom.iterable'</span><span class="token punctuation">;</span></code></pre> <p>자세한 내용은 <a href="https://babeljs.io/docs/en/babel-preset-env">babel-preset-env 문서</a>를 참고하세요.</p> <h2 id="node-built-ins">Node Built-Ins<a href="#node-built-ins" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>process</code>와 같은 Node 내장 기능은 특별한 로더나 플러그인을 사용하지 않고도 설정 파일에서 직접 폴리필 할 수 있습니다. 자세한 내용과 예제는 <a href="/configuration/node">node 설정 페이지</a>를 참고하세요.</p> <h2 id="other-utilities">Other Utilities<a href="#other-utilities" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>레거시 모듈을 다룰 때 도움이 될 수 있는 몇 가지 도구가 있습니다.</p> <p>모듈에 AMD/CommonJS 버전이 없고 <code>dist</code>를 포함하려는 경우 <a href="/configuration/module/#modulenoparse"><code>noParse</code></a>에서 플래그를 지정할 수 있습니다. 이렇게하면 webpack이 모듈을 파싱하거나 <code>require()</code> 및 <code>import</code> 문을 해석하지 않고 모듈을 포함하게됩니다. 이 방법은 빌드 성능을 향상시키는데도 사용됩니다.</p> <aside class="warning"><h6 class="warning__prefix">warning</h6><p><code>ProvidePlugin</code>과 같이 AST가 필요한 기능은 동작하지 않습니다.</p></aside> <p>마지막으로 여러 <a href="/concepts/modules">모듈 스타일</a>을 지원하는 모듈이 있습니다. (예: AMD, CommonJS 및 레거시의 조합) 대부분의 경우, 먼저 <code>define</code>을 확인한 다음 일부 코드를 사용하여 속성을 내보냅니다. 이 경우 <a href="/loaders/imports-loader/"><code>imports-loader</code></a>를 통해 <code>additionalCode=var%define%20=%20false;</code>를 설정하여 CommonJS 경로를 강제하는 것이 도움이 될 수 있습니다.</p> <h1 id="typescript-1">TypeScript<a href="#typescript-1" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>이 가이드는 <a href="/guides/getting-started/"><em>시작하기</em></a> 가이드에서 파생했습니다.</p></aside> <p><a href="https://www.typescriptlang.org">TypeScript는</a> 일반 JavaScript로 컴파일되고 타입이 있는 상위 집합입니다. 이 가이드에서는 TypeScript를 webpack과 통합하는 방법에 대해 알아보겠습니다.</p> <h2 id="basic-setup-1">Basic Setup<a href="#basic-setup-1" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>먼저 다음을 실행하여 TypeScript 컴파일러와 로더를 설치하세요.</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev typescript ts-loader</code></pre> <p>이제 디렉터리 구조와 설정 파일을 수정합니다.</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> webpack-demo
</span><span class="token prefix unchanged"> </span><span class="token line"> |- package.json
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> |- tsconfig.json
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- webpack.config.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /dist
</span><span class="token prefix unchanged"> </span><span class="token line">   |- bundle.js
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.html
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /src
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.js
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   |- index.ts
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- /node_modules</span></span></code></pre> <p><strong>tsconfig.json</strong></p> <p>JSX를 지원하도록 간단하게 설정하고 TypeScript를 ES5로 컴파일 합니다.</p> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"outDir"</span><span class="token operator">:</span> <span class="token string">"./dist/"</span><span class="token punctuation">,</span>
    <span class="token property">"noImplicitAny"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"es6"</span><span class="token punctuation">,</span>
    <span class="token property">"target"</span><span class="token operator">:</span> <span class="token string">"es5"</span><span class="token punctuation">,</span>
    <span class="token property">"jsx"</span><span class="token operator">:</span> <span class="token string">"react"</span><span class="token punctuation">,</span>
    <span class="token property">"allowJs"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"moduleResolution"</span><span class="token operator">:</span> <span class="token string">"node"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <p><code>tsconfig.json</code> 설정 옵션에 대한 자세한 내용은 <a href="https://www.typescriptlang.org/docs/handbook/tsconfig-json.html">TypeScript 문서를</a> 참고하세요.</p> <p>webpack 설정에 대한 자세한 내용은 <a href="/concepts/configuration/">설정 콘셉트를</a> 참고하세요.</p> <p>이제 TypeScript를 처리하도록 webpack을 설정해 보겠습니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token string">'./src/index.ts'</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex">/\.tsx?$/</span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token string">'ts-loader'</span><span class="token punctuation">,</span>
        exclude<span class="token operator">:</span> <span class="token regex">/node_modules/</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
    extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'.tsx'</span><span class="token punctuation">,</span> <span class="token string">'.ts'</span><span class="token punctuation">,</span> <span class="token string">'.js'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'bundle.js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p>이렇게하면 webpack이 <code>./index.ts</code> 를 통해 진입하고, <code>ts-loader</code>를 통해 모든 <code>.ts</code> 및 <code>.tsx</code> 파일을 로드합니다. 그리고 현재 디렉터리에 <code>bundle.js</code>파일을 출력합니다.</p> <p><code>lodash</code>의 정의에는 기본 export 표현이 없기 때문에, 이제 <code>./index.ts</code>의 <code>lodash</code>를 import하는 부분을 변경해 보겠습니다.</p> <p><strong>./index.ts</strong></p> <pre><code class="hljs language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> import _ from 'lodash';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> import * as _ from 'lodash';
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">   const element = document.createElement('div');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   return element;
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> document.body.appendChild(component());</span></span></code></pre> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>import 부분에서 기본적으로 이 작업을 하도록 하고 TypeScript에서 <code>import _ from 'lodash';</code> 문법을 유지하기 위해 <strong>tsconfig.json</strong> 파일에 <code>"allowSyntheticDefaultImports" : true</code> 와 <code>"esModuleInterop" : true</code>로 설정 합니다. 이는 TypeScript 설정과 연관이 있기때문에 이 가이드에서는 정보를 제공하기 위해서만 언급하겠습니다.</p></aside> <h2 id="loader">Loader<a href="#loader" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><a href="https://github.com/TypeStrong/ts-loader"><code>ts-loader</code></a></p> <p>이 가이드에서는 <code>ts-loader</code>를 사용하여 다른 웹 애셋 import 같은 추가적인 webpack 기능을 조금 더 쉽게 활성화 할 수 있습니다.</p> <aside class="warning"><h6 class="warning__prefix">warning</h6><p><code>ts-loader</code> 는 TypeScript 컴파일러인 <code>tsc</code>를 사용하고, <code>tsconfig.json</code>의 설정을 따릅니다. <a href="https://www.typescriptlang.org/tsconfig#module"><code>모듈을</code></a> "CommonJS"로 설정하지 않도록 주의하세요. 안그러면 webpack이 <a href="/guides/tree-shaking">코드 tree-shake를</a> 할 수 없습니다.</p></aside> <p>이미 <a href="https://github.com/babel/babel-loader"><code>babel-loader</code>를</a> 사용하여 코드를 트랜스파일 하는 경우라면 <a href="https://babeljs.io/docs/en/babel-preset-typescript"><code>@babel/preset-typescript</code></a>를 사용하여 Babel이 추가 로더를 사용하는 대신 JavaScript와 TypeScript 파일을 모두 처리하도록 합니다. <code>ts-loader</code>와 달리, 기본 <a href="https://babeljs.io/docs/en/babel-plugin-transform-typescript"><code>@babel/plugin-transform-typescript</code></a> 플러그인은 어떠한 타입 검사도 수행하지 않습니다.</p> <h2 id="source-maps-1">Source Maps<a href="#source-maps-1" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>소스맵에 대한 자세한 내용은 <a href="/guides/development">개발 가이드를</a> 참고하세요.</p> <p>소스맵을 사용하려면 TypeScript가 컴파일된 JavaScript 파일로 인라인 소스맵을 출력하도록 설정해야 합니다. TypeScript 설정에 다음 내용을 꼭 추가해야합니다.</p> <p><strong>tsconfig.json</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> {
</span><span class="token prefix unchanged"> </span><span class="token line">   "compilerOptions": {
</span><span class="token prefix unchanged"> </span><span class="token line">     "outDir": "./dist/",
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     "sourceMap": true,
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     "noImplicitAny": true,
</span><span class="token prefix unchanged"> </span><span class="token line">     "module": "commonjs",
</span><span class="token prefix unchanged"> </span><span class="token line">     "target": "es5",
</span><span class="token prefix unchanged"> </span><span class="token line">     "jsx": "react",
</span><span class="token prefix unchanged"> </span><span class="token line">     "allowJs": true,
</span><span class="token prefix unchanged"> </span><span class="token line">     "moduleResolution": "node",
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }</span></span></code></pre> <p>이제 webpack에 이러한 소스맵을 추출해 최종 번들에 포함되도록 지시해야 합니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const path = require('path');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">   entry: './src/index.ts',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   devtool: 'inline-source-map',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   module: {
</span><span class="token prefix unchanged"> </span><span class="token line">     rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">       {
</span><span class="token prefix unchanged"> </span><span class="token line">         test: /\.tsx?$/,
</span><span class="token prefix unchanged"> </span><span class="token line">         use: 'ts-loader',
</span><span class="token prefix unchanged"> </span><span class="token line">         exclude: /node_modules/,
</span><span class="token prefix unchanged"> </span><span class="token line">       },
</span><span class="token prefix unchanged"> </span><span class="token line">     ],
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   resolve: {
</span><span class="token prefix unchanged"> </span><span class="token line">     extensions: [ '.tsx', '.ts', '.js' ],
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   output: {
</span><span class="token prefix unchanged"> </span><span class="token line">     filename: 'bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">     path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line"> };</span></span></code></pre> <p>자세한 내용은 <a href="/configuration/devtool/">개발자 도구 문서를</a> 참고하세요.</p> <h2 id="using-third-party-libraries">Using Third Party Libraries<a href="#using-third-party-libraries" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>npm으로부터 타사 라이브러리를 설치할 때는 해당 라이브러리에 대한 타입 정의를 설치해야 한다는 사실을 기억해야 합니다. 이런 정의는 <a href="https://microsoft.github.io/TypeSearch/">TypeSearch에서</a> 찾을 수 있습니다.</p> <p>예를 들어 lodash를 설치하려는 경우 다음 명령을 실행해서 타입을 가져올 수 있습니다.</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev @types/lodash</code></pre> <p>자세한 내용은 <a href="https://blogs.msdn.microsoft.com/typescript/2016/06/15/the-future-of-declaration-files/">블로그 포스트를</a> 참고하세요.</p> <h2 id="importing-other-assets">Importing Other Assets<a href="#importing-other-assets" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>TypeScript와 함께 비코드 애셋을 사용하려면 이러한 import에 대한 타입을 연기해야 합니다. 이를 위해서 프로젝트에 TypeScript에 대한 사용자 정의를 나타내는 <code>custom.d.ts</code> 파일이 필요합니다. <code>.svg</code> 파일에 대한 선언을 설정해 보겠습니다.</p> <p><strong>custom.d.ts</strong></p> <pre><code class="hljs language-typescript"><span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'*.svg'</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> content<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> content<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> <p>여기에서는 <code>.svg</code>로 끝나는 import를 지정하고 모듈의 <code>content</code>를 <code>any</code>로 정의하여 SVG를 위한 새로운 모듈을 선언합니다. 타입을 문자열로 정의하여 URL이라는 것을 더 명확하게 할 수 있습니다. CSS, SCSS, JSON 등을 포함한 다른 애셋에도 동일한 개념이 적용됩니다.</p> <h2 id="build-performance-1">Build Performance<a href="#build-performance-1" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <aside class="warning"><h6 class="warning__prefix">warning</h6><p>이로 인해 빌드 성능이 저하 될 수 있습니다.</p></aside> <p>빌드 도구에 대한 <a href="/guides/build-performance/">빌드 성능 가이드를</a> 참고하세요.</p> <h1 id="web-workers">Web Workers<a href="#web-workers" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p>webpack 5부터는, <a href="https://github.com/webpack-contrib/worker-loader"><code>worker-loader</code></a> 없이 <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers">Web Workers를</a> 사용할 수 있습니다.</p> <h2 id="syntax">Syntax<a href="#syntax" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <pre><code class="hljs language-js"><span class="token keyword">new</span> <span class="token class-name">Worker</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span><span class="token string">'./worker.js'</span><span class="token punctuation">,</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p>이 구문은 번들러 없이 코드를 실행할 수 있도록 선택되었으며, 브라우저의 기본 ECMAScript 모듈에서도 사용할 수 있습니다.</p> <h2 id="example-1">Example<a href="#example-1" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-js"><span class="token keyword">const</span> worker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Worker</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span><span class="token string">'./deep-thought.js'</span><span class="token punctuation">,</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
worker<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  question<span class="token operator">:</span>
    <span class="token string">'The Answer to the Ultimate Question of Life, The Universe, and Everything.'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
worker<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> data<span class="token operator">:</span> <span class="token punctuation">{</span> answer <span class="token punctuation">}</span> <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>answer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p><strong>src/deep-thought.js</strong></p> <pre><code class="hljs language-js">self<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> data<span class="token operator">:</span> <span class="token punctuation">{</span> question <span class="token punctuation">}</span> <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  self<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    answer<span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h2 id="nodejs">Node.js<a href="#nodejs" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>비슷한 구문이 12.17.0 이상의 Node.js에서 지원됩니다.</p> <pre><code class="hljs language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> Worker <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'worker_threads'</span><span class="token punctuation">;</span>

<span class="token keyword">new</span> <span class="token class-name">Worker</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span><span class="token string">'./worker.js'</span><span class="token punctuation">,</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p>이 구문은 ESM에서만 사용할 수 있습니다. CommonJS 구문의 <code>Worker</code>는 webpack 이나 Node.js 모두 지원되지 않습니다.</p> <h1 id="progressive-web-application">Progressive Web Application<a href="#progressive-web-application" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <aside class="tip"><h6 class="tip__prefix">tip</h6><p>이 가이드는 <a href="/guides/output-management">Output Management</a> 가이드에 있는 코드 예제에 대해 설명합니다.</p></aside> <p>프로그레시브 웹 애플리케이션(또는 PWA)은 네이티브 애플리케이션과 유사한 경험을 제공하는 웹 앱입니다. PWA에 기여할 수 있는 많은 것들이 있습니다. 이 중에서 가장 중요한 것은 <strong>오프라인</strong> 일 때 앱이 작동할 수 있는 기능입니다. 이는 <a href="https://developers.google.com/web/fundamentals/primers/service-workers/">Service Workers</a>라는 웹 기술을 사용하여 이루어집니다.</p> <p>이 섹션에서는 앱에 오프라인 경험을 추가하는 데 중점을 둡니다. 웹 앱에 대한 오프라인 지원을 보다 쉽게 설정하는 데 도움이 될 도구를 제공하는 <a href="https://github.com/GoogleChrome/workbox">Workbox</a>라는 Google 프로젝트를 사용하여 이 작업을 수행합니다.</p> <h2 id="we-dont-work-offline-now">We Don't Work Offline Now<a href="#we-dont-work-offline-now" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>지금까지 로컬 파일 시스템으로 직접 이동하여 출력을 확인했습니다. 일반적으로 실제 사용자는 네트워크를 통해 웹 앱에 접근합니다. 브라우저는 <code>.html</code>, <code>.js</code>, 그리고 <code>.css</code> 파일같은 필요한 애셋을 제공할 <strong>서버와</strong> 통신합니다.</p> <p>간단한 서버를 사용하여 테스트해 보겠습니다. <code>npm install http-server --save-dev</code> 커맨드로 <a href="https://www.npmjs.com/package/http-server">http-server</a> 패키지를 설치하여 사용해 보겠습니다. 또한 <code>package.json</code>의 <code>scripts</code> 섹션을 수정하여 <code>start</code> 스크립트를 추가하겠습니다.</p> <p><strong>package.json</strong></p> <pre><code class="hljs language-diff">{
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> ...
</span><span class="token prefix unchanged"> </span><span class="token line"> "scripts": {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    "build": "webpack"
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    "build": "webpack",
</span><span class="token prefix inserted">+</span><span class="token line">    "start": "http-server dist"
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> ...
</span></span>}</code></pre> <p>참고: <a href="/configuration/dev-server/">webpack DevServer</a>는 기본적으로 인-메모리를 사용합니다. http-server가 <code>./dist</code> 디렉터리 파일을 제공하도록 하려면 <a href="/configuration/dev-server/#devserverwritetodisk-">writeToDisk</a> 옵션을 활성화해야 합니다.</p> <p><code>npm run build</code> 커맨드를 실행하여 프로젝트를 빌드합니다. 그런 다음 <code>npm start</code> 커맨드를 실행합니다. 그러면 다음과 같이 출력됩니다.</p> <pre><code class="hljs language-bash"><span class="token operator">></span> http-server dist

Starting up http-server, serving dist
Available on:
  http://xx.x.x.x:8080
  http://127.0.0.1:8080
  http://xxx.xxx.x.x:8080
Hit CTRL-C to stop the server</code></pre> <p>만약 브라우저를 <code>http://localhost:8080</code>로 연다면 <code>dist</code> 디렉터리에서 제공되는 webpack 애플리케이션을 볼 수 있습니다. 서버를 중지하고 새로 고침하면 webpack 애플리케이션을 더 이상 사용할 수 없습니다.</p> <p>이것이 변경하고자 하는 것입니다. 이 문서의 끝에서는 이제 서버를 중지하고, 새로 고침을 눌러도 애플리케이션을 계속 볼 수 있습니다.</p> <h2 id="adding-workbox">Adding Workbox<a href="#adding-workbox" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>Workbox webpack 플러그인을 추가하고 <code>webpack.config.js</code>파일을 수정해 보겠습니다.</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> workbox-webpack-plugin --save-dev</code></pre> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line"> const HtmlWebpackPlugin = require('html-webpack-plugin');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> const WorkboxPlugin = require('workbox-webpack-plugin');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">   entry: {
</span><span class="token prefix unchanged"> </span><span class="token line">     app: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">     print: './src/print.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">     new HtmlWebpackPlugin({
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">       title: 'Output Management',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">       title: 'Progressive Web Application',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     }),
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     new WorkboxPlugin.GenerateSW({
</span><span class="token prefix inserted">+</span><span class="token line">       // 이 옵션은 ServiceWorkers가 빠르게 도달하도록 장려합니다
</span><span class="token prefix inserted">+</span><span class="token line">       // 그리고 "오래된" SW가 돌아다니는 것을 허용하지 않습니다
</span><span class="token prefix inserted">+</span><span class="token line">       clientsClaim: true,
</span><span class="token prefix inserted">+</span><span class="token line">       skipWaiting: true,
</span><span class="token prefix inserted">+</span><span class="token line">     }),
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   ],
</span><span class="token prefix unchanged"> </span><span class="token line">   output: {
</span><span class="token prefix unchanged"> </span><span class="token line">     filename: '[name].bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">     path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">     clean: true,
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line"> };</span></span></code></pre> <p>이제 <code>npm run build</code>를 수행할 때 어떤 일이 발생하는지 살펴보겠습니다.</p> <pre><code class="hljs language-bash"><span class="token punctuation">..</span>.
                  Asset       Size  Chunks                    Chunk Names
          app.bundle.js     <span class="token number">545</span> kB    <span class="token number">0</span>, <span class="token number">1</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  <span class="token punctuation">[</span>big<span class="token punctuation">]</span>  app
        print.bundle.js    <span class="token number">2.74</span> kB       <span class="token number">1</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>         print
             index.html  <span class="token number">254</span> bytes          <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>
precache-manifest.b5ca1c555e832d6fbf9462efd29d27eb.js  <span class="token number">268</span> bytes          <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>
      service-worker.js       <span class="token number">1</span> kB          <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>
<span class="token punctuation">..</span>.</code></pre> <p>보다시피 <code>service-worker.js</code>와 <code>precache-manifest.b5ca1c555e832d6fbf9462efd29d27eb.js</code>라는 2개의 추가 파일이 생성됩니다. <code>service-worker.js</code>는 서비스 워커 파일이고 <code>precache-manifest.b5ca1c555e832d6fbf9462efd29d27eb.js</code>는 <code>service-worker.js</code>가 실행되기 위해 필요한 파일입니다. 사용자가 생성한 파일은 다를 수 있습니다. 하지만 <code>service-worker.js</code> 파일은 있어야 합니다.</p> <p>이제 서비스 워커를 만들었습니다. 다음 단계는 무엇일까요?</p> <h2 id="registering-our-service-worker">Registering Our Service Worker<a href="#registering-our-service-worker" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>서비스 워커를 등록하여 실행 할 수 있도록 합시다. 아래의 등록 코드를 추가하면 됩니다.</p> <p><strong>index.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> import _ from 'lodash';
</span><span class="token prefix unchanged"> </span><span class="token line"> import printMe from './print.js';
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> if ('serviceWorker' in navigator) {
</span><span class="token prefix inserted">+</span><span class="token line">   window.addEventListener('load', () => {
</span><span class="token prefix inserted">+</span><span class="token line">     navigator.serviceWorker.register('/service-worker.js').then(registration => {
</span><span class="token prefix inserted">+</span><span class="token line">       console.log('SW registered: ', registration);
</span><span class="token prefix inserted">+</span><span class="token line">     }).catch(registrationError => {
</span><span class="token prefix inserted">+</span><span class="token line">       console.log('SW registration failed: ', registrationError);
</span><span class="token prefix inserted">+</span><span class="token line">     });
</span><span class="token prefix inserted">+</span><span class="token line">   });
</span><span class="token prefix inserted">+</span><span class="token line"> }</span></span></code></pre> <p>한 번 더 <code>npm run build</code>를 통해 등록 코드를 포함한 앱 버전을 빌드합니다. 그런 다음 <code>npm start</code>를 실행합니다. <code>http://localhost:8080</code>로 이동하여 콘솔을 살펴보세요. 어딘가에 다음 내용이 표시됩니다.</p> <pre><code class="hljs language-bash">SW registered</code></pre> <p>이제 테스트해 보겠습니다. 서버를 중지하고 페이지를 새로 고침 합니다. 브라우저가 서비스 워커를 지원하는 경우 애플리케이션을 계속해서 확인할 수 있습니다. 하지만 서비스 워커가 서비스를 제공하는 것이지 서버가 <strong>제공하는 것은 아닙니다.</strong></p> <h2 id="conclusion-6">Conclusion<a href="#conclusion-6" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>Workbox 프로젝트를 사용하여 오프라인 앱을 빌드했습니다. 웹 앱을 PWA로 전환하는 여정을 시작했습니다. 이제 더 나아가는 것에 대해 생각할 수 있습니다. 도움이 되는 유용한 리소스는 <a href="https://developers.google.com/web/progressive-web-apps/">여기</a>에서 찾을 수 있습니다.</p> <h1 id="public-path">Public Path<a href="#public-path" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p><code>publicPath</code> 설정은 다양한 경우에서 유용하게 사용될 수 있습니다. 애플리케이션의 모든 애셋에 대한 기본 경로를 지정할 수 있습니다.</p> <h2 id="use-cases">Use Cases<a href="#use-cases" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>이 기능이 특히 유용한 실제 애플리케이션에서의 몇 가지 사용 사례가 있습니다. 기본적으로 <code>output.path</code> 디렉터리로 내보내는 모든 파일은 <code>output.publicPath</code>에서 참조됩니다. 여기에는 하위 청크 (<a href="/guides/code-splitting/">코드 스플리팅</a>을 통해 생성됨) 및 디펜던시 그래프의 일부 애셋(예: 이미지, 글꼴 등)이 포함됩니다.</p> <h3 id="environment-based">Environment Based<a href="#environment-based" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>예를 들어 개발 과정에서 index 페이지와 동일한 수준에 있는 <code>assets/</code> 폴더가 있을 수 있습니다. 프로덕션 환경에서 정적 애셋을 CDN에 호스팅하려면 어떻게 해야할까요?</p> <p>이 문제를 해결하기 위해 오랫동안 사용 중인 환경 변수를 사용해봅시다. <code>ASSET_PATH</code> 변수가 있다고 가정해 보겠습니다.</p> <pre><code class="hljs language-js"><span class="token keyword">import</span> webpack <span class="token keyword">from</span> <span class="token string">'webpack'</span><span class="token punctuation">;</span>

<span class="token comment">// 환경 변수를 사용하고 존재하지 않는다면 루트를 사용하세요.</span>
<span class="token keyword">const</span> <span class="token constant">ASSET_PATH</span> <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">ASSET_PATH</span> <span class="token operator">||</span> <span class="token string">'/'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    publicPath<span class="token operator">:</span> <span class="token constant">ASSET_PATH</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// 코드에서 환경 변수를 안전하게 사용할 수 있습니다.</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token string">'process.env.ASSET_PATH'</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token constant">ASSET_PATH</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h3 id="on-the-fly">On The Fly<a href="#on-the-fly" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>또 다른 사용 사례는 <code>publicPath</code>를 직접 설정하는 것입니다. webpack은 이를 가능하게 하는 <code>__webpack_public_path라는__</code> 전역 변수를 노출합니다. 따라서 애플리케이션의 엔트리 포인트에서 간단하게 처리할 수 있습니다.</p> <pre><code class="hljs language-js">__webpack_public_path__ <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">ASSET_PATH</span><span class="token punctuation">;</span></code></pre> <p>이게 전부입니다. 이미 설정에서 <code>DefinePlugin</code>을 사용하고 있음으로 <code>process.env.ASSET_PATH</code>는 항상 정의되어 안전하게 사용할 수 있습니다.</p> <aside class="warning"><h6 class="warning__prefix">warning</h6><p>엔트리 파일에서 ES6 모듈 가져오기를 사용하는 경우 가져오기 후에 <code>__webpack_public_path__</code> 할당이 수행됩니다. 이러한 경우 공용 경로 할당을 전용 모듈로 이동 한 다음 entry.js 위에서 가져와야 합니다.</p></aside> <pre><code class="hljs language-js"><span class="token comment">// entry.js</span>
<span class="token keyword">import</span> <span class="token string">'./public-path'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'./app'</span><span class="token punctuation">;</span></code></pre> <aside class="tip"><h6 class="tip__prefix">tip</h6><p><code>web</code> 또는 <code>web-worker</code>를 대상으로 사용하는 경우, <code>publicPath</code>는 <code>'auto'</code>로 기본 설정되어 <code>import.meta.url</code>, <code>document.currentScript</code>, <code>&#x3C;script /></code>, <code>self.location</code> 중 하나를 공개 경로로 자동으로 결정합니다.</p></aside> <h1 id="integrations">Integrations<a href="#integrations" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p>일반적인 오해를 푸는 것부터 시작하겠습니다. webpack은 <a href="http://browserify.org/">Browserify</a>나 <a href="https://brunch.io/">Brunch</a> 같은 모듈 번들러 입니다. <a href="https://www.gnu.org/software/make/">Make</a> 및 <a href="https://gruntjs.com/">Grunt</a>, <a href="https://gulpjs.com/">Gulp</a>와 같은 태스크 러너가 아닙니다. 태스크 러너는 프로젝트의 린트, 빌드, 테스트와 같은 일반적인 태스크의 자동화를 처리합니다. 번들러와 비교하면 태스크 러너는 더 높은 수준에 집중합니다. 번들링의 문제는 webpack에 맡겨두고 더 높은 수준의 툴링에 대한 이점을 가질 수 있습니다.</p> <p>번들러는 JavaScript와 스타일 시트의 배포를 준비하여 브라우저에 알맞은 형식으로 변환하는 것을 도와줍니다. 예를 들어 JavaScript를 <a href="/plugins/terser-webpack-plugin/">최소화</a>하거나 <a href="/guides/code-splitting">청크로 분리</a>, 또는 <a href="/guides/lazy-loading">지연 로드하여</a> 성능을 향상 시킬 수 있습니다. 번들링은 웹 개발 환경에서 가장 중요한 과제 중 하나이며 프로세스에 많은 부하가 가지 않도록 합니다.</p> <p>좋은 소식은 올바른 방법으로 접근하면 약간 중복이 있더라도 태스크 러너와 번들러를 함께 잘 사용할 수 있습니다. 이 가이드는 널리 사용되는 태스크 러너와 webpack을 어떻게 통합하는지에 대해 이해하기 쉽게 설명합니다.</p> <h2 id="npm-scripts-2">NPM Scripts<a href="#npm-scripts-2" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>webpack 사용자는 npm <a href="https://docs.npmjs.com/misc/scripts"><code>scripts</code></a>를 태스크 러너로 종종 사용합니다. 이것은 좋은 시작점입니다. 크로스 플랫폼(Cross-platform) 지원이 문제가 될 수 있지만, 여기엔 여러 가지 해결 방법이 있습니다. 대부분의 사용자는 아니지만 많은 사용자가 간단한 npm <code>scripts</code>와 다양한 수준의 webpack 설정 및 툴링을 사용할 수 있습니다.</p> <p>따라서 webpack의 핵심은 번들링에 초점을 맞추고 있지만, 태스크 러너의 일반적인 작업을 webpack으로 수행할 수 있도록 하는 다양한 확장 기능이 있습니다. 별도의 도구를 통합하면 복잡성이 늘어나기 때문에 시작하기 전에 장단점을 고려해야 합니다.</p> <h2 id="grunt">Grunt<a href="#grunt" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>Grunt를 사용한다면 <a href="https://www.npmjs.com/package/grunt-webpack"><code>grunt-webpack</code></a> 패키지를 사용하는 것이 좋습니다. <code>grunt-webpack</code>을 사용하면 webpack이나 <a href="https://github.com/webpack/webpack-dev-server">webpack-dev-server</a>를 태스크로 실행할 수 있으며, <a href="https://gruntjs.com/api/grunt.template">template tags</a> 내에서 통계에 접근 할 수 있고, 개발과 프로덕션의 설정을 분리하는 등의 작업을 수행할 수 있습니다. 설치하지 않았다면 <code>grunt-webpack</code>과 <code>webpack</code>의 설치를 시작하세요.</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev grunt-webpack webpack</code></pre> <p>그리고 설정을 등록하고 태스크를 로드합니다.</p> <p><strong>Gruntfile.js</strong></p> <pre><code class="hljs language-js"><span class="token keyword">const</span> webpackConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack.config.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">grunt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  grunt<span class="token punctuation">.</span><span class="token function">initConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    webpack<span class="token operator">:</span> <span class="token punctuation">{</span>
      options<span class="token operator">:</span> <span class="token punctuation">{</span>
        stats<span class="token operator">:</span> <span class="token operator">!</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">||</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'development'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      prod<span class="token operator">:</span> webpackConfig<span class="token punctuation">,</span>
      dev<span class="token operator">:</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span> watch<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> webpackConfig<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  grunt<span class="token punctuation">.</span><span class="token function">loadNpmTasks</span><span class="token punctuation">(</span><span class="token string">'grunt-webpack'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p>자세한 내용은 <a href="https://github.com/webpack-contrib/grunt-webpack">grunt-webpack 저장소</a>를 참고하세요.</p> <h2 id="gulp">Gulp<a href="#gulp" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>Gulp 역시 <a href="https://github.com/shama/webpack-stream"><code>webpack-stream</code></a> 패키지를 통해 매우 간단하게 통합할 수 있습니다. (a.k.a. <code>gulp-webpack</code>) 이 경우 <code>webpack</code>은 <code>webpack-stream</code>에 직접적인 의존성이 있으므로 별도로 설치할 필요가 없습니다.</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev webpack-stream</code></pre> <p><code>webpack</code> 대신 <code>require('webpack-stream')</code>을 사용하고 선택적으로 설정을 전달합니다.</p> <p><strong>gulpfile.js</strong></p> <pre><code class="hljs language-js"><span class="token keyword">const</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-stream'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> gulp
    <span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'src/entry.js'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
      <span class="token function">webpack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token comment">// 모든 설정 옵션...</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'dist/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p>자세한 내용은 <a href="https://github.com/shama/webpack-stream">webpack-stem 저장소</a>를 참고하세요.</p> <h2 id="mocha">Mocha<a href="#mocha" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><a href="https://github.com/zinserjan/mocha-webpack"><code>mocha-webpack</code></a> 유틸리티는 webpack을 Mocha와 깔끔하게 통합해줍니다. 저장소는 장단점에 대한 자세한 내용을 제공하지만 본질적으로 <code>mocha-webpack</code>은 Mocha 자체와 거의 동일한 CLI를 제공하고 향상된 watch 모드와 경로 분석과 같은 다양한 webpack 기능을 제공하는 간단한 래퍼입니다. 다음은 설치 및 테스트 스위트를 실행하는 방법에 대한 간단한 예입니다. (<code>./test</code>에 있음).</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev webpack mocha mocha-webpack
mocha-webpack <span class="token string">'test/**/*.js'</span></code></pre> <p>자세한 내용은 <a href="https://github.com/zinserjan/mocha-webpack">mocha-webpack 저장소</a>를 참고하세요.</p> <h2 id="karma">Karma<a href="#karma" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><a href="https://github.com/webpack-contrib/karma-webpack"><code>karma-webpack</code></a> 패키지를 사용하면 webpack을 사용하여 <a href="https://karma-runner.github.io/1.0/index.html">Karma</a>에서 파일을 전처리할 수 있습니다.</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev webpack karma karma-webpack</code></pre> <p><strong>karma.conf.js</strong></p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  config<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    frameworks<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'webpack'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    files<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> pattern<span class="token operator">:</span> <span class="token string">'test/*_test.js'</span><span class="token punctuation">,</span> watched<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> pattern<span class="token operator">:</span> <span class="token string">'test/**/*_test.js'</span><span class="token punctuation">,</span> watched<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    preprocessors<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">'test/*_test.js'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'webpack'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token string">'test/**/*_test.js'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'webpack'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    webpack<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 모든 커스텀 webpack 설정...</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'karma-webpack'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p>자세한 내용은 <a href="https://github.com/webpack-contrib/karma-webpack">karma-webpack 저장소</a>를 참고하세요.</p> <h1 id="advanced-entry">Advanced entry<a href="#advanced-entry" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <h2 id="multiple-file-types-per-entry">Multiple file types per entry<a href="#multiple-file-types-per-entry" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>JavaScript의 스타일에 <code>import</code>를 사용하지 않는 애플리케이션(싱글 페이지 애플리케이션 혹은 다른 이유로인해)에서 CSS 및 JavaScript와 기타 파일에 대해 각각 별도의 번들을 얻기 위해 <a href="/configuration/entry-context/#entry">엔트리에</a> 값 배열을 사용하여 다른 유형의 파일을 제공할 수 있습니다.</p> <p>예를 들어 보겠습니다. 홈과 계정을 위한 두 가지 페이지 유형이 있는 PHP 애플리케이션이 있습니다. 홈 페이지는 다른 레이아웃을 갖고 있고, 나머지 애플리케이션(계정 페이지)과는 공유할 수 없는 JavaScript가 있습니다. 홈 페이지를 위해 애플리케이션 파일에서 <code>home.js</code>와 <code>home.css</code>를 출력하고, 계정 페이지를 위해 <code>account.js</code>와 <code>account.css</code>를 출력하려고 합니다.</p> <p><strong>home.js</strong></p> <pre><code class="hljs language-javascript">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'home page type'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p><strong>home.scss</strong></p> <pre><code class="hljs language-scss"><span class="token comment">// 홈 페이지의 개별 스타일</span></code></pre> <p><strong>account.js</strong></p> <pre><code class="hljs language-javascript">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'account page type'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p><strong>account.scss</strong></p> <pre><code class="hljs language-scss"><span class="token comment">// 계정 페이지의 개별 스타일</span></code></pre> <p>CSS를 위한 <code>프로덕션</code> 모드에서 <a href="/plugins/mini-css-extract-plugin/"><code>MiniCssExtractPlugin</code></a>을 모범사례로 사용하겠습니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js"><span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mini-css-extract-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span><span class="token punctuation">,</span>
  entry<span class="token operator">:</span> <span class="token punctuation">{</span>
    home<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'./home.js'</span><span class="token punctuation">,</span> <span class="token string">'./home.scss'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    account<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'./account.js'</span><span class="token punctuation">,</span> <span class="token string">'./account.scss'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'[name].js'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex">/\.scss$/</span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token comment">// 개발환경에서는 style-loader로 대체 합니다</span>
          process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">'production'</span>
            <span class="token operator">?</span> <span class="token string">'style-loader'</span>
            <span class="token operator">:</span> MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>
          <span class="token string">'css-loader'</span><span class="token punctuation">,</span>
          <span class="token string">'sass-loader'</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      filename<span class="token operator">:</span> <span class="token string">'[name].css'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p>위의 구성으로 webpack을 실행하면 다른 출력경로를 지정하지 않았기 때문에 <code>./dist</code>로 출력됩니다. <code>./dist</code> 디렉터리는 이제 4개의 파일이 포함됩니다.</p> <ul> <li>home.js</li> <li>home.css</li> <li>account.js</li> <li>account.css</li> </ul> <h1 id="asset-modules">Asset Modules<a href="#asset-modules" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p>애셋 모듈은 로더를 추가로 구성하지 않아도 애셋 파일(폰트, 아이콘 등)을 사용할 수 있도록 해주는 모듈입니다.</p> <p>webpack 5 이전에는 아래의 로더를 사용하는 것이 일반적이었습니다.</p> <ul> <li><a href="/loaders/raw-loader/"><code>raw-loader</code></a> 파일을 문자열로 가져올 때</li> <li><a href="/loaders/url-loader/"><code>url-loader</code></a> 파일을 data URI 형식으로 번들에 인라인 추가 할 때</li> <li><a href="/loaders/file-loader/"><code>file-loader</code></a> 파일을 출력 디렉터리로 내보낼 때</li> </ul> <p>이러한 로더를 대체하기 위해서 애셋 모듈에는 4개의 새로운 모듈 유형이 추가되었습니다.</p> <ul> <li><code>asset/resource</code>는 별도의 파일을 내보내고 URL을 추출합니다. 이전에는 <code>file-loader</code>를 사용하여 처리할 수 있었습니다.</li> <li><code>asset/inline</code>은 애셋의 data URI를 내보냅니다. 이전에는 <code>url-loader</code>를 사용하여 처리할 수 있었습니다.</li> <li><code>asset/source</code>는 애셋의 소스 코드를 내보냅니다. 이전에는<code>raw-loader</code>를 사용하여 처리할 수 있었습니다.</li> <li><code>asset</code>은 data URI와 별도의 파일 내보내기 중에서 자동으로 선택합니다. 이전에는 애셋 크기 제한이 있는 <code>url-loader</code>를 사용했습니다.</li> </ul> <p>webpack 5의 애셋 모듈과 함께 이전 애셋 로더(예 :<code>file-loader</code>/<code>url-loader</code>/<code>raw-loader</code>)를 사용할 때 애셋 모듈이 애셋을 중복으로 처리하지 않도록 할 수 있습니다. 이는 애셋의 모듈 유형을 <code>'javascript/auto'</code>로 설정하여 적용 가능합니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff">module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module: {
</span><span class="token prefix unchanged"> </span><span class="token line">  rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">     {
</span><span class="token prefix unchanged"> </span><span class="token line">       test: /\.(png|jpg|gif)$/i,
</span><span class="token prefix unchanged"> </span><span class="token line">       use: [
</span><span class="token prefix unchanged"> </span><span class="token line">         {
</span><span class="token prefix unchanged"> </span><span class="token line">           loader: 'url-loader',
</span><span class="token prefix unchanged"> </span><span class="token line">           options: {
</span><span class="token prefix unchanged"> </span><span class="token line">             limit: 8192,
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span><span class="token prefix unchanged"> </span><span class="token line">         },
</span><span class="token prefix unchanged"> </span><span class="token line">       ],
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">       type: 'javascript/auto'
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">  ]
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span></span>}</code></pre> <p>애셋 로더의 새로운 URL 호출에서 발생한 애셋을 제외하려면 로더 설정에 <code>dependency : {not: ['url']}</code>을 추가합니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff">module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module: {
</span><span class="token prefix unchanged"> </span><span class="token line">   rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">     {
</span><span class="token prefix unchanged"> </span><span class="token line">       test: /\.(png|jpg|gif)$/i,
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">       dependency: { not: ['url'] },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       use: [
</span><span class="token prefix unchanged"> </span><span class="token line">         {
</span><span class="token prefix unchanged"> </span><span class="token line">           loader: 'url-loader',
</span><span class="token prefix unchanged"> </span><span class="token line">           options: {
</span><span class="token prefix unchanged"> </span><span class="token line">             limit: 8192,
</span><span class="token prefix unchanged"> </span><span class="token line">           },
</span><span class="token prefix unchanged"> </span><span class="token line">         },
</span><span class="token prefix unchanged"> </span><span class="token line">       ],
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">   ],
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>}</code></pre> <h2 id="resource-assets">Resource assets<a href="#resource-assets" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff">const path = require('path');

module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line"> output: {
</span><span class="token prefix unchanged"> </span><span class="token line">   filename: 'main.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   path: path.resolve(__dirname, 'dist')
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> module: {
</span><span class="token prefix inserted">+</span><span class="token line">   rules: [
</span><span class="token prefix inserted">+</span><span class="token line">     {
</span><span class="token prefix inserted">+</span><span class="token line">       test: /\.png/,
</span><span class="token prefix inserted">+</span><span class="token line">       type: 'asset/resource'
</span><span class="token prefix inserted">+</span><span class="token line">     }
</span><span class="token prefix inserted">+</span><span class="token line">   ]
</span><span class="token prefix inserted">+</span><span class="token line"> },
</span></span>};</code></pre> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-js"><span class="token keyword">import</span> mainImage <span class="token keyword">from</span> <span class="token string">'./images/main.png'</span><span class="token punctuation">;</span>

img<span class="token punctuation">.</span>src <span class="token operator">=</span> mainImage<span class="token punctuation">;</span> <span class="token comment">// '/dist/151cfcfa1bd74779aadb.png'</span></code></pre> <p>모든 <code>.png</code> 파일을 출력 디렉터리로 내보내고 해당 경로를 번들에 삽입합니다.</p> <h3 id="custom-output-filename">Custom output filename<a href="#custom-output-filename" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>파일을 출력 디렉터리로 내보낼 때 <code>asset/resource</code> 모듈은 기본적으로 <code>[hash][ext][query]</code> 파일명을 사용합니다.</p> <p>webpack 설정에서 <a href="/configuration/output/#outputassetmodulefilename"><code>output.assetModuleFilename</code></a>을 설정하여 이 템플릿을 수정할 수 있습니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff">const path = require('path');

module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line"> output: {
</span><span class="token prefix unchanged"> </span><span class="token line">   filename: 'main.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   path: path.resolve(__dirname, 'dist'),
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   assetModuleFilename: 'images/[hash][ext][query]'
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> module: {
</span><span class="token prefix unchanged"> </span><span class="token line">   rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">     {
</span><span class="token prefix unchanged"> </span><span class="token line">       test: /\.png/,
</span><span class="token prefix unchanged"> </span><span class="token line">       type: 'asset/resource'
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   ]
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span></span>};</code></pre> <p>특정 디렉터리에 애셋을 내보낼때 출력 파일명을 사용자 정의하는 경우도 있습니다.</p> <pre><code class="hljs language-diff">const path = require('path');

module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line"> output: {
</span><span class="token prefix unchanged"> </span><span class="token line">   filename: 'main.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   path: path.resolve(__dirname, 'dist'),
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   assetModuleFilename: 'images/[hash][ext][query]'
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> module: {
</span><span class="token prefix unchanged"> </span><span class="token line">   rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">     {
</span><span class="token prefix unchanged"> </span><span class="token line">       test: /\.png/,
</span><span class="token prefix unchanged"> </span><span class="token line">       type: 'asset/resource'
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">     }
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     },
</span><span class="token prefix inserted">+</span><span class="token line">     {
</span><span class="token prefix inserted">+</span><span class="token line">       test: /\.html/,
</span><span class="token prefix inserted">+</span><span class="token line">       type: 'asset/resource',
</span><span class="token prefix inserted">+</span><span class="token line">       generator: {
</span><span class="token prefix inserted">+</span><span class="token line">         filename: 'static/[hash][ext][query]'
</span><span class="token prefix inserted">+</span><span class="token line">       }
</span><span class="token prefix inserted">+</span><span class="token line">     }
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   ]
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span></span>};</code></pre> <p>이 설정을 통해 모든 <code>html</code> 파일을 출력 디렉터리 내의 <code>static</code> 디렉터리로 내보내게 됩니다.</p> <p><code>Rule.generator.filename</code>은 <a href="/configuration/output/#outputassetmodulefilename"><code>output.assetModuleFilename</code></a>과 같으며 <code>asset</code> 및 <code>asset/resource</code> 모듈에서만 동작합니다.</p> <h2 id="inlining-assets">Inlining assets<a href="#inlining-assets" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff">const path = require('path');

module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line"> output: {
</span><span class="token prefix unchanged"> </span><span class="token line">   filename: 'main.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   path: path.resolve(__dirname, 'dist'),
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">   assetModuleFilename: 'images/[hash][ext][query]'
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> module: {
</span><span class="token prefix unchanged"> </span><span class="token line">   rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">     {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">       test: /\.png/,
</span><span class="token prefix deleted">-</span><span class="token line">       type: 'asset/resource'
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">       test: /\.svg/,
</span><span class="token prefix inserted">+</span><span class="token line">       type: 'asset/inline'
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">     },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     }
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">     {
</span><span class="token prefix deleted">-</span><span class="token line">       test: /\.html/,
</span><span class="token prefix deleted">-</span><span class="token line">       type: 'asset/resource',
</span><span class="token prefix deleted">-</span><span class="token line">       generator: {
</span><span class="token prefix deleted">-</span><span class="token line">         filename: 'static/[hash][ext][query]'
</span><span class="token prefix deleted">-</span><span class="token line">       }
</span><span class="token prefix deleted">-</span><span class="token line">     }
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   ]
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>};</code></pre> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> import mainImage from './images/main.png';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> import metroMap from './images/metro.svg';
</span></span>
<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> img.src = mainImage; // '/dist/151cfcfa1bd74779aadb.png'
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> block.style.background = `url(${metroMap})`; // url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDo...vc3ZnPgo=)</span></span></code></pre> <p>모든 <code>.svg</code> 파일은 data URI로 번들에 삽입됩니다.</p> <h3 id="custom-data-uri-generator">Custom data URI generator<a href="#custom-data-uri-generator" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>기본적으로 webpack에서 내보낸 data URI는 Base64 알고리즘을 사용하여 인코딩된 파일 콘텐츠를 의미합니다.</p> <p>커스텀 인코딩 알고리즘을 사용하려면, 파일 콘텐츠 인코딩을 위한 커스텀 함수를 지정해야 합니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff">const path = require('path');
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> const svgToMiniDataURI = require('mini-svg-data-uri');
</span></span>
module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line"> output: {
</span><span class="token prefix unchanged"> </span><span class="token line">   filename: 'main.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   path: path.resolve(__dirname, 'dist')
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> module: {
</span><span class="token prefix unchanged"> </span><span class="token line">   rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">     {
</span><span class="token prefix unchanged"> </span><span class="token line">       test: /\.svg/,
</span><span class="token prefix unchanged"> </span><span class="token line">       type: 'asset/inline',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">       generator: {
</span><span class="token prefix inserted">+</span><span class="token line">         dataUrl: content => {
</span><span class="token prefix inserted">+</span><span class="token line">           content = content.toString();
</span><span class="token prefix inserted">+</span><span class="token line">           return svgToMiniDataURI(content);
</span><span class="token prefix inserted">+</span><span class="token line">         }
</span><span class="token prefix inserted">+</span><span class="token line">       }
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   ]
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span></span>};</code></pre> <p>이제 모든 <code>.svg</code> 파일이 <code>mini-svg-data-uri</code> 패키지를 통해 인코딩됩니다.</p> <h2 id="source-assets">Source assets<a href="#source-assets" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff">const path = require('path');
<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> const svgToMiniDataURI = require('mini-svg-data-uri');
</span></span>
module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line"> output: {
</span><span class="token prefix unchanged"> </span><span class="token line">   filename: 'main.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   path: path.resolve(__dirname, 'dist')
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> module: {
</span><span class="token prefix unchanged"> </span><span class="token line">   rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">     {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">       test: /\.svg/,
</span><span class="token prefix deleted">-</span><span class="token line">       type: 'asset/inline',
</span><span class="token prefix deleted">-</span><span class="token line">       generator: {
</span><span class="token prefix deleted">-</span><span class="token line">         dataUrl: content => {
</span><span class="token prefix deleted">-</span><span class="token line">           content = content.toString();
</span><span class="token prefix deleted">-</span><span class="token line">           return svgToMiniDataURI(content);
</span><span class="token prefix deleted">-</span><span class="token line">         }
</span><span class="token prefix deleted">-</span><span class="token line">       }
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">       test: /\.txt/,
</span><span class="token prefix inserted">+</span><span class="token line">       type: 'asset/source',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   ]
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span></span>};</code></pre> <p><strong>src/example.txt</strong></p> <pre><code class="hljs language-text">Hello world
</code></pre> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> import metroMap from './images/metro.svg';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> import exampleText from './example.txt';
</span></span>
<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> block.style.background = `url(${metroMap}); // url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDo...vc3ZnPgo=)
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> block.textContent = exampleText; // 'Hello world'</span></span></code></pre> <p>모든 <code>.txt</code> 파일은 있는 그대로 번들에 삽입됩니다.</p> <h2 id="url-assets">URL assets<a href="#url-assets" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>new URL('./path/to/asset', import.meta.url)</code>을 사용할 때 webpack은 애셋 모듈도 함께 생성합니다.</p> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-js"><span class="token keyword">const</span> logo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span><span class="token string">'./logo.svg'</span><span class="token punctuation">,</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p>설정의 <a href="/configuration/target/"><code>target</code></a>에 따라 webpack은 위 코드를 다른 결과로 컴파일합니다.</p> <pre><code class="hljs language-js"><span class="token comment">// target: web</span>
<span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span>
  __webpack_public_path__ <span class="token operator">+</span> <span class="token string">'logo.svg'</span><span class="token punctuation">,</span>
  document<span class="token punctuation">.</span>baseURI <span class="token operator">||</span> self<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// target: webworker</span>
<span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span>__webpack_public_path__ <span class="token operator">+</span> <span class="token string">'logo.svg'</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>location<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// target: node, node-webkit, nwjs, electron-main, electron-renderer, electron-preload, async-node</span>
<span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span>
  __webpack_public_path__ <span class="token operator">+</span> <span class="token string">'logo.svg'</span><span class="token punctuation">,</span>
  <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pathToFileUrl</span><span class="token punctuation">(</span>__filename<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <h2 id="general-asset-type">General asset type<a href="#general-asset-type" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff">const path = require('path');

module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line"> output: {
</span><span class="token prefix unchanged"> </span><span class="token line">   filename: 'main.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   path: path.resolve(__dirname, 'dist')
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> module: {
</span><span class="token prefix unchanged"> </span><span class="token line">   rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">     {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">       test: /\.txt/,
</span><span class="token prefix inserted">+</span><span class="token line">       type: 'asset',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   ]
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span></span>};</code></pre> <p>이제 webpack은 기본 조건에 따라서 <code>resource</code>와 <code>inline</code> 중에서 자동으로 선택합니다. 크기가 8kb 미만인 파일은 <code>inline</code> 모듈로 처리되고 그렇지 않으면 <code>resource</code> 모듈로 처리됩니다.</p> <p>webpack 설정의 module rule 단계에서 <a href="/configuration/module/#ruleparserdataurlcondition"><code>Rule.parser.dataUrlCondition.maxSize</code></a> 옵션을 설정하여 이 조건을 변경할 수 있습니다.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff">const path = require('path');

module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line"> output: {
</span><span class="token prefix unchanged"> </span><span class="token line">   filename: 'main.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   path: path.resolve(__dirname, 'dist')
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> module: {
</span><span class="token prefix unchanged"> </span><span class="token line">   rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">     {
</span><span class="token prefix unchanged"> </span><span class="token line">       test: /\.txt/,
</span><span class="token prefix unchanged"> </span><span class="token line">       type: 'asset',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">       parser: {
</span><span class="token prefix inserted">+</span><span class="token line">         dataUrlCondition: {
</span><span class="token prefix inserted">+</span><span class="token line">           maxSize: 4 * 1024 // 4kb
</span><span class="token prefix inserted">+</span><span class="token line">         }
</span><span class="token prefix inserted">+</span><span class="token line">       }
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   ]
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span></span>};</code></pre> <p>또한 <a href="/configuration/module/#ruleparserdataurlcondition">함수를 지정</a>하여 모듈의 인라인 여부를 결정할 수 있습니다.</p> <h2 id="replacing-inline-loader-syntax">Replacing Inline Loader Syntax<a href="#replacing-inline-loader-syntax" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>Asset Modules 및 Webpack 5 이전에는, 위에 언급한 레거시 로더와 함께 <a href="https://webpack.js.org/concepts/loaders/#inline">inline syntax</a>를 사용할 수 있었습니다.</p> <p>현재는 모든 인라인 로더 구문을 제거하고 resourceQuery 조건을 사용하여 인라인 구문의 기능을 모방하는 것이 좋습니다.</p> <p>예를 들어, <code>raw-loader</code>를 <code>asset/source</code> 유형으로 바꾸는 경우입니다.</p> <pre><code class="hljs language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> import myModule from 'raw-loader!my-module';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> import myModule from 'my-module?raw';</span></span></code></pre> <p>webpack 설정입니다.</p> <pre><code class="hljs language-diff">module: {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">   // ...
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     {
</span><span class="token prefix inserted">+</span><span class="token line">       resourceQuery: /raw/,
</span><span class="token prefix inserted">+</span><span class="token line">       type: 'asset/source',
</span><span class="token prefix inserted">+</span><span class="token line">     }
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   ]
</span><span class="token prefix unchanged"> </span><span class="token line"> },</span></span></code></pre> <p>원시 애샛을 다른 로더에서 처리하지 못하도록 제외하려면, 부정적 조건을 사용하십시오.</p> <pre><code class="hljs language-diff">module: {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">   // ...
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     {
</span><span class="token prefix inserted">+</span><span class="token line">       test: /\.m?js$/,
</span><span class="token prefix inserted">+</span><span class="token line">       resourceQuery: { not: [/raw/] },
</span><span class="token prefix inserted">+</span><span class="token line">       use: [ ... ]
</span><span class="token prefix inserted">+</span><span class="token line">     },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     {
</span><span class="token prefix unchanged"> </span><span class="token line">       resourceQuery: /raw/,
</span><span class="token prefix unchanged"> </span><span class="token line">       type: 'asset/source',
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   ]
</span><span class="token prefix unchanged"> </span><span class="token line"> },</span></span></code></pre> <p>또는 <code>oneOf</code> 규칙 목록입니다. 여기에서는 첫 번째로 일치하는 규칙만 적용됩니다.</p> <pre><code class="hljs language-diff">module: {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">   // ...
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     { oneOf: [
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       {
</span><span class="token prefix unchanged"> </span><span class="token line">         resourceQuery: /raw/,
</span><span class="token prefix unchanged"> </span><span class="token line">         type: 'asset/source',
</span><span class="token prefix unchanged"> </span><span class="token line">       },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">       {
</span><span class="token prefix inserted">+</span><span class="token line">         test: /\.m?js$/,
</span><span class="token prefix inserted">+</span><span class="token line">         use: [ ... ]
</span><span class="token prefix inserted">+</span><span class="token line">       },
</span><span class="token prefix inserted">+</span><span class="token line">     ] }
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   ]
</span><span class="token prefix unchanged"> </span><span class="token line"> },</span></span></code></pre> <h1 id="package-exports">Package exports<a href="#package-exports" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p><code>import "package"</code> 또는 <code>import "package/sub/path"</code>와 같이 모듈을 요청할 때, 패키지의 <code>package.json</code> 내 <code>exports</code> 필드에 어떤 모듈을 사용할지 선언할 수 있습니다. 이를 통해 <code>main</code> 필드 응답을 반환하는 기본 구현을 대체합니다. <code>index.js</code> 파일은 <code>"package"</code>를, 파일 시스템 조회는 <code>"package/sub/path"</code>를 대체합니다.</p> <p><code>exports</code> 필드가 명시되면 이러한 모듈 요청만 사용 가능합니다. 그 외 다른 요청은 ModuleNotFound 오류가 발생합니다.</p> <h2 id="general-syntax">General syntax<a href="#general-syntax" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>일반적으로 <code>exports</code> 필드는 객체를 가지며 객체의 각각의 프로퍼티에는 모듈 요청의 하위 경로가 명시되어 있어야 합니다. 위의 예시에서는 다음 프로퍼티를 사용할 수 있습니다. <code>import "package"</code>에는 <code>"."</code>을, <code>import "package/sub/path"</code>에는 <code>"./sub/path"</code>를 사용할 수 있습니다. <code>/</code>로 끝나는 프로퍼티는 요청에 이 접두사를 포함하여 이전 파일 시스템 조회 알고리즘으로 전달합니다. <code>*</code>로 끝나는 프로퍼티의 경우 <code>*</code>는 어떤 값이든 가질 수 있으며, 프로퍼티 값의 모든 <code>*</code>는 가져온 값으로 대체됩니다.</p> <p>예제:</p> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"."</span><span class="token operator">:</span> <span class="token string">"./main.js"</span><span class="token punctuation">,</span>
    <span class="token property">"./sub/path"</span><span class="token operator">:</span> <span class="token string">"./secondary.js"</span><span class="token punctuation">,</span>
    <span class="token property">"./prefix/"</span><span class="token operator">:</span> <span class="token string">"./directory/"</span><span class="token punctuation">,</span>
    <span class="token property">"./prefix/deep/"</span><span class="token operator">:</span> <span class="token string">"./other-directory/"</span><span class="token punctuation">,</span>
    <span class="token property">"./other-prefix/*"</span><span class="token operator">:</span> <span class="token string">"./yet-another/*/*.js"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <table> <thead> <tr> <th>모듈 요청</th> <th>결과</th> </tr> </thead> <tbody> <tr> <td data-th="모듈 요청"><span><code>package</code></span></td> <td data-th="결과"><span><code>.../package/main.js</code></span></td> </tr> <tr> <td data-th="모듈 요청"><span><code>package/sub/path</code></span></td> <td data-th="결과"><span><code>.../package/secondary.js</code></span></td> </tr> <tr> <td data-th="모듈 요청"><span><code>package/prefix/some/file.js</code></span></td> <td data-th="결과"><span><code>.../package/directory/some/file.js</code></span></td> </tr> <tr> <td data-th="모듈 요청"><span><code>package/prefix/deep/file.js</code></span></td> <td data-th="결과"><span><code>.../package/other-directory/file.js</code></span></td> </tr> <tr> <td data-th="모듈 요청"><span><code>package/other-prefix/deep/file.js</code></span></td> <td data-th="결과"><span><code>.../package/yet-another/deep/file/deep/file.js</code></span></td> </tr> <tr> <td data-th="모듈 요청"><span><code>package/main.js</code></span></td> <td data-th="결과"><span>Error</span></td> </tr> </tbody> </table> <h2 id="alternatives">Alternatives<a href="#alternatives" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>패키지 작성자는 하나의 결과 대신 여러 개의 결과를 제공할 수 있습니다. 이 경우 결과 목록을 순서대로 시도하고 첫 번째 유효한 결과를 사용합니다.</p> <p>노트: 모든 유효한 결과가 아니라 첫 번째 유효한 결과만 사용합니다.</p> <p>예제:</p> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"./things/"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"./good-things/"</span><span class="token punctuation">,</span> <span class="token string">"./bad-things/"</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <p>여기서 <code>package/things/apple</code>은 <code>.../package/good-things/apple</code> 또는 <code>.../package/bad-things/apple</code>에서 찾을 수 있습니다.</p> <h2 id="conditional-syntax">Conditional syntax<a href="#conditional-syntax" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>exports</code> 필드에 직접 결과를 제공하는 대신 패키지 작성자는 모듈 시스템이 환경 조건에 따라 결과를 선택하도록 할 수 있습니다.</p> <p>이 경우 결과에 대한 객체 매핑 조건을 사용해야 합니다. 조건은 객체 순서대로 시도됩니다. 유효하지 않은 결과가 포함된 조건은 건너뜁니다. 논리적 AND를 만들기 위해 조건이 중첩될 수 있습니다. 객체의 마지막 조건은 특별한 <code>"default"</code> 조건일 수 있습니다. 이 조건은 항상 매치됩니다.</p> <p>예제:</p> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"."</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"red"</span><span class="token operator">:</span> <span class="token string">"./stop.js"</span><span class="token punctuation">,</span>
      <span class="token property">"yellow"</span><span class="token operator">:</span> <span class="token string">"./stop.js"</span><span class="token punctuation">,</span>
      <span class="token property">"green"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"free"</span><span class="token operator">:</span> <span class="token string">"./drive.js"</span><span class="token punctuation">,</span>
        <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./wait.js"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./drive-carefully.js"</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <p>위 조건은 다음과 같이 번역됩니다.</p> <pre><code class="hljs language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span>red <span class="token operator">&#x26;&#x26;</span> <span class="token function">valid</span><span class="token punctuation">(</span><span class="token string">'./stop.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">'./stop.js'</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>yellow <span class="token operator">&#x26;&#x26;</span> <span class="token function">valid</span><span class="token punctuation">(</span><span class="token string">'./stop.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">'./stop.js'</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>green<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>free <span class="token operator">&#x26;&#x26;</span> <span class="token function">valid</span><span class="token punctuation">(</span><span class="token string">'./drive.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">'./drive.js'</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">valid</span><span class="token punctuation">(</span><span class="token string">'./wait.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">'./wait.js'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">valid</span><span class="token punctuation">(</span><span class="token string">'./drive-carefully.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">'./drive-carefully.js'</span><span class="token punctuation">;</span>
<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ModuleNotFoundError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p>사용 가능한 조건은 모듈 시스템 및 도구에 따라 다릅니다.</p> <h2 id="abbreviation">Abbreviation<a href="#abbreviation" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>패키지에 대한 단일 엔트리 (<code>"."</code>)만 지원하는 경우 <code>{ ".": ...}</code> 객체 중첩을 생략할 수 있습니다.</p> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token string">"./index.mjs"</span>
<span class="token punctuation">}</span></code></pre> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"red"</span><span class="token operator">:</span> <span class="token string">"./stop.js"</span><span class="token punctuation">,</span>
    <span class="token property">"green"</span><span class="token operator">:</span> <span class="token string">"./drive.js"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <h2 id="notes-about-ordering">Notes about ordering<a href="#notes-about-ordering" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>각 키가 조건인 객체일 경우 프로퍼티 순서가 매우 중요합니다. 조건은 명시된 순서대로 처리됩니다.</p> <p>예: <code>{ "red": "./stop.js", "green": "./drive.js"}</code> != <code>{"green": "./drive.js", "red": "./stop.js"}</code>(<code>red</code> 및 <code>green</code> 조건이 모두 설정된 경우 첫 번째 프로퍼티가 사용됩니다)</p> <p>각 키가 하위 경로인 객체에서는 프로퍼티(하위 경로) 순서가 크게 중요하지 않습니다. 덜 구체적인 경로보다 더 구체적인 경로가 우선됩니다.</p> <p>예: <code>{ "./a/": "./x/", "./a/b/": "./y/", "./a/b/c": "./z" }</code> == <code>{ "./a/b/c": "./z", "./a/b/": "./y/", "./a/": "./x/" }</code> (순서는 항상 <code>./a/b/c</code> > <code>./a/b/</code> > <code>./a/</code> 입니다)</p> <p><code>main</code>, <code>module</code>, <code>browser</code> 또는 커스텀 필드와 같은 다른 패키지 엔트리 필드보다 <code>exports</code> 필드가 우선됩니다.</p> <h2 id="support">Support<a href="#support" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <table> <thead> <tr> <th>기능</th> <th>지원</th> </tr> </thead> <tbody> <tr> <td data-th="기능"><span><code>"."</code> 속성</span></td> <td data-th="지원"><span>Node.js, webpack, rollup, esinstall, wmr</span></td> </tr> <tr> <td data-th="기능"><span>일반 속성</span></td> <td data-th="지원"><span>Node.js, webpack, rollup, esinstall, wmr</span></td> </tr> <tr> <td data-th="기능"><span><code>/</code>로 끝나는 속성</span></td> <td data-th="지원"><span>Node.js<sup>(1)</sup>, webpack, rollup, esinstall<sup>(2)</sup>, wmr<sup>(3)</sup></span></td> </tr> <tr> <td data-th="기능"><span><code>*</code>로 끝나는 속성</span></td> <td data-th="지원"><span>Node.js, webpack, rollup, esinstall</span></td> </tr> <tr> <td data-th="기능"><span>alternatives</span></td> <td data-th="지원"><span>Node.js, webpack, rollup, <strike>esinstall</strike><sup>(4)</sup></span></td> </tr> <tr> <td data-th="기능"><span>path에만 축약형 사용</span></td> <td data-th="지원"><span>Node.js, webpack, rollup, esinstall, wmr</span></td> </tr> <tr> <td data-th="기능"><span>조건에만 축약형 사용</span></td> <td data-th="지원"><span>Node.js, webpack, rollup, esinstall, wmr</span></td> </tr> <tr> <td data-th="기능"><span>조건 구문</span></td> <td data-th="지원"><span>Node.js, webpack, rollup, esinstall, wmr</span></td> </tr> <tr> <td data-th="기능"><span>중첩된 조건 구문</span></td> <td data-th="지원"><span>Node.js, webpack, rollup, wmr<sup>(5)</sup></span></td> </tr> <tr> <td data-th="기능"><span>조건 순서</span></td> <td data-th="지원"><span>Node.js, webpack, rollup, wmr<sup>(6)</sup></span></td> </tr> <tr> <td data-th="기능"><span><code>"default"</code> 조건</span></td> <td data-th="지원"><span>Node.js, webpack, rollup, esinstall, wmr</span></td> </tr> <tr> <td data-th="기능"><span>경로 순서</span></td> <td data-th="지원"><span>Node.js, webpack, rollup</span></td> </tr> <tr> <td data-th="기능"><span>매핑되지 않았을 때 오류</span></td> <td data-th="지원"><span>Node.js, webpack, rollup, esinstall, wmr<sup>(7)</sup></span></td> </tr> <tr> <td data-th="기능"><span>조건과 경로를 혼합해서 사용할 때 오류</span></td> <td data-th="지원"><span>Node.js, webpack, rollup</span></td> </tr> </tbody> </table> <p>(1) Node.js 에서 더 이상 사용되지 않으며 <code>*</code>를 사용해야 합니다.</p> <p>(2) <code>"./"</code> 키는 의도적으로 무시됩니다.</p> <p>(3) 프로퍼티 값은 무시되고 프로퍼티 키가 대상으로 사용됩니다. 키와 값이 동일한 경우에만 효과적으로 매핑을 허용합니다.</p> <p>(4) 구문을 지원하지만, 항상 첫 번째 엔트리가 사용되므로 실제로는 사용할 수 없습니다.</p> <p>(5) 다른 형제 부모 조건으로 폴백시 올바르지 않게 처리됩니다.</p> <p>(6) <code>require</code> 조건의 경우 객체 순서가 올바르지 않게 처리됩니다. 이것은 의도적으로, wmr이 참조하는 구문과 다르지 않기 때문입니다.</p> <p>(7) <code>"exports": "./file.js"</code> 축약형을 사용하는 경우 <code>package/not-existing</code>과 같은 모든 요청은 이에 맞게 해석됩니다. 축약형을 사용하지 않는 경우 <code>package/file.js</code>와 같이 직접 파일에 접근해도 오류로 이어지지 않습니다.</p> <h2 id="conditions">Conditions<a href="#conditions" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <h3 id="reference-syntax">Reference syntax<a href="#reference-syntax" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>모듈을 참조하는 데 사용되는 구문에 따라 다음 조건 중 하나가 설정됩니다.</p> <table> <thead> <tr> <th>조건</th> <th>설명</th> <th>지원</th> </tr> </thead> <tbody> <tr> <td data-th="조건"><span><code>import</code></span></td> <td data-th="설명"><span>ESM 또는 유사한 구문에서 요청이 발생합니다.</span></td> <td data-th="지원"><span>Node.js, webpack, rollup, esinstall<sup>(1)</sup>, wmr<sup>(1)</sup></span></td> </tr> <tr> <td data-th="조건"><span><code>require</code></span></td> <td data-th="설명"><span>CommonJs/AMD 또는 유사한 구문에서 요청이 발생합니다.</span></td> <td data-th="지원"><span>Node.js, webpack, rollup, esinstall<sup>(1)</sup>, wmr<sup>(1)</sup></span></td> </tr> <tr> <td data-th="조건"><span><code>style</code></span></td> <td data-th="설명"><span>스타일시트 참조에서 요청이 발생합니다.</span></td> <td></td> </tr> <tr> <td data-th="조건"><span><code>sass</code></span></td> <td data-th="설명"><span>sass 스타일시트 참조에서 요청이 발생합니다.</span></td> <td></td> </tr> <tr> <td data-th="조건"><span><code>asset</code></span></td> <td data-th="설명"><span>애셋 참조에서 요청이 발생합니다.</span></td> <td></td> </tr> <tr> <td data-th="조건"><span><code>script</code></span></td> <td data-th="설명"><span>모듈 시스템 없이 스크립트 태그를 사용할때 요청이 발생합니다.</span></td> <td></td> </tr> </tbody> </table> <p>부가적으로 아래의 조건도 설정할 수 있습니다.</p> <table> <thead> <tr> <th>조건</th> <th>설명</th> <th>지원</th> </tr> </thead> <tbody> <tr> <td data-th="조건"><span><code>module</code></span></td> <td data-th="설명"><span>javascript를 참조 가능한 모든 모듈 구문은 ESM을 지원합니다.<br/>(<code>import</code> 또는 <code>require</code>와 함께 사용했을 때)</span></td> <td data-th="지원"><span>webpack, rollup, wmr</span></td> </tr> <tr> <td data-th="조건"><span><code>esmodules</code></span></td> <td data-th="설명"><span>지원하는 도구에서 항상 설정합니다.</span></td> <td data-th="지원"><span>wmr</span></td> </tr> <tr> <td data-th="조건"><span><code>types</code></span></td> <td data-th="설명"><span>type 선언과 관련 있는 typescript로부터 요청이 발생합니다.</span></td> <td></td> </tr> </tbody> </table> <p>(1) 참조 구문에서 <code>import</code>와 <code>require</code>는 모두 독립적으로 설정됩니다. <code>require</code>는 항상 더 낮은 우선순위를 갖습니다.</p> <h4 id="import"><code>import</code><a href="#import" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <p>다음 구문은 <code>import</code> 조건을 설정합니다.</p> <ul> <li>ESM의 ESM <code>import</code> 선언</li> <li>JS <code>import()</code> 표현식</li> <li>HTML의 HTML <code>&#x3C;script type="module"></code></li> <li>HTML의 HTML <code>&#x3C;link rel="preload/prefetch"></code></li> <li>JS <code>new Worker(..., { type: "module" })</code></li> <li>WASM <code>import</code>섹션</li> <li>ESM HMR(webpack) <code>import.hot.accept/decline([...])</code></li> <li>JS <code>Worklet.addModule</code></li> <li>자바스크립트를 엔트리 포인트로 사용</li> </ul> <h4 id="require"><code>require</code><a href="#require" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <p>다음 구문은 <code>require</code> 조건을 설정합니다.</p> <ul> <li>CommonJs <code>require(...)</code></li> <li>AMD <code>define()</code></li> <li>AMD <code>require([...])</code></li> <li>CommonJs <code>require.resolve()</code></li> <li>CommonJs (webpack) <code>require.ensure([...])</code></li> <li>CommonJs (webpack) <code>require.context</code></li> <li>CommonJs HMR (webpack) <code>module.hot.accept/decline([...])</code></li> <li>HTML <code>&#x3C;script src="..."></code></li> </ul> <h4 id="style"><code>style</code><a href="#style" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <p>다음 구문은 <code>style</code> 조건을 설정합니다.</p> <ul> <li>CSS <code>@import</code></li> <li>HTML <code>&#x3C;link rel="stylesheet"></code></li> </ul> <h4 id="asset"><code>asset</code><a href="#asset" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <p>다음 구문은 <code>asset</code> 조건을 설정합니다.</p> <ul> <li>CSS <code>url()</code></li> <li>ESM <code>new URL(..., import.meta.url)</code></li> <li>HTML <code>&#x3C;img src="..."></code></li> </ul> <h4 id="script"><code>script</code><a href="#script" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <p>다음 구문은 <code>script</code> 조건을 설정합니다.</p> <ul> <li>HTML <code>&#x3C;script src="..."></code></li> </ul> <p><code>script</code>는 모듈 시스템을 지원하지 않는 경우에만 설정해야 합니다. CommonJs를 지원하는 시스템에서 스크립트를 전처리하는 경우, <code>require</code>로 설정해야 합니다.</p> <p>이 조건은 HTML 페이지에서 스트립트 태그로 삽입할 수 있고 추가 전처리가 없는 자바스크립트 파일을 찾을 때 사용해야 합니다.</p> <h3 id="optimizations">Optimizations<a href="#optimizations" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>다양한 최적화를 위해 다음 조건이 설정됩니다.</p> <table> <thead> <tr> <th>조건</th> <th>설명</th> <th>지원</th> </tr> </thead> <tbody> <tr> <td data-th="조건"><span><code>production</code></span></td> <td data-th="설명"><span>프로덕션 환경.<br/>개발 도구를 포함하지 않아야 합니다.</span></td> <td data-th="지원"><span>webpack</span></td> </tr> <tr> <td data-th="조건"><span><code>development</code></span></td> <td data-th="설명"><span>개발 환경.<br/>개발 도구를 포함해야 합니다.</span></td> <td data-th="지원"><span>webpack</span></td> </tr> </tbody> </table> <p>노트: <code>production</code>과 <code>development</code>는 모두가 사용하는 것이 아닙니다. 이 중 아무것도 설정되지 않은 경우는 가정하지 않아야 합니다.</p> <h3 id="target-environment">Target environment<a href="#target-environment" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>대상 환경에 따라 다음 조건이 설정됩니다.</p> <table> <thead> <tr> <th>조건</th> <th>설명</th> <th>지원</th> </tr> </thead> <tbody> <tr> <td data-th="조건"><span><code>browser</code></span></td> <td data-th="설명"><span>Code will run in a browser.</span></td> <td data-th="지원"><span>webpack, esinstall, wmr</span></td> </tr> <tr> <td data-th="조건"><span><code>electron</code></span></td> <td data-th="설명"><span>Code will run in electron.<sup>(1)</sup></span></td> <td data-th="지원"><span>webpack</span></td> </tr> <tr> <td data-th="조건"><span><code>worker</code></span></td> <td data-th="설명"><span>Code will run in a (Web)Worker.<sup>(1)</sup></span></td> <td data-th="지원"><span>webpack</span></td> </tr> <tr> <td data-th="조건"><span><code>worklet</code></span></td> <td data-th="설명"><span>Code will run in a Worklet.<sup>(1)</sup></span></td> <td data-th="지원"><span>-</span></td> </tr> <tr> <td data-th="조건"><span><code>node</code></span></td> <td data-th="설명"><span>Code will run in Node.js.</span></td> <td data-th="지원"><span>Node.js, webpack, wmr<sup>(2)</sup></span></td> </tr> <tr> <td data-th="조건"><span><code>deno</code></span></td> <td data-th="설명"><span>Code will run in Deno.</span></td> <td data-th="지원"><span>-</span></td> </tr> <tr> <td data-th="조건"><span><code>react-native</code></span></td> <td data-th="설명"><span>Code will run in react-native.</span></td> <td data-th="지원"><span>-</span></td> </tr> </tbody> </table> <p>(1) <code>electron</code>, <code>worker</code> 및 <code>worklet</code>은 컨텍스트에 따라 <code>node</code> 또는 <code>browser</code>와 결합합니다.</p> <p>(2) 브라우저 대상 환경에 대해 설정됩니다.</p> <p>각 환경에는 여러 버전이 있으므로 다음 가이드라인이 적용됩니다.</p> <ul> <li><code>node</code>: 호환성은 <code>engines</code> 필드를 참고하세요.</li> <li><code>browser</code>: 패키지를 배포하는 시점의 현재 Spec 및 4단계 제안과 호환됩니다. 폴리필과 트랜스파일은 소비하는 쪽에서 처리되어야 합니다. <ul> <li>폴리필이나 트랜스파일이 불가능한 기능은 사용이 제한되므로 주의하여 사용해야 합니다.</li> </ul> </li> <li><code>deno</code>: TBD</li> <li><code>react-native</code>: TBD</li> </ul> <h3 id="conditions-preprocessor-and-runtimes">Conditions: Preprocessor and runtimes<a href="#conditions-preprocessor-and-runtimes" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>소스 코드를 전처리하는 도구에 따라 다음 조건이 설정됩니다.</p> <table> <thead> <tr> <th>조건</th> <th>설명</th> <th>지원</th> </tr> </thead> <tbody> <tr> <td data-th="조건"><span><code>webpack</code></span></td> <td data-th="설명"><span>webpack을 통해 처리됩니다.</span></td> <td data-th="지원"><span>webpack</span></td> </tr> </tbody> </table> <p>아쉽지만 Node.js 런타임에 대한 <code>node-js</code> 조건이 없습니다. 이것은 Node.js에 대한 예외 처리를 단순화합니다.</p> <h3 id="conditions-custom">Conditions: Custom<a href="#conditions-custom" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>다음 도구는 커스텀 조건을 지원합니다.</p> <table> <thead> <tr> <th>도구</th> <th>지원</th> <th>노트</th> </tr> </thead> <tbody> <tr> <td data-th="도구"><span>Node.js</span></td> <td data-th="지원"><span>지원</span></td> <td data-th="노트"><span><code>--conditions</code> CLI 인자를 사용.</span></td> </tr> <tr> <td data-th="도구"><span>webpack</span></td> <td data-th="지원"><span>지원</span></td> <td data-th="노트"><span><code>resolve.conditionNames</code> 설정 옵션을 사용.</span></td> </tr> <tr> <td data-th="도구"><span>rollup</span></td> <td data-th="지원"><span>지원</span></td> <td data-th="노트"><span><code>@rollup/plugin-node-resolve</code> 에서 <code>exportConditions</code> 옵션을 사용.</span></td> </tr> <tr> <td data-th="도구"><span>esinstall</span></td> <td data-th="지원"><span>미지원</span></td> <td></td> </tr> <tr> <td data-th="도구"><span>wmr</span></td> <td data-th="지원"><span>미지원</span></td> <td></td> </tr> </tbody> </table> <p>커스텀 조건에는 다음 네이밍 스키마를 권장합니다.</p> <p><code>&#x3C;company-name>:&#x3C;condition-name></code></p> <p>예: <code>example-corp:beta</code>, <code>google:internal</code>, `</p> <h2 id="common-patterns">Common patterns<a href="#common-patterns" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>패키지의 모든 패턴은 단일 <code>"."</code> 엔트리로 해석되지만, 각 엔트리의 패턴을 반복하여 복수의 엔트리로 확장할 수도 있습니다.</p> <p>이 패턴은 엄격한 규칙이 아닌 가이드로 사용해야 합니다. 개별 패키지에 맞게 조정할 수 있습니다.</p> <p>이러한 패턴은 다음과 같은 목표와 가정을 기반으로 합니다.</p> <ul> <li>패키지가 운영되지 않는다. <ul> <li>어떤 시점에서 패키지가 더 이상 운영되지 않는다고 가정합니다. 하지만 패키지는 계속 사용됩니다.</li> <li><code>exports</code>는 향후 알려지지 않은 케이스에 대한 폴백으로 작성되어야 합니다. 이를 위해 <code>default</code> 조건을 사용할 수 있습니다.</li> <li>미래는 알 수 없기 때문에 브라우저와 유사한 환경, ESM과 유사한 모듈 시스템이라고 가정합니다.</li> </ul> </li> <li>모든 도구가 모든 조건을 지원하지 않는다. <ul> <li>이러한 케이스를 처리하려면 폴백을 사용해야 합니다.</li> <li>일반적으로 다음과 같은 폴백이 합리적으로 보입니다. <ul> <li>ESM > CommonJs</li> <li>Production > Development</li> <li>브라우저 > node.js</li> </ul> </li> </ul> </li> </ul> <p>패키지의 의도에 따라 다른 방법이 알맞을 수 있으며 패턴은 이를 따라야 합니다. 예를 들면, 커맨드라인 도구의 경우 브라우저와 같은 미래 환경에 대한 폴백은 별로 의미가 없으며, 이 경우에는 node.js와 같은 환경 및 폴백을 대신 사용해야 합니다.</p> <p>사용 케이스가 복잡할 경우 조건을 중첩하여 여러 패턴을 결합해야 합니다.</p> <h3 id="target-environment-independent-packages">Target environment independent packages<a href="#target-environment-independent-packages" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>이 패턴은 환경별 API를 사용하지 않는 패키지에 적합합니다.</p> <h4 id="providing-only-an-esm-version">Providing only an ESM version<a href="#providing-only-an-esm-version" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"module"</span><span class="token punctuation">,</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token string">"./index.js"</span>
<span class="token punctuation">}</span></code></pre> <p>노트: ESM만 제공하면 node.js에 대한 제한이 따릅니다. 이러한 패키지는 Node.js >= 14 에서 <code>import</code>를 사용할 때만 동작합니다. <code>require()</code>으로는 동작하지 않습니다.</p> <h4 id="providing-commonjs-and-esm-version-stateless">Providing CommonJs and ESM version (stateless)<a href="#providing-commonjs-and-esm-version-stateless" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"module"</span><span class="token punctuation">,</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"node"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"./index.js"</span><span class="token punctuation">,</span>
      <span class="token property">"require"</span><span class="token operator">:</span> <span class="token string">"./index.cjs"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./index.js"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <p>대부분의 도구는 ESM 버전을 받습니다. 하지만 Node.js는 예외입니다. <code>require()</code>를 사용할 때 CommonJs 버전을 얻습니다. <code>require()</code> 및 <code>import</code>를 참조할 때 패키지의 두 인스턴스로 이어지지만, 패키지에 state가 없기 때문에 문제 되지 않습니다.</p> <p><code>require()</code> ESM을 지원하는 도구로 노드 대상 코드를 전처리할 때 <code>module</code> 조건은 최적화를 위해 사용됩니다. (예: Node.js 용 번들러) 이러한 도구의 경우 예외를 건너뜁니다. 기술적으로 선택 사항이지만 그렇지 않으면 번들러에는 패키지 소스 코드가 두 번 포함됩니다.</p> <p>JSON 파일에서 패키지 state를 분리할 수 있는 경우 stateless 패턴을 사용할 수도 있습니다. JSON은 다른 모듈 시스템 그래프에 영향 없이 CommonJs 및 ESM에서 사용할 수 있습니다.</p> <p>여기서 stateless는 클래스 인스턴스가 <code>instanceof</code>로 테스트 되지 않음을 의미합니다. 이중 모듈 인스턴스화로 인해 두 개의 다른 클래스가 있을 수 있기 때문입니다.</p> <h4 id="providing-commonjs-and-esm-version-stateful">Providing CommonJs and ESM version (stateful)<a href="#providing-commonjs-and-esm-version-stateful" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"module"</span><span class="token punctuation">,</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"node"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"./index.js"</span><span class="token punctuation">,</span>
      <span class="token property">"import"</span><span class="token operator">:</span> <span class="token string">"./wrapper.js"</span><span class="token punctuation">,</span>
      <span class="token property">"require"</span><span class="token operator">:</span> <span class="token string">"./index.cjs"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./index.js"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <pre><code class="hljs language-js"><span class="token comment">// wrapper.js</span>
<span class="token keyword">import</span> cjs <span class="token keyword">from</span> <span class="token string">'./index.cjs'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">A</span> <span class="token operator">=</span> cjs<span class="token punctuation">.</span><span class="token constant">A</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">B</span> <span class="token operator">=</span> cjs<span class="token punctuation">.</span><span class="token constant">B</span><span class="token punctuation">;</span></code></pre> <p>stateful 패키지에서는 패키지가 두 번 인스턴스화되지 않도록 해야합니다.</p> <p>대부분의 도구에서 문제가 되지 않지만 Node.js는 여기서도 예외입니다. Node.js는 항상 CommonJs 버전을 사용하고 ESM 래퍼를 사용하여 ESM에 명명된 export를 노출합니다.</p> <p>다시 <code>module</code> 조건을 최적화를 위해 사용합니다.</p> <h4 id="providing-only-a-commonjs-version">Providing only a CommonJs version<a href="#providing-only-a-commonjs-version" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"commonjs"</span><span class="token punctuation">,</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token string">"./index.js"</span>
<span class="token punctuation">}</span></code></pre> <p><code>"type": "commonjs"</code>를 제공하면 CommonJs 파일을 정적으로 감지할 수 있습니다.</p> <h4 id="providing-a-bundled-script-version-for-direct-browser-consumption">Providing a bundled script version for direct browser consumption<a href="#providing-a-bundled-script-version-for-direct-browser-consumption" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"module"</span><span class="token punctuation">,</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"script"</span><span class="token operator">:</span> <span class="token string">"./dist-bundle.js"</span><span class="token punctuation">,</span>
    <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./index.js"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <p><code>dist-bundle.js</code>에 <code>"type": "module"</code> 및 <code>.js</code>를 사용하더라도 이 파일은 ESM 형식이 아닙니다. 스크립트 태그로 직접 사용 할 수 있도록 전역을 사용해야 합니다.</p> <h3 id="providing-devtools-or-production-optimizations">Providing devtools or production optimizations<a href="#providing-devtools-or-production-optimizations" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>이러한 패턴은 패키지에 개발용과 프로덕션용 두 가지 버전이 있을 때 의미가 있습니다. 예를 들면 개발 버전에는 더 나은 오류 메시지 또는 부가적인 경고를 위한 추가 코드가 포함될 수 있습니다.</p> <h4 id="without-nodejs-runtime-detection">Without Node.js runtime detection<a href="#without-nodejs-runtime-detection" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"module"</span><span class="token punctuation">,</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"development"</span><span class="token operator">:</span> <span class="token string">"./index-with-devtools.js"</span><span class="token punctuation">,</span>
    <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./index-optimized.js"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <p><code>development</code> 조건을 지원하면 개발을 위해 향상된 버전을 사용합니다. 프로덕션 버전 또는 모드를 알 수 없는 경우에는 최적화된 버전을 사용합니다.</p> <h4 id="with-nodejs-runtime-detection">With Node.js runtime detection<a href="#with-nodejs-runtime-detection" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"module"</span><span class="token punctuation">,</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"development"</span><span class="token operator">:</span> <span class="token string">"./index-with-devtools.js"</span><span class="token punctuation">,</span>
    <span class="token property">"production"</span><span class="token operator">:</span> <span class="token string">"./index-optimized.js"</span><span class="token punctuation">,</span>
    <span class="token property">"node"</span><span class="token operator">:</span> <span class="token string">"./wrapper-process-env.cjs"</span><span class="token punctuation">,</span>
    <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./index-optimized.js"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <pre><code class="hljs language-js"><span class="token comment">// wrapper-process-env.cjs</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">'development'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./index-optimized.cjs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./index-with-devtools.cjs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> <p>프로덕션/개발 모드를 감지할 때 <code>production</code> 또는 <code>development</code> 조건을 통한 정적 감지를 선호합니다.</p> <p>Node.js는 런타임에 <code>process.env.NODE_ENV</code>를 통해 프로덕션/개발 모드를 감지할 수 있으므로 Node.js에서 이를 폴백으로 사용합니다. 동기화 조건부 import ESM은 불가능하며 패키지를 두 번 로드하지 않아야 하므로 CommonJs로 런타임을 감지해야 합니다.</p> <p>모드를 감지할 수 없는 경우 프로덕션 버전으로 대체합니다.</p> <h3 id="providing-different-versions-depending-on-target-environment">Providing different versions depending on target environment<a href="#providing-different-versions-depending-on-target-environment" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>패키지가 향후 환경을 지원할 수 있도록 폴백 환경을 선택해야 합니다. 일반적으로 브라우저와 같은 환경을 가정해야 합니다.</p> <h4 id="providing-nodejs-webworker-and-browser-versions">Providing Node.js, WebWorker and browser versions<a href="#providing-nodejs-webworker-and-browser-versions" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"module"</span><span class="token punctuation">,</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"node"</span><span class="token operator">:</span> <span class="token string">"./index-node.js"</span><span class="token punctuation">,</span>
    <span class="token property">"worker"</span><span class="token operator">:</span> <span class="token string">"./index-worker.js"</span><span class="token punctuation">,</span>
    <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./index.js"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <h4 id="providing-nodejs-browser-and-electron-versions">Providing Node.js, browser and electron versions<a href="#providing-nodejs-browser-and-electron-versions" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"module"</span><span class="token punctuation">,</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"electron"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"node"</span><span class="token operator">:</span> <span class="token string">"./index-electron-node.js"</span><span class="token punctuation">,</span>
      <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./index-electron.js"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"node"</span><span class="token operator">:</span> <span class="token string">"./index-node.js"</span><span class="token punctuation">,</span>
    <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./index.js"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <h3 id="combining-patterns">Combining patterns<a href="#combining-patterns" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <h4 id="example-1-1">Example 1<a href="#example-1-1" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <p>아래 예제는 <code>process.env</code>에 대한 런타임 감지와 프로덕션 및 개발을 위해 최적화를 제공하는 패키지입니다. CommonJs 및 ESM 버전도 제공합니다.</p> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"module"</span><span class="token punctuation">,</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"node"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"development"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"./index-with-devtools.js"</span><span class="token punctuation">,</span>
        <span class="token property">"import"</span><span class="token operator">:</span> <span class="token string">"./wrapper-with-devtools.js"</span><span class="token punctuation">,</span>
        <span class="token property">"require"</span><span class="token operator">:</span> <span class="token string">"./index-with-devtools.cjs"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"production"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"./index-optimized.js"</span><span class="token punctuation">,</span>
        <span class="token property">"import"</span><span class="token operator">:</span> <span class="token string">"./wrapper-optimized.js"</span><span class="token punctuation">,</span>
        <span class="token property">"require"</span><span class="token operator">:</span> <span class="token string">"./index-optimized.cjs"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./wrapper-process-env.cjs"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"development"</span><span class="token operator">:</span> <span class="token string">"./index-with-devtools.js"</span><span class="token punctuation">,</span>
    <span class="token property">"production"</span><span class="token operator">:</span> <span class="token string">"./index-optimized.js"</span><span class="token punctuation">,</span>
    <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./index-optimized.js"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <h4 id="example-2">Example 2<a href="#example-2" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <p>이 예제는 Node.js, 브라우저 및 electron을 지원합니다. <code>process.env</code>에 대한 런타임 감지와 프로덕션 및 개발을 위한 최적화를 제공하며 CommonJs 및 ESM 버전도 제공합니다.</p> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"module"</span><span class="token punctuation">,</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"electron"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"node"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"development"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"./index-electron-node-with-devtools.js"</span><span class="token punctuation">,</span>
          <span class="token property">"import"</span><span class="token operator">:</span> <span class="token string">"./wrapper-electron-node-with-devtools.js"</span><span class="token punctuation">,</span>
          <span class="token property">"require"</span><span class="token operator">:</span> <span class="token string">"./index-electron-node-with-devtools.cjs"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"production"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"./index-electron-node-optimized.js"</span><span class="token punctuation">,</span>
          <span class="token property">"import"</span><span class="token operator">:</span> <span class="token string">"./wrapper-electron-node-optimized.js"</span><span class="token punctuation">,</span>
          <span class="token property">"require"</span><span class="token operator">:</span> <span class="token string">"./index-electron-node-optimized.cjs"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./wrapper-electron-node-process-env.cjs"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"development"</span><span class="token operator">:</span> <span class="token string">"./index-electron-with-devtools.js"</span><span class="token punctuation">,</span>
      <span class="token property">"production"</span><span class="token operator">:</span> <span class="token string">"./index-electron-optimized.js"</span><span class="token punctuation">,</span>
      <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./index-electron-optimized.js"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"node"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"development"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"./index-node-with-devtools.js"</span><span class="token punctuation">,</span>
        <span class="token property">"import"</span><span class="token operator">:</span> <span class="token string">"./wrapper-node-with-devtools.js"</span><span class="token punctuation">,</span>
        <span class="token property">"require"</span><span class="token operator">:</span> <span class="token string">"./index-node-with-devtools.cjs"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"production"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"./index-node-optimized.js"</span><span class="token punctuation">,</span>
        <span class="token property">"import"</span><span class="token operator">:</span> <span class="token string">"./wrapper-node-optimized.js"</span><span class="token punctuation">,</span>
        <span class="token property">"require"</span><span class="token operator">:</span> <span class="token string">"./index-node-optimized.cjs"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./wrapper-node-process-env.cjs"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"development"</span><span class="token operator">:</span> <span class="token string">"./index-with-devtools.js"</span><span class="token punctuation">,</span>
    <span class="token property">"production"</span><span class="token operator">:</span> <span class="token string">"./index-optimized.js"</span><span class="token punctuation">,</span>
    <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./index-optimized.js"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <p>맞습니다. 복잡해 보이죠. <code>node</code>에만 CommonJs 버전이 필요하고 <code>process.env</code>를 사용하여 프로덕션/개발 모드를 감지 할 수 있다고 가정하여 복잡성을 줄였습니다.</p> <h2 id="guidelines">Guidelines<a href="#guidelines" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <ul> <li><code>default</code> export를 피하십시오. 툴링 마다 다르게 처리됩니다. 명명된 export만 사용하세요.</li> <li>다른 조건에 대해 다른 API 또는 의미를 부여하지 않아야 합니다.</li> <li>소스 코드를 ESM으로 작성하고 babel, typescript 또는 유사한 도구를 통해 CJS로 트랜스파일하세요.</li> <li>package.json에서 <code>.cjs</code> 또는 <code>type: "commonjs"</code>를 사용하여 소스 코드를 CommonJs로 명확하게 표시하세요. CommonJs 또는 ESM을 사용하는 경우 도구가 이를 정적으로 감지 할 수 있습니다. 이는 ESM만 지원하고 CommonJs는 지원하지 않는 도구의 경우 중요합니다.</li> <li>패키지에서 사용하는 ESM은 다음 유형의 요청을 지원합니다. <ul> <li>package.json이 있는 다른 패키지를 가리키는 모듈 요청을 지원합니다.</li> <li>패키지 내의 다른 파일을 가리키는 상대적 요청을 지원합니다. <ul> <li>패키지 외부의 파일을 가리켜서는 안 됩니다.</li> </ul> </li> <li><code>data:</code> URL 요청을 지원합니다.</li> <li>기타 절대적 요청 또는 서버와 관련된 요청은 기본적으로 지원되지 않지만, 일부 도구 또는 환경에서는 지원할 수 있습니다.</li> </ul> </li> </ul> </div><div class="contributors__section"><hr/><h3>Contributors</h3><div class="contributors"><div class="contributors__list"><a class="contributor" href="https://github.com/webpack"><img alt="webpack" src="/icon-square-small-slack.9281492bb267314634b4.png"/><span class="contributor__name"> <!-- -->webpack</span></a></div></div></div></div></section></div><footer class="footer"><div class="container footer__inner"><section class="footer__left"><a class="footer__link" href="/guides/getting-started/">Get Started</a><a class="footer__link" href="/comparison/">Comparison</a><a href="https://privacy-policy.openjsf.org/" target="_blank" rel="noopener noreferrer" class="footer__link">Privacy Policy</a></section><section class="footer__middle"><a class="footer__icon" href="/"><img src="/icon-square-small.85ba630cf0c5f29ae3e3.svg" alt="webpack icon"/></a></section><section class="footer__right"><a href="https://webpack.threadless.com/" target="_blank" rel="noopener noreferrer" class="footer__link">Swag Store</a><a class="footer__link" href="/glossary/">Glossary</a><a class="footer__link" href="/branding/">Branding</a><a href="https://gitter.im/webpack/webpack" target="_blank" rel="noopener noreferrer" class="footer__link">Gitter</a><a href="https://github.com/webpack/webpack/releases" target="_blank" rel="noopener noreferrer" class="footer__link">Changelog</a><a class="footer__link footer__license" href="/license"><img alt="Creative Commons License" src="/cc.ab77d813bf219c6e34ff.svg"/><img alt="Creative Commons License" src="/by.1360bb2e6d1fc28cdd9e.svg"/></a></section></div></footer></div></div><script>
window.matchMedia('print').addListener(function(mql) {
  if (!mql.matches) {
      window.close();
  }
});
window.print();
</script></body>